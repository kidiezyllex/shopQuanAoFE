import{j as e}from"./ui-vendor-CFM_MCUz.js";import{u as s,e as n,r as a}from"./react-vendor-B55MjJUH.js";import{V as t,W as r,X as i,Y as l,Z as c,t as d,C as o,J as h,$ as m,a0 as x,a1 as u,N as p,a2 as g,a3 as j,a4 as N,G as v,a5 as f,a6 as b,a7 as y,a8 as w,Q as k,a9 as C}from"./icons-vendor-BrsZP2ku.js";import{u as H,a as A,F as I,b as T,c as S,d as D,e as _,f as P,g as O}from"./form-DeJYl1uA.js";import{B as z,a as G,b as E,c as M,d as q,e as V}from"./breadcrumb-CP4jYkI2.js";import{u as K,B as L,h as F,I as Y,i as B,j as R,y as U}from"./index-BHeY-5EX.js";import{u as $,a as X}from"./order-BDDy-DF1.js";import{u as Q}from"./useToast-DwJRzuOq.js";import{u as Z}from"./voucher-C38MW_cY.js";import{u as J,a as W,b as ee,c as se,d as ne}from"./return-4pcPvvv5.js";import{C as ae,a as te,b as re,c as ie,d as le}from"./card-ClEzRAeX.js";import{T as ce,a as de}from"./tabs-z4DSy6tE.js";import{B as oe}from"./badge-BeHegjHt.js";import{T as he,a as me,b as xe,c as ue,d as pe,e as ge}from"./table-DL-K3PV4.js";import{D as je,a as Ne,b as ve,c as fe,d as be,e as ye}from"./dialog-Va24CY58.js";import{S as we}from"./skeleton-4G_X8bY4.js";import{T as ke}from"./textarea-DHkaMSo6.js";import{f as Ce}from"./formatters-BtOGY0AI.js";import{m as He}from"./heavy-vendor-BfN2pHnQ.js";import{f as Ae,o as Ie,s as Te,l as Se}from"./utils-vendor-C6znz4jh.js";import{l as De}from"./index-DwIVA3Vd.js";import"./label-Bm9nFuXD.js";import"./query-vendor-CBwfxcof.js";const _e=a.createContext({activeTab:"profile",setActiveTab:e=>{}}),Pe=({status:s})=>{const n={CHO_XAC_NHAN:{label:"Chờ xác nhận",className:"!bg-yellow-400 !text-white !border-yellow-500 text-nowrap"},CHO_GIAO_HANG:{label:"Chờ giao hàng",className:"!bg-blue-400 !text-white !border-blue-500 text-nowrap"},DANG_VAN_CHUYEN:{label:"Đang vận chuyển",className:"!bg-orange-400 !text-white !border-orange-500 text-nowrap"},DA_GIAO_HANG:{label:"Đã giao hàng",className:"!bg-green-400 !text-white !border-green-500 text-nowrap"},HOAN_THANH:{label:"Hoàn thành",className:"!bg-emerald-400 !text-white !border-emerald-500 text-nowrap"},DA_HUY:{label:"Đã hủy",className:"!bg-red-400 !text-white !border-red-500 text-nowrap"}}[s]||{label:s,className:"bg-gray-400 text-maintext border-gray-500"};return e.jsx(oe,{className:`${n.className} rounded-[4px] font-normal`,children:n.label})},Oe=({orderId:s,open:n,onOpenChange:a})=>{var t;const{data:r,isLoading:l,isError:c}=X(s||""),o=e=>new Intl.NumberFormat("vi-VN",{style:"currency",currency:"VND"}).format(e);return n&&s?e.jsx(je,{open:n,onOpenChange:a,children:e.jsx(Ne,{className:"max-w-4xl max-h-[90vh] overflow-auto",children:l?e.jsx("div",{className:"flex items-center justify-center p-8",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-primary"})}):c?e.jsx("div",{className:"p-8 text-center",children:e.jsx("p",{className:"text-red-500",children:"Đã xảy ra lỗi khi tải thông tin đơn hàng."})}):r&&r.data?e.jsxs(e.Fragment,{children:[e.jsxs(ve,{className:"border-b pb-4",children:[e.jsxs(fe,{children:["Chi tiết đơn hàng #",null==(t=r.data)?void 0:t.code]}),e.jsxs(be,{className:"mt-2",children:["Ngày đặt: ",(e=>{try{return Ae(new Date(e),"dd/MM/yyyy HH:mm",{locale:De})}catch(s){return e}})(r.data.createdAt)]}),e.jsx("div",{className:"mt-2",children:e.jsx(Pe,{status:r.data.orderStatus})})]}),e.jsxs("div",{className:"py-4 space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs(ae,{children:[e.jsx(te,{className:"pb-3",children:e.jsxs(re,{className:"flex items-center gap-2",children:[e.jsx(d.Icon,{path:p,size:.7,className:"mr-2"}),"Địa chỉ giao hàng"]})}),e.jsxs(ie,{className:"space-y-4 text-sm",children:[e.jsxs("div",{className:"flex items-start",children:[e.jsx("span",{className:"text-muted-foreground w-32",children:"Người nhận:"}),e.jsx("span",{className:"font-medium",children:r.data.shippingAddress.name})]}),e.jsxs("div",{className:"flex items-start",children:[e.jsx("span",{className:"text-muted-foreground w-32",children:"Số điện thoại:"}),e.jsx("span",{children:r.data.shippingAddress.phoneNumber})]}),e.jsxs("div",{className:"flex items-start",children:[e.jsx("span",{className:"text-muted-foreground w-32",children:"Địa chỉ:"}),e.jsx("span",{children:r.data.shippingAddress.specificAddress})]})]})]}),e.jsxs(ae,{children:[e.jsx(te,{className:"pb-3",children:e.jsxs(re,{className:"flex items-center gap-2",children:[e.jsx(d.Icon,{path:g,size:.7,className:"mr-2"}),"Thông tin thanh toán"]})}),e.jsxs(ie,{className:"space-y-4 text-sm",children:[e.jsxs("div",{className:"flex items-start",children:[e.jsx("span",{className:"text-muted-foreground w-32",children:"Phương thức:"}),e.jsxs("div",{className:"flex items-center",children:[e.jsx(d.Icon,{path:"COD"===r.data.paymentMethod?j:g,size:.7,className:"mr-2 text-primary"}),e.jsx("span",{children:(e=>{switch(e){case"COD":return"Thanh toán khi nhận hàng";case"VNPAY":return"Thanh toán qua VNPay";case"BANK_TRANSFER":return"Chuyển khoản ngân hàng";default:return e}})(r.data.paymentMethod)})]})]}),e.jsxs("div",{className:"flex items-start",children:[e.jsx("span",{className:"text-muted-foreground w-32",children:"Trạng thái:"}),e.jsx("span",{children:e.jsx(oe,{className:"PAID"===r.data.paymentStatus?"bg-green-100 text-green-800 border-green-200":"!bg-extra text-white",children:(e=>{switch(e){case"PENDING":return"Chờ thanh toán";case"PAID":return"Đã thanh toán";case"FAILED":return"Thanh toán thất bại";case"REFUNDED":return"Đã hoàn tiền";default:return e}})(r.data.paymentStatus)})})]})]})]})]}),e.jsxs(ae,{children:[e.jsx(te,{className:"pb-3",children:e.jsxs(re,{className:"flex items-center gap-2",children:[e.jsx(d.Icon,{path:i,size:.7,className:"mr-2"}),"Chi tiết đơn hàng"]})}),e.jsxs(ie,{children:[e.jsxs(he,{children:[e.jsx(me,{children:e.jsxs(xe,{children:[e.jsx(ue,{className:"w-[100px]",children:"Hình ảnh"}),e.jsx(ue,{children:"Sản phẩm"}),e.jsx(ue,{className:"text-right",children:"Đơn giá"}),e.jsx(ue,{className:"text-center",children:"Số lượng"}),e.jsx(ue,{className:"text-right",children:"Thành tiền"})]})}),e.jsx(pe,{children:r.data.items.map(((s,n)=>{var a,t;const r=s.product,i=null==(a=null==r?void 0:r.variants)?void 0:a[0],l=null==(t=null==i?void 0:i.images)?void 0:t[0];return e.jsxs(xe,{children:[e.jsx(ge,{children:l?e.jsx("img",{src:l,alt:(null==r?void 0:r.name)||"",className:"w-16 h-16 object-contain rounded-md"}):e.jsx("img",{src:"/images/white-image.png",alt:(null==r?void 0:r.name)||"",className:"w-16 h-16 object-contain rounded-md"})}),e.jsx(ge,{className:"font-medium",children:e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:(null==r?void 0:r.name)||"Sản phẩm không xác định"}),e.jsxs("div",{className:"text-xs text-muted-foreground",children:["Mã: ",(null==r?void 0:r.code)||"N/A"]}),(null==r?void 0:r.brand)&&e.jsxs("div",{className:"text-xs text-muted-foreground",children:["Thương hiệu: ",r.brand.name]})]})}),e.jsx(ge,{className:"text-right",children:o(s.price)}),e.jsx(ge,{className:"text-center",children:s.quantity}),e.jsx(ge,{className:"text-right font-medium",children:o(s.price*s.quantity)})]},n)}))})]}),e.jsxs("div",{className:"mt-6 space-y-4 border-t pt-4",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-muted-foreground",children:"Tạm tính:"}),e.jsx("span",{children:o(r.data.subTotal)})]}),r.data.discount>0&&e.jsxs("div",{className:"flex justify-between items-center text-green-600",children:[e.jsx("span",{children:"Giảm giá:"}),e.jsxs("span",{children:["-",o(r.data.discount)]})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-muted-foreground",children:"Phí vận chuyển:"}),e.jsx("span",{children:o(r.data.total-r.data.subTotal+r.data.discount||0)})]}),e.jsxs("div",{className:"flex justify-between items-center text-lg font-bold border-t pt-3",children:[e.jsx("span",{children:"Tổng tiền:"}),e.jsx("span",{className:"text-primary",children:o(r.data.total)})]})]})]})]}),e.jsxs(ae,{className:"overflow-hidden",children:[e.jsx(te,{children:e.jsxs(re,{className:"flex items-center gap-2",children:[e.jsx(d.Icon,{path:N,size:.7,className:"mr-3 text-primary"}),"Tiến trình đơn hàng"]})}),e.jsx(ie,{className:"p-4",children:e.jsx("div",{className:"relative",children:((e,s)=>{const n=new Date(s),a=e=>{const s=new Date(n.getTime()+60*e*60*1e3);return Ae(s,"HH:mm dd/MM/yyyy",{locale:De})},t=[{time:a(0),title:"Đơn hàng được tạo",message:"GHN có thông tin chi tiết về gói hàng của bạn và đang chuẩn bị để vận chuyển",completed:!0,icon:k,color:"bg-blue-500"},{time:a(2),title:"Đang xử lý",message:"Kiện hàng của bạn đang được gửi đến trung tâm GHN và đang trong quá trình xử lý giao hàng",completed:!0,icon:C,color:"bg-orange-500"}];switch(e){case"CHO_XAC_NHAN":return[{time:a(0),title:"Chờ xác nhận",message:"Đơn hàng đã được tạo và đang chờ xác nhận từ cửa hàng",completed:!0,icon:k,color:"bg-yellow-500"}];case"CHO_GIAO_HANG":return[...t,{time:a(4),title:"Đã xác nhận",message:"GHN đã xác nhận gói hàng của bạn bằng cách quét nhãn",completed:!0,icon:v,color:"bg-green-500"},{time:a(6),title:"Chuẩn bị giao hàng",message:"Kiện hàng của bạn đã được gửi đi từ trung tâm GHN",completed:!0,icon:C,color:"bg-blue-500"}];case"DANG_VAN_CHUYEN":return[...t,{time:a(4),title:"Đã xác nhận",message:"GHN đã xác nhận gói hàng của bạn bằng cách quét nhãn",completed:!0,icon:v,color:"bg-green-500"},{time:a(6),title:"Đang vận chuyển",message:"Kiện hàng của bạn đã được gửi đi từ trung tâm GHN",completed:!0,icon:N,color:"bg-blue-500"},{time:a(12),title:"Đang phân loại",message:"Kiện hàng của bạn đang được chuyển đến trung tâm GHN để phân loại",completed:!0,icon:C,color:"bg-orange-500"},{time:a(18),title:"Sẵn sàng giao hàng",message:"Kiện hàng của bạn đang ở cơ sở địa phương và sẵn sàng để giao hàng",completed:!0,icon:p,color:"bg-purple-500"}];case"DA_GIAO_HANG":case"HOAN_THANH":return[...t,{time:a(4),title:"Đã xác nhận",message:"GHN đã xác nhận gói hàng của bạn bằng cách quét nhãn",completed:!0,icon:v,color:"bg-green-500"},{time:a(6),title:"Đang vận chuyển",message:"Kiện hàng của bạn đã được gửi đi từ trung tâm GHN",completed:!0,icon:N,color:"bg-blue-500"},{time:a(12),title:"Đang phân loại",message:"Kiện hàng của bạn đang được chuyển đến trung tâm GHN để phân loại",completed:!0,icon:C,color:"bg-orange-500"},{time:a(18),title:"Sẵn sàng giao hàng",message:"Kiện hàng của bạn đang ở cơ sở địa phương và sẵn sàng để giao hàng",completed:!0,icon:p,color:"bg-purple-500"},{time:a(24),title:"Đang giao hàng",message:"Kiện hàng của bạn đang được vận chuyển bằng xe GHN và sẽ được giao trong ngày hôm nay",completed:!0,icon:N,color:"bg-indigo-500"},{time:a(26),title:"Đã đến khu vực",message:"Kiện hàng của bạn đã đến cơ sở GHN tại khu vực của người nhận",completed:!0,icon:p,color:"bg-teal-500"},{time:a(28),title:"Giao hàng thành công",message:"Giao hàng thành công. Cảm ơn bạn đã sử dụng dịch vụ!",completed:!0,icon:v,color:"bg-emerald-500"}];case"DA_HUY":return[{time:a(0),title:"Đơn hàng được tạo",message:"Đơn hàng đã được tạo",completed:!0,icon:k,color:"bg-blue-500"},{time:a(2),title:"Đơn hàng đã hủy",message:"Đơn hàng đã bị hủy theo yêu cầu",completed:!0,icon:w,color:"bg-red-500"}];default:return t}})(r.data.orderStatus,r.data.createdAt).map(((s,n,a)=>e.jsxs("div",{className:"relative flex items-start pb-8 last:pb-0",children:[n<a.length-1&&e.jsx("div",{className:"absolute left-6 top-12 w-0.5 h-full bg-gradient-to-b from-gray-300 to-gray-200"}),e.jsx("div",{className:"relative flex-shrink-0 mr-4",children:e.jsx("div",{className:`w-12 h-12 rounded-full ${s.color} flex items-center justify-center shadow-lg ring-4 ring-white`,children:e.jsx(d.Icon,{path:s.icon,size:.7,className:"text-white"})})}),e.jsxs("div",{className:"flex-1 min-w-0 bg-white rounded-lg border border-gray-100 p-4 shadow-sm hover:shadow-md transition-shadow duration-200",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("h4",{className:"text-sm font-semibold text-maintext",children:s.title}),e.jsx("span",{className:"text-xs text-muted-foreground bg-gray-50 px-2 py-1 rounded-full",children:s.time})]}),e.jsx("p",{className:"text-sm text-maintext leading-relaxed",children:s.message}),s.completed&&e.jsxs("div",{className:"mt-3 flex items-center text-xs text-green-600",children:[e.jsx(d.Icon,{path:v,size:.7,className:"mr-1"}),"Hoàn thành"]})]})]},n)))})})]})]}),e.jsx(ye,{className:"border-t pt-4",children:e.jsx(L,{variant:"outline",onClick:()=>a(!1),children:"Đóng"})})]}):e.jsx("div",{className:"p-8 text-center",children:e.jsx("p",{className:"text-muted-foreground",children:"Không tìm thấy thông tin đơn hàng."})})})}):null},ze=({status:s})=>{const n={CHO_XU_LY:{label:"Chờ xử lý",className:"!bg-yellow-400 !text-white !border-yellow-500 text-nowrap"},DA_HOAN_TIEN:{label:"Đã hoàn tiền",className:"!bg-green-400 !text-white !border-green-500 text-nowrap"},DA_HUY:{label:"Đã hủy",className:"!bg-red-400 !text-white !border-red-500 text-nowrap"}}[s]||{label:s,className:"bg-gray-400 text-maintext border-gray-500"};return e.jsx(oe,{className:`${n.className} rounded-[4px] font-normal`,children:n.label})},Ge=({orderId:s,open:n,onOpenChange:t,onSuccess:r})=>{var i,c,o,h,m;const x=ee(),{data:u}=J(),{profile:p}=K(),g=null==(i=null==p?void 0:p.data)?void 0:i.id,{data:j}=$(g||""),[N,v]=a.useState([]),[w,k]=a.useState(""),C=null==(o=null==(c=null==u?void 0:u.data)?void 0:c.orders)?void 0:o.find((e=>e.id===s)),H=(null==(m=null==(h=null==j?void 0:j.data)?void 0:h.orders)?void 0:m.find((e=>e.id===s)))||C;return n&&s&&H?e.jsx(je,{open:n,onOpenChange:t,children:e.jsxs(Ne,{className:"max-w-4xl max-h-[90vh] overflow-auto",children:[e.jsxs(ve,{children:[e.jsxs(fe,{children:["Tạo yêu cầu trả hàng - Đơn #",H.code]}),e.jsx(be,{children:"Chọn sản phẩm bạn muốn trả và nhập lý do trả hàng"})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium mb-3",children:"Sản phẩm trong đơn hàng:"}),e.jsx("div",{className:"space-y-2 max-h-60 overflow-y-auto",children:H.items.map(((s,n)=>{var a,t;const r=s.product,i=null==(a=null==r?void 0:r.variants)?void 0:a[0],l=null==(t=null==i?void 0:i.images)?void 0:t[0];return r?e.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-lg",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("img",{src:l||"/images/white-image.png",alt:(null==r?void 0:r.name)||"Sản phẩm",className:"w-12 h-12 object-contain rounded"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:(null==r?void 0:r.name)||"Sản phẩm không xác định"}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:["Số lượng: ",s.quantity," | Giá: ",Ce(s.price)]}),(null==r?void 0:r.code)&&e.jsxs("p",{className:"text-xs text-muted-foreground",children:["Mã: ",r.code]})]})]}),e.jsxs(L,{variant:"outline",size:"sm",onClick:()=>(e=>{var s;if(!e.product)return;const n=e.product,a=null==(s=null==n?void 0:n.variants)?void 0:s[0];if(!a)return void U.error("Không thể xác định thông tin variant của sản phẩm");const t=N.findIndex((e=>e.product===n.id&&e.variant.colorId===a.colorId&&e.variant.sizeId===a.sizeId));if(t>=0){const s=[...N];s[t].quantity<e.quantity&&(s[t].quantity+=1,v(s))}else v([...N,{product:n.id,variant:{colorId:a.colorId,sizeId:a.sizeId},quantity:1,maxQuantity:e.quantity,productName:n.name,price:e.price}])})(s),className:"gap-2",children:[e.jsx(d.Icon,{path:f,size:.7}),"Thêm"]})]},n):e.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-lg bg-muted/50",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("img",{src:"/images/white-image.png",alt:"Sản phẩm không xác định",className:"w-12 h-12 object-contain rounded"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-muted-foreground",children:"Sản phẩm không xác định"}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:["Số lượng: ",s.quantity," | Giá: ",Ce(s.price)]})]})]}),e.jsx(L,{variant:"outline",size:"sm",disabled:!0,className:"gap-2",children:"Không thể trả"})]},n)}))})]}),N.length>0&&e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium mb-3",children:"Sản phẩm trả hàng:"}),e.jsx("div",{className:"space-y-2",children:N.map(((s,n)=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-muted rounded-lg",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:s.productName}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:["Số lượng: ",s.quantity," | Giá: ",Ce(s.price)]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(L,{variant:"outline",size:"sm",onClick:()=>(e=>{const s=[...N];s[e].quantity>1?s[e].quantity-=1:s.splice(e,1),v(s)})(n),className:"gap-1",children:e.jsx(d.Icon,{path:b,size:.7})}),e.jsx(L,{variant:"outline",size:"sm",onClick:()=>{const e=[...N];e.splice(n,1),v(e)},className:"gap-1 text-red-600 hover:text-red-700",children:e.jsx(d.Icon,{path:y,size:.7})})]})]},n)))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Lý do trả hàng *"}),e.jsx(ke,{value:w,onChange:e=>k(e.target.value),placeholder:"Nhập lý do bạn muốn trả hàng...",rows:3})]})]}),e.jsxs(ye,{children:[e.jsx(L,{variant:"outline",onClick:()=>t(!1),children:"Hủy"}),e.jsxs(L,{onClick:()=>{if(!s||0===N.length||!w.trim())return void U.error("Vui lòng chọn sản phẩm và nhập lý do trả hàng");const e={originalOrder:s,items:N.map((e=>({product:e.product,variant:e.variant,quantity:e.quantity}))),reason:w.trim()};x.mutate(e,{onSuccess:()=>{U.success("Yêu cầu trả hàng đã được gửi thành công"),v([]),k(""),t(!1),null==r||r()},onError:e=>{U.error("Đã xảy ra lỗi khi tạo yêu cầu trả hàng")}})},disabled:x.isPending||0===N.length||!w.trim(),className:"gap-2",children:[x.isPending?e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-2 border-t-transparent border-white"}):e.jsx(d.Icon,{path:l,size:.7}),"Gửi yêu cầu trả hàng"]})]})]})}):null},Ee=({returnId:s,open:n,onOpenChange:a,onCancel:t})=>{const{data:r,isLoading:i,isError:l}=se(s||""),c=ne();return n&&s?e.jsx(je,{open:n,onOpenChange:a,children:e.jsx(Ne,{className:"max-w-3xl max-h-[90vh] overflow-auto",children:i?e.jsx("div",{className:"flex items-center justify-center p-8",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-primary"})}):l?e.jsx("div",{className:"p-8 text-center",children:e.jsx("p",{className:"text-red-500",children:"Đã xảy ra lỗi khi tải thông tin trả hàng."})}):r&&r.data?e.jsxs(e.Fragment,{children:[e.jsxs(ve,{children:[e.jsxs(fe,{children:["Chi tiết trả hàng #",r.data.code]}),e.jsxs(be,{children:["Ngày tạo: ",Ae(new Date(r.data.createdAt),"dd/MM/yyyy HH:mm",{locale:De})]}),e.jsx("div",{className:"mt-2",children:e.jsx(ze,{status:r.data.status})})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs(ae,{children:[e.jsx(te,{className:"pb-3",children:e.jsx(re,{className:"text-base",children:"Thông tin đơn hàng gốc"})}),e.jsx(ie,{children:e.jsxs("p",{className:"text-sm",children:["Mã đơn hàng: ",e.jsx("span",{className:"font-medium",children:"string"==typeof r.data.originalOrder?r.data.originalOrder:r.data.originalOrder.code})]})})]}),e.jsxs(ae,{children:[e.jsx(te,{className:"pb-3",children:e.jsx(re,{className:"text-base",children:"Sản phẩm trả hàng"})}),e.jsx(ie,{children:e.jsx("div",{className:"space-y-3",children:r.data.items.map(((s,n)=>{var a,t;const r=s.product,i=null==(a=null==r?void 0:r.variants)?void 0:a[0],l=null==(t=null==i?void 0:i.images)?void 0:t[0];return e.jsxs("div",{className:"flex items-center space-x-3 p-3 border rounded-lg",children:[e.jsx("img",{src:l||"/images/white-image.png",alt:(null==r?void 0:r.name)||"Sản phẩm",className:"w-12 h-12 object-contain rounded"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"font-medium",children:(null==r?void 0:r.name)||"Sản phẩm không xác định"}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:["Số lượng: ",s.quantity," | Giá: ",Ce(s.price)]}),(null==r?void 0:r.code)&&e.jsxs("p",{className:"text-xs text-muted-foreground",children:["Mã: ",r.code]}),s.reason&&e.jsxs("p",{className:"text-sm text-muted-foreground",children:["Lý do: ",s.reason]})]})]},n)}))})})]}),e.jsxs(ae,{children:[e.jsx(te,{className:"pb-3",children:e.jsx(re,{className:"text-base",children:"Thông tin hoàn tiền"})}),e.jsx(ie,{children:e.jsxs("div",{className:"flex justify-between items-center text-lg font-bold",children:[e.jsx("span",{children:"Tổng tiền hoàn:"}),e.jsx("span",{className:"text-primary",children:Ce(r.data.totalRefund)})]})})]})]}),e.jsxs(ye,{children:["CHO_XU_LY"===r.data.status&&e.jsxs(L,{variant:"destructive",onClick:()=>{s&&c.mutate(s,{onSuccess:()=>{U.success("Đã hủy yêu cầu trả hàng"),null==t||t(),a(!1)},onError:e=>{U.error("Đã xảy ra lỗi khi hủy yêu cầu")}})},disabled:c.isPending,className:"gap-2",children:[c.isPending?e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-2 border-t-transparent border-white"}):e.jsx(d.Icon,{path:w,size:.7}),"Hủy yêu cầu"]}),e.jsx(L,{variant:"outline",onClick:()=>a(!1),children:"Đóng"})]})]}):e.jsx("div",{className:"p-8 text-center",children:e.jsx("p",{className:"text-muted-foreground",children:"Không tìm thấy thông tin trả hàng."})})})}):null},Me=()=>{var s,n;const{profile:r}=K(),i=null==r?void 0:r.data,{showToast:l}=Q(),c=F(),o=Ie({fullName:Te().min(2,{message:"Họ và tên phải có ít nhất 2 ký tự"}),email:Te().email({message:"Email không hợp lệ"}),phoneNumber:Te().regex(/^[0-9]{10,11}$/,{message:"Số điện thoại không hợp lệ"}).optional().or(Se(""))}),h=H({resolver:A(o),defaultValues:{fullName:(null==i?void 0:i.fullName)||"",email:(null==i?void 0:i.email)||"",phoneNumber:(null==i?void 0:i.phoneNumber)||""}});a.useEffect((()=>{i&&h.reset({fullName:i.fullName||"",email:i.email||"",phoneNumber:i.phoneNumber||""})}),[i,h]);return e.jsxs(ae,{children:[e.jsx(te,{children:e.jsxs(re,{className:"flex items-center gap-2",children:[e.jsx(d.Icon,{path:t,size:.7,className:"text-primary"}),e.jsx("span",{children:"Cập nhật thông tin cá nhân"})]})}),e.jsx(ie,{children:e.jsx(I,{...h,children:e.jsxs("form",{onSubmit:h.handleSubmit((e=>{c.mutate({fullName:e.fullName,phoneNumber:e.phoneNumber||void 0},{onSuccess:e=>{l({title:"Cập nhật thành công",message:"Thông tin cá nhân đã được cập nhật",type:"success"})},onError:e=>{l({title:"Lỗi",message:e.message||"Đã xảy ra lỗi khi cập nhật thông tin",type:"error"})}})})),className:"space-y-4",children:[e.jsxs("div",{className:"flex flex-col space-y-4 sm:flex-row sm:space-y-0 sm:space-x-4",children:[e.jsxs("div",{className:"sm:w-1/3 flex flex-col items-center space-y-4",children:[e.jsx("div",{className:"h-32 w-32 rounded-full bg-primary/10 flex items-center justify-center text-primary text-4xl font-semibold",children:(null==(s=null==i?void 0:i.fullName)?void 0:s.charAt(0))||(null==(n=null==i?void 0:i.email)?void 0:n.charAt(0))||"U"}),e.jsx(L,{variant:"outline",className:"w-full max-w-[160px]",type:"button",children:"Thay đổi ảnh"})]}),e.jsxs("div",{className:"sm:w-2/3 space-y-4",children:[e.jsx(T,{control:h.control,name:"fullName",render:({field:s})=>e.jsxs(S,{children:[e.jsx(D,{children:"Họ và tên"}),e.jsx(_,{children:e.jsx(Y,{placeholder:"Nhập họ và tên",...s})}),e.jsx(P,{})]})}),e.jsx(T,{control:h.control,name:"email",render:({field:s})=>e.jsxs(S,{children:[e.jsx(D,{children:"Email"}),e.jsx(_,{children:e.jsx(Y,{placeholder:"Nhập email",...s,disabled:!0})}),e.jsx(O,{children:"Email không thể thay đổi"}),e.jsx(P,{})]})}),e.jsx(T,{control:h.control,name:"phoneNumber",render:({field:s})=>e.jsxs(S,{children:[e.jsx(D,{children:"Số điện thoại"}),e.jsx(_,{children:e.jsx(Y,{placeholder:"Nhập số điện thoại",...s})}),e.jsx(P,{})]})})]})]}),e.jsxs("div",{className:"flex justify-end space-x-2",children:[e.jsx(L,{variant:"outline",type:"button",onClick:()=>h.reset(),children:"Hủy"}),e.jsxs(L,{type:"submit",disabled:c.isPending,className:"gap-2",children:[c.isPending?e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-2 border-t-transparent border-white"}):e.jsx(d.Icon,{path:m,size:.7}),"Lưu thay đổi"]})]})]})})})]})},qe=()=>{const s=B(),{showToast:n}=Q(),a=Ie({currentPassword:Te().min(6,{message:"Mật khẩu phải có ít nhất 6 ký tự"}),newPassword:Te().min(6,{message:"Mật khẩu mới phải có ít nhất 6 ký tự"}),confirmPassword:Te().min(6,{message:"Mật khẩu xác nhận phải có ít nhất 6 ký tự"})}).refine((e=>e.newPassword===e.confirmPassword),{message:"Mật khẩu xác nhận không khớp",path:["confirmPassword"]}),t=H({resolver:A(a),defaultValues:{currentPassword:"",newPassword:"",confirmPassword:""}});return e.jsxs(ae,{children:[e.jsxs(te,{children:[e.jsxs(re,{className:"flex items-center gap-2",children:[e.jsx(d.Icon,{path:r,size:.7,className:"text-primary"}),e.jsx("span",{children:"Đổi mật khẩu"})]}),e.jsx(le,{children:"Cập nhật mật khẩu để bảo vệ tài khoản của bạn"})]}),e.jsx(ie,{children:e.jsx(I,{...t,children:e.jsxs("form",{onSubmit:t.handleSubmit((e=>{s.mutate({currentPassword:e.currentPassword,newPassword:e.newPassword,confirmPassword:e.newPassword},{onSuccess:e=>{n({title:"Thành công",message:"Đổi mật khẩu thành công",type:"success"}),t.reset()},onError:e=>{n({title:"Lỗi",message:e.message||"Đã xảy ra lỗi khi đổi mật khẩu",type:"error"})}})})),className:"space-y-4",children:[e.jsx(T,{control:t.control,name:"currentPassword",render:({field:s})=>e.jsxs(S,{children:[e.jsx(D,{children:"Mật khẩu hiện tại"}),e.jsx(_,{children:e.jsx(Y,{type:"password",placeholder:"Nhập mật khẩu hiện tại",...s})}),e.jsx(P,{})]})}),e.jsx(T,{control:t.control,name:"newPassword",render:({field:s})=>e.jsxs(S,{children:[e.jsx(D,{children:"Mật khẩu mới"}),e.jsx(_,{children:e.jsx(Y,{type:"password",placeholder:"Nhập mật khẩu mới",...s})}),e.jsx(O,{children:"Mật khẩu phải có ít nhất 6 ký tự"}),e.jsx(P,{})]})}),e.jsx(T,{control:t.control,name:"confirmPassword",render:({field:s})=>e.jsxs(S,{children:[e.jsx(D,{children:"Xác nhận mật khẩu mới"}),e.jsx(_,{children:e.jsx(Y,{type:"password",placeholder:"Nhập lại mật khẩu mới",...s})}),e.jsx(P,{})]})}),e.jsxs("div",{className:"flex justify-end space-x-2 pt-4",children:[e.jsx(L,{variant:"outline",type:"button",onClick:()=>t.reset(),children:"Hủy"}),e.jsxs(L,{type:"submit",disabled:s.isPending,className:"gap-2",children:[s.isPending?e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-2 border-t-transparent border-white"}):e.jsx(d.Icon,{path:r,size:.7}),"Cập nhật mật khẩu"]})]})]})})})]})},Ve=()=>{var s,n;const{profile:a}=K(),t=null==(s=null==a?void 0:a.data)?void 0:s.id,{data:r,isLoading:i,isError:l}=Z(t||"",{});if(i)return e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[...Array(3)].map(((s,n)=>e.jsxs(ae,{children:[e.jsxs(te,{children:[e.jsx(we,{className:"h-6 w-3/4"}),e.jsx(we,{className:"h-4 w-1/2 mt-2"})]}),e.jsxs(ie,{className:"space-y-4",children:[e.jsx(we,{className:"h-4 w-full"}),e.jsx(we,{className:"h-4 w-2/3"}),e.jsx(we,{className:"h-10 w-1/3 mt-2"})]})]},n)))});if(l)return e.jsxs(ae,{children:[e.jsx(te,{children:e.jsxs(re,{className:"flex items-center gap-2",children:[e.jsx(d.Icon,{path:x,size:.7,className:"text-primary"}),e.jsx("span",{children:"Lỗi tải mã giảm giá"})]})}),e.jsx(ie,{children:e.jsx("p",{className:"text-red-500",children:"Đã xảy ra lỗi khi tải danh sách mã giảm giá của bạn. Vui lòng thử lại sau."})})]});const o=null==(n=null==r?void 0:r.data)?void 0:n.vouchers;return o&&0!==o.length?e.jsx("div",{className:"space-y-4",children:e.jsxs(ae,{children:[e.jsxs(te,{children:[e.jsxs(re,{className:"flex items-center gap-2",children:[e.jsx(d.Icon,{path:c,size:.7,className:"text-primary"}),e.jsx("span",{children:"Mã giảm giá của bạn"})]}),e.jsx(le,{children:"Danh sách các mã giảm giá bạn có thể sử dụng để tiết kiệm khi mua sắm."})]}),e.jsx(ie,{children:e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-x-6 gap-y-8",children:o.map((s=>{return e.jsxs(ae,{className:"relative overflow-hidden shadow-lg transition-all hover:shadow-xl group\n                                "+("KHONG_HOAT_DONG"===s.status||new Date(s.endDate)<new Date?"bg-muted/30 border-dashed":"bg-card border-primary/20 hover:border-primary/50"),children:[("KHONG_HOAT_DONG"===s.status||new Date(s.endDate)<new Date)&&e.jsx("div",{className:"absolute top-3 right-3 z-10",children:e.jsx(oe,{variant:"destructive",className:"text-xs px-2 py-1 rounded-full shadow-md",children:new Date(s.endDate)<new Date?"Đã hết hạn":"Ngừng hoạt động"})}),e.jsxs(te,{className:"pb-3 relative",children:[!("KHONG_HOAT_DONG"===s.status||new Date(s.endDate)<new Date)&&e.jsx("div",{className:"absolute -top-4 -left-5 w-16 h-16 bg-primary/10 rounded-full transform rotate-45 group-hover:scale-110 transition-transform duration-300"}),e.jsxs("div",{className:"relative z-0",children:[e.jsx(re,{className:"text-lg font-bold flex items-center gap-2.5 text-primary tracking-wide",children:s.name}),e.jsxs(le,{className:"text-xs mt-1",children:["Mã: ",e.jsx("span",{className:"font-semibold text-foreground tracking-wider bg-primary/10 px-1.5 py-0.5 rounded",children:s.code})]})]})]}),e.jsxs(ie,{className:"space-y-4.5 text-sm pt-2",children:[e.jsxs("div",{className:"border-t border-border pt-3 space-y-2",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"font-medium text-muted-foreground",children:"Giá trị giảm:"}),e.jsx("span",{className:"font-bold text-lg text-primary",children:(n=s.type,a=s.value,"PERCENTAGE"===n?`${a}%`:new Intl.NumberFormat("vi-VN",{style:"currency",currency:"VND"}).format(a))})]}),"PERCENTAGE"===s.type&&s.maxDiscount&&e.jsxs("div",{className:"flex justify-between items-center text-xs text-muted-foreground",children:[e.jsx("span",{children:"Tối đa:"}),e.jsx("span",{children:Ce(s.maxDiscount)})]})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"font-medium text-muted-foreground",children:"Đơn tối thiểu:"}),e.jsx("span",{className:"font-semibold",children:Ce(s.minOrderValue||0)})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"font-medium text-muted-foreground",children:"Hiệu lực:"}),e.jsxs("span",{className:"font-semibold",children:[R(s.startDate)," - ",R(s.endDate)]})]}),s.quantity-s.usedCount>0&&s.quantity<1/0&&e.jsxs("div",{className:"text-xs text-blue-600 flex justify-between items-center",children:[e.jsx("span",{className:"font-medium text-muted-foreground",children:"Lượt sử dụng còn lại:"}),e.jsx("span",{className:"font-semibold",children:s.quantity-s.usedCount})]}),"HOAT_DONG"===s.status&&new Date(s.endDate)>=new Date?e.jsxs(L,{variant:"default",size:"sm",className:"w-full mt-4 bg-primary hover:bg-primary/80 text-primary-foreground gap-2 shadow-md hover:shadow-lg transition-shadow",onClick:()=>{navigator.clipboard.writeText(s.code).then((()=>{U.success(`Đã sao chép mã: ${s.code}`,{position:"top-right",autoClose:3e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0,theme:"light"})})).catch((e=>{U.error("Không thể sao chép mã giảm giá.",{position:"top-right",autoClose:3e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0,theme:"light"})}))},children:[e.jsx(d.Icon,{path:u,size:.7}),"Sao chép mã"]}):e.jsx(L,{variant:"outline",size:"sm",className:"w-full mt-4 cursor-not-allowed",disabled:!0,children:"Không thể sử dụng"})]})]},s.id);var n,a}))})})]})}):e.jsxs(ae,{children:[e.jsx(te,{children:e.jsxs(re,{className:"flex items-center gap-2",children:[e.jsx(d.Icon,{path:c,size:.7}),e.jsx("span",{children:"Mã giảm giá"})]})}),e.jsx(ie,{children:e.jsx("p",{className:"text-muted-foreground",children:"Bạn không có mã giảm giá nào hiện có."})})]})},Ke=()=>{const{data:s,isLoading:n,isError:t,refetch:r}=W(),[i,c]=a.useState(null),[o,m]=a.useState(!1),x=e=>{try{return Ae(new Date(e),"dd/MM/yyyy",{locale:De})}catch(s){return e}};return e.jsxs(e.Fragment,{children:[e.jsxs(ae,{children:[e.jsx(te,{children:e.jsxs(re,{className:"flex items-center gap-2",children:[e.jsx(d.Icon,{path:l,size:.7,className:"text-primary"}),e.jsx("span",{children:"Đơn trả hàng của bạn"})]})}),e.jsx(ie,{children:n?e.jsx("div",{className:"flex items-center justify-center py-8",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-t-2 border-b-2 border-primary"})}):t?e.jsx("div",{className:"py-8 text-center",children:e.jsx("p",{className:"text-red-500",children:"Đã xảy ra lỗi khi tải đơn trả hàng. Vui lòng thử lại sau."})}):s&&s.data&&s.data.returns&&0!==s.data.returns.length?e.jsxs("div",{children:[e.jsxs(he,{children:[e.jsx(me,{children:e.jsxs(xe,{children:[e.jsx(ue,{className:"w-[120px] px-3 py-2",children:"Mã trả hàng"}),e.jsx(ue,{className:"px-3 py-2",children:"Ngày tạo"}),e.jsx(ue,{className:"px-3 py-2",children:"Đơn hàng gốc"}),e.jsx(ue,{className:"px-3 py-2",children:"Sản phẩm"}),e.jsx(ue,{className:"text-right px-3 py-2",children:"Số tiền hoàn"}),e.jsx(ue,{className:"px-3 py-2",children:"Trạng thái"}),e.jsx(ue,{className:"text-center px-3 py-2",children:"Thao tác"})]})}),e.jsx(pe,{children:s.data.returns.map((s=>{return e.jsxs(xe,{children:[e.jsx(ge,{className:"font-medium px-3 py-2",children:s.code}),e.jsx(ge,{className:"px-3 py-2",children:x(s.createdAt)}),e.jsx(ge,{className:"px-3 py-2",children:"string"==typeof s.originalOrder?s.originalOrder:s.originalOrder.code}),e.jsx(ge,{className:"px-3 py-2",children:e.jsxs("div",{className:"flex flex-col gap-1",children:[s.items.slice(0,2).map(((s,n)=>{var a;return e.jsxs("div",{className:"text-xs",children:[(null==(a=s.product)?void 0:a.name)||"Sản phẩm không xác định"," x",s.quantity]},n)})),s.items.length>2&&e.jsxs("div",{className:"text-xs text-muted-foreground",children:["+",s.items.length-2," sản phẩm khác"]})]})}),e.jsx(ge,{className:"text-right font-medium px-3 py-2",children:(n=s.totalRefund,new Intl.NumberFormat("vi-VN",{style:"currency",currency:"VND"}).format(n))}),e.jsx(ge,{className:"px-3 py-2",children:e.jsx(ze,{status:s.status})}),e.jsx(ge,{className:"text-center px-3 py-2",children:e.jsx(L,{variant:"outline",size:"icon",onClick:()=>{return e=s.id,c(e),void m(!0);var e},title:"Xem chi tiết",children:e.jsx(d.Icon,{path:h,size:.7})})})]},s.id);var n}))})]}),s.data.pagination&&s.data.pagination.totalPages>1&&e.jsx("div",{className:"flex items-center justify-center space-x-2 py-4",children:e.jsxs("div",{className:"text-sm text-muted-foreground",children:["Trang ",s.data.pagination.currentPage," / ",s.data.pagination.totalPages]})})]}):e.jsx("div",{className:"py-8 text-center",children:e.jsx("p",{className:"text-muted-foreground mb-4",children:"Bạn chưa có đơn trả hàng nào."})})})]}),e.jsx(Ee,{returnId:i,open:o,onOpenChange:m,onCancel:()=>r()})]})};function Le(){var m;const x=s();n().pathname;const[u,p]=a.useState("profile"),{isAuthenticated:g,profile:j,isLoadingProfile:N}=K(),[v,f]=a.useState(1),b=null==(m=null==j?void 0:j.data)?void 0:m.id,{data:y,isLoading:w,isError:k,refetch:C}=$(b||""),[H,A]=a.useState(null),[I,T]=a.useState(!1),[S,D]=a.useState(null),[_,P]=a.useState(!1),{data:O,refetch:F}=J();if(a.useEffect((()=>{const e=()=>{if("undefined"!=typeof window&&"#account-tabs"===window.location.hash){const e=new URLSearchParams(window.location.search).get("tab");e&&["profile","password","settings","orders","vouchers","returns"].includes(e)?p(e):p("profile")}};return e(),window.addEventListener("hashchange",e),()=>{window.removeEventListener("hashchange",e)}}),[]),a.useEffect((()=>{g||N||x("/auth/login")}),[g,N,router]),N)return e.jsx("div",{className:"flex items-center justify-center h-screen",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-primary"})});if(!g)return null;const Y=[{title:"Thông tin cá nhân",icon:t,value:"profile"},{title:"Đổi mật khẩu",icon:r,value:"password"},{title:"Đơn hàng của bạn",icon:i,value:"orders"},{title:"Trả hàng",icon:l,value:"returns"},{title:"Mã giảm giá",icon:c,value:"vouchers"}],B=e=>{var s,n;return"HOAN_THANH"===e.orderStatus&&(null==(n=null==(s=null==O?void 0:O.data)?void 0:s.orders)?void 0:n.some((s=>s.id===e.id)))},R=e=>{switch(e){case"COD":return"Thanh toán khi nhận hàng";case"VNPAY":return"Thanh toán qua VNPay";case"BANK_TRANSFER":return"Chuyển khoản ngân hàng";default:return e}},U=e=>{switch(e){case"PENDING":return"Chờ thanh toán";case"PAID":return"Đã thanh toán";case"FAILED":return"Thanh toán thất bại";case"REFUNDED":return"Đã hoàn tiền";default:return e}};return e.jsxs(_e.Provider,{value:{activeTab:u,setActiveTab:p},children:[e.jsxs("div",{className:"container mx-auto py-8 relative",children:[e.jsx(z,{className:"mb-4",children:e.jsxs(G,{children:[e.jsx(E,{children:e.jsx(M,{href:"/",className:"!text-maintext hover:!text-maintext",children:"Trang chủ"})}),e.jsx(q,{className:"!text-maintext hover:!text-maintext"}),e.jsx(E,{children:e.jsx(V,{className:"!text-maintext hover:!text-maintext",children:"Quản lý chung"})})]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-12 gap-4",children:[e.jsx(He.div,{className:"md:col-span-3",initial:"hidden",animate:"visible",children:e.jsxs(ae,{className:"sticky",children:[e.jsx(te,{children:e.jsx(re,{children:"Quản lý chung"})}),e.jsx(ie,{className:"p-0",children:e.jsx("nav",{className:"flex flex-col",id:"account-sidebar-tabs",children:Y.map((s=>e.jsx(He.div,{whileHover:{x:5},transition:{duration:.2},children:e.jsxs("a",{href:`#account-tabs?tab=${s.value}`,"data-value":s.value,className:"flex items-center justify-between px-4 py-3 hover:bg-muted "+(u===s.value?"bg-muted text-primary font-medium":""),onClick:()=>{p(s.value);const e=document.getElementById("account-tabs");e&&e.scrollIntoView({behavior:"smooth"})},children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(d.Icon,{path:s.icon,size:.7,className:"mr-3 text-maintext "+(u===s.value?"text-primary":"")}),e.jsx("span",{className:"text-maintext",children:s.title})]}),u===s.value&&e.jsx(d.Icon,{path:o,size:.7,className:"text-primary"})]})},s.value)))})})]})}),e.jsx(He.div,{className:"md:col-span-9",initial:"hidden",animate:"visible",children:e.jsxs(ce,{value:u,className:"w-full",children:[e.jsx(de,{value:"profile",children:"profile"===u&&e.jsx(Me,{})}),e.jsx(de,{value:"password",children:"password"===u&&e.jsx(qe,{})}),e.jsx(de,{value:"orders",children:e.jsxs(ae,{children:[e.jsx(te,{children:e.jsxs(re,{className:"flex items-center gap-2",children:[e.jsx(d.Icon,{path:i,size:.7,className:"text-primary"}),e.jsx("span",{children:"Đơn hàng của bạn"})]})}),e.jsx(ie,{children:w?e.jsx("div",{className:"flex items-center justify-center py-8",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-t-2 border-b-2 border-primary"})}):k?e.jsx("div",{className:"py-8 text-center",children:e.jsx("p",{className:"text-red-500",children:"Đã xảy ra lỗi khi tải đơn hàng. Vui lòng thử lại sau."})}):y&&y.data&&y.data.orders&&0!==y.data.orders.length?e.jsxs("div",{className:"overflow-x-auto",children:[e.jsxs(he,{className:"min-w-[1200px]",children:[e.jsx(me,{children:e.jsxs(xe,{children:[e.jsx(ue,{className:"w-[120px] px-3 py-2 whitespace-nowrap",children:"Mã đơn hàng"}),e.jsx(ue,{className:"w-[180px] px-3 py-2 whitespace-nowrap",children:"Ngày đặt"}),e.jsx(ue,{className:"w-[200px] px-3 py-2 whitespace-nowrap",children:"Sản phẩm"}),e.jsx(ue,{className:"w-[120px] text-right px-3 py-2 whitespace-nowrap",children:"Tổng tiền"}),e.jsx(ue,{className:"w-[140px] px-3 py-2 whitespace-nowrap",children:"Trạng thái đơn hàng"}),e.jsx(ue,{className:"w-[180px] px-3 py-2 whitespace-nowrap",children:"Phương thức thanh toán"}),e.jsx(ue,{className:"w-[140px] px-3 py-2 whitespace-nowrap",children:"Trạng thái thanh toán"}),e.jsx(ue,{className:"w-[120px] text-center px-3 py-2 whitespace-nowrap",children:"Thao tác"})]})}),e.jsx(pe,{children:y.data.orders.map((s=>{return e.jsxs(xe,{children:[e.jsx(ge,{className:"font-medium px-3 py-2 whitespace-nowrap text-maintext",children:s.code}),e.jsx(ge,{className:"px-3 py-2 whitespace-nowrap text-maintext",children:Ae(new Date(s.createdAt),"dd/MM/yyyy HH:mm",{locale:De})}),e.jsx(ge,{className:"px-3 py-2",children:e.jsxs("div",{className:"flex gap-1 flex-wrap",children:[s.items.slice(0,3).map(((s,n)=>{var a,t;const r=s.product,i=null==(a=null==r?void 0:r.variants)?void 0:a[0],l=null==(t=null==i?void 0:i.images)?void 0:t[0];return e.jsxs("div",{className:"relative",children:[e.jsx("img",{src:l||"/images/white-image.png",alt:(null==r?void 0:r.name)||"Sản phẩm",className:"w-12 h-12 object-contain rounded border",title:(null==r?void 0:r.name)||"Sản phẩm không xác định"}),e.jsx("span",{className:"absolute -top-1 -right-1 bg-primary text-white text-xs rounded-full w-5 h-5 flex items-center justify-center",children:s.quantity})]},n)})),s.items.length>3&&e.jsxs("div",{className:"w-12 h-12 bg-muted rounded border flex items-center justify-center text-xs text-muted-foreground",children:["+",s.items.length-3]})]})}),e.jsx(ge,{className:"text-right font-medium px-3 py-2 whitespace-nowrap text-maintext",children:(n=s.total,new Intl.NumberFormat("vi-VN",{style:"currency",currency:"VND"}).format(n))}),e.jsx(ge,{className:"px-3 py-2 ",children:e.jsx(Pe,{status:s.orderStatus})}),e.jsx(ge,{className:"px-3 py-2 whitespace-nowrap text-maintext",children:R(s.paymentMethod)}),e.jsx(ge,{className:"px-3 py-2",children:e.jsx(oe,{className:"PAID"===s.paymentStatus?"!bg-emerald-400 !text-white !border-emerald-500 text-nowrap !rounded":"!bg-extra text-nowrap text-white px-2 py-1 rounded",children:U(s.paymentStatus)})}),e.jsx(ge,{className:"text-center px-3 py-2",children:e.jsxs("div",{className:"flex items-center justify-start space-x-2",children:[e.jsx(L,{variant:"outline",size:"icon",onClick:()=>{return e=s.id,A(e),void T(!0);var e},title:"Xem chi tiết",children:e.jsx(d.Icon,{path:h,size:.7})}),B(s)&&e.jsx(L,{variant:"outline",size:"icon",onClick:()=>{return e=s.id,D(e),void P(!0);var e},title:"Yêu cầu trả hàng",children:e.jsx(d.Icon,{path:l,size:.7})})]})})]},s.id);var n}))})]}),y.data.pagination&&y.data.pagination.totalPages>1&&e.jsxs("div",{className:"flex items-center justify-center space-x-2 py-4",children:[e.jsx(L,{variant:"outline",size:"sm",disabled:1===v,onClick:()=>f(v-1),children:"Trang trước"}),e.jsxs("div",{className:"text-sm text-muted-foreground",children:["Trang ",v," / ",y.data.pagination.totalPages]}),e.jsx(L,{variant:"outline",size:"sm",disabled:v===y.data.pagination.totalPages,onClick:()=>f(v+1),children:"Trang sau"})]})]}):e.jsxs("div",{className:"py-8 text-center",children:[e.jsx("p",{className:"text-muted-foreground mb-4",children:"Bạn chưa có đơn hàng nào."}),e.jsx(L,{variant:"outline",asChild:!0,children:e.jsx("a",{href:"/products",children:"Mua sắm ngay"})})]})})]})}),e.jsx(de,{value:"returns",children:"returns"===u&&e.jsx(Ke,{})}),e.jsx(de,{value:"vouchers",children:"vouchers"===u&&e.jsx(Ve,{})})]})})]})]}),e.jsx(Oe,{orderId:H,open:I,onOpenChange:T}),e.jsx(Ge,{orderId:S,open:_,onOpenChange:P,onSuccess:()=>{C(),F()}})]})}const Fe=()=>e.jsx(Le,{});export{Fe as default};
