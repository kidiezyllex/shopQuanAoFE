import{U as $e,V as Xe,a as H,E as he,j as e,m as xe,W as Me,X as ge,Y as pe,Z as oe,_ as je,k as p,i as Qe,B as b,t as ze,$ as We,q as F,a0 as Ze,a1 as Je,a2 as W,a3 as es,a4 as Se,a5 as ss,a6 as R,x as ce,a7 as Oe,a8 as ts,a9 as le,p as Z,aa as as,ab as ns,ac as rs,ad as Ee,C as ue,ae as de}from"./index-Dpx_4rWJ.js";import{o as Ge,s as L,l as is,u as Re,a as _e,F as Ve,b as B,c as K,d as U,e as Y,f as $,g as qe}from"./form-BFysSGgk.js";import{B as cs,a as ls,b as Ie,c as ds,d as os,e as hs}from"./breadcrumb-CJedQ5QG.js";import{u as Fe,a as ms}from"./order-Cuy2edjT.js";import{u as Le}from"./useToast-DwXsNIYN.js";import{u as xs}from"./voucher-C7mr4xZE.js";import{u as Be,a as us,b as gs,c as ps,d as js}from"./return-D2yKC1D3.js";import{C,a as k,b as P,c as T,d as Ne}from"./card-fT6uSY2F.js";import{T as Ns,a as J}from"./tabs-BXj1bKUw.js";import{B as te}from"./badge-CA2Kv9aL.js";import{T as fe,a as be,b as X,c as y,d as ye,e as w}from"./table-BeX0puEz.js";import{D as we,a as ve,b as Ce,c as ke,d as Te,e as Pe}from"./dialog-BuHyDe_9.js";import{T as fs}from"./textarea-D-7Bay0_.js";import{f as _}from"./formatters-BzOSFyyi.js";import{f as ee,l as se}from"./index-VIuxkY8Z.js";import"./label-B0XdI4bT.js";import"./createLucideIcon-BdgKQErZ.js";import"./typeof-QjJsDpFa.js";const bs=H.createContext({activeTab:"profile",setActiveTab:n=>{}}),Ke=({status:n})=>{const l={CHO_XAC_NHAN:{label:"Chờ xác nhận",className:"!bg-yellow-400 !text-white !border-yellow-500 text-nowrap"},CHO_GIAO_HANG:{label:"Chờ giao hàng",className:"!bg-blue-400 !text-white !border-blue-500 text-nowrap"},DANG_VAN_CHUYEN:{label:"Đang vận chuyển",className:"!bg-orange-400 !text-white !border-orange-500 text-nowrap"},DA_GIAO_HANG:{label:"Đã giao hàng",className:"!bg-green-400 !text-white !border-green-500 text-nowrap"},HOAN_THANH:{label:"Hoàn thành",className:"!bg-emerald-400 !text-white !border-emerald-500 text-nowrap"},DA_HUY:{label:"Đã hủy",className:"!bg-red-400 !text-white !border-red-500 text-nowrap"}}[n]||{label:n,className:"bg-gray-400 text-maintext border-gray-500"};return e.jsx(te,{className:`${l.className} rounded-[4px] font-normal`,children:l.label})},ys=({orderId:n,open:i,onOpenChange:l})=>{var a;const{data:t,isLoading:u,isError:d}=ms(n||""),f=c=>{try{return ee(new Date(c),"dd/MM/yyyy HH:mm",{locale:se})}catch{return c}},g=c=>new Intl.NumberFormat("vi-VN",{style:"currency",currency:"VND"}).format(c),v=c=>{switch(c){case"COD":return"Thanh toán khi nhận hàng";case"VNPAY":return"Thanh toán qua VNPay";case"BANK_TRANSFER":return"Chuyển khoản ngân hàng";default:return c}},s=c=>{switch(c){case"PENDING":return"Chờ thanh toán";case"PAID":return"Đã thanh toán";case"FAILED":return"Thanh toán thất bại";case"REFUNDED":return"Đã hoàn tiền";default:return c}},m=(c,D)=>{const o=new Date(D),h=I=>{const E=new Date(o.getTime()+I*60*60*1e3);return ee(E,"HH:mm dd/MM/yyyy",{locale:se})},S=[{time:h(0),title:"Đơn hàng được tạo",message:"GHN có thông tin chi tiết về gói hàng của bạn và đang chuẩn bị để vận chuyển",completed:!0,icon:ue,color:"bg-blue-500"},{time:h(2),title:"Đang xử lý",message:"Kiện hàng của bạn đang được gửi đến trung tâm GHN và đang trong quá trình xử lý giao hàng",completed:!0,icon:de,color:"bg-orange-500"}];switch(c){case"CHO_XAC_NHAN":return[{time:h(0),title:"Chờ xác nhận",message:"Đơn hàng đã được tạo và đang chờ xác nhận từ cửa hàng",completed:!0,icon:ue,color:"bg-yellow-500"}];case"CHO_GIAO_HANG":return[...S,{time:h(4),title:"Đã xác nhận",message:"GHN đã xác nhận gói hàng của bạn bằng cách quét nhãn",completed:!0,icon:Z,color:"bg-green-500"},{time:h(6),title:"Chuẩn bị giao hàng",message:"Kiện hàng của bạn đã được gửi đi từ trung tâm GHN",completed:!0,icon:de,color:"bg-blue-500"}];case"DANG_VAN_CHUYEN":return[...S,{time:h(4),title:"Đã xác nhận",message:"GHN đã xác nhận gói hàng của bạn bằng cách quét nhãn",completed:!0,icon:Z,color:"bg-green-500"},{time:h(6),title:"Đang vận chuyển",message:"Kiện hàng của bạn đã được gửi đi từ trung tâm GHN",completed:!0,icon:le,color:"bg-blue-500"},{time:h(12),title:"Đang phân loại",message:"Kiện hàng của bạn đang được chuyển đến trung tâm GHN để phân loại",completed:!0,icon:de,color:"bg-orange-500"},{time:h(18),title:"Sẵn sàng giao hàng",message:"Kiện hàng của bạn đang ở cơ sở địa phương và sẵn sàng để giao hàng",completed:!0,icon:ce,color:"bg-purple-500"}];case"DA_GIAO_HANG":case"HOAN_THANH":return[...S,{time:h(4),title:"Đã xác nhận",message:"GHN đã xác nhận gói hàng của bạn bằng cách quét nhãn",completed:!0,icon:Z,color:"bg-green-500"},{time:h(6),title:"Đang vận chuyển",message:"Kiện hàng của bạn đã được gửi đi từ trung tâm GHN",completed:!0,icon:le,color:"bg-blue-500"},{time:h(12),title:"Đang phân loại",message:"Kiện hàng của bạn đang được chuyển đến trung tâm GHN để phân loại",completed:!0,icon:de,color:"bg-orange-500"},{time:h(18),title:"Sẵn sàng giao hàng",message:"Kiện hàng của bạn đang ở cơ sở địa phương và sẵn sàng để giao hàng",completed:!0,icon:ce,color:"bg-purple-500"},{time:h(24),title:"Đang giao hàng",message:"Kiện hàng của bạn đang được vận chuyển bằng xe GHN và sẽ được giao trong ngày hôm nay",completed:!0,icon:le,color:"bg-indigo-500"},{time:h(26),title:"Đã đến khu vực",message:"Kiện hàng của bạn đã đến cơ sở GHN tại khu vực của người nhận",completed:!0,icon:ce,color:"bg-teal-500"},{time:h(28),title:"Giao hàng thành công",message:"Giao hàng thành công. Cảm ơn bạn đã sử dụng dịch vụ!",completed:!0,icon:Z,color:"bg-emerald-500"}];case"DA_HUY":return[{time:h(0),title:"Đơn hàng được tạo",message:"Đơn hàng đã được tạo",completed:!0,icon:ue,color:"bg-blue-500"},{time:h(2),title:"Đơn hàng đã hủy",message:"Đơn hàng đã bị hủy theo yêu cầu",completed:!0,icon:Ee,color:"bg-red-500"}];default:return S}};return!i||!n?null:e.jsx(we,{open:i,onOpenChange:l,children:e.jsx(ve,{className:"max-w-4xl max-h-[90vh] overflow-auto",children:u?e.jsx("div",{className:"flex items-center justify-center p-8",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-primary"})}):d?e.jsx("div",{className:"p-8 text-center",children:e.jsx("p",{className:"text-red-500",children:"Đã xảy ra lỗi khi tải thông tin đơn hàng."})}):t&&t.data?e.jsxs(e.Fragment,{children:[e.jsxs(Ce,{className:"border-b pb-4",children:[e.jsxs(ke,{children:["Chi tiết đơn hàng #",(a=t.data)==null?void 0:a.code]}),e.jsxs(Te,{className:"mt-2",children:["Ngày đặt: ",f(t.data.createdAt)]}),e.jsx("div",{className:"mt-2",children:e.jsx(Ke,{status:t.data.orderStatus})})]}),e.jsxs("div",{className:"py-4 space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs(C,{children:[e.jsx(k,{className:"pb-3",children:e.jsxs(P,{className:"flex items-center gap-2",children:[e.jsx(p.Icon,{path:ce,size:.7,className:"mr-2"}),"Địa chỉ giao hàng"]})}),e.jsxs(T,{className:"space-y-4 text-sm",children:[e.jsxs("div",{className:"flex items-start",children:[e.jsx("span",{className:"text-muted-foreground w-32",children:"Người nhận:"}),e.jsx("span",{className:"font-medium",children:t.data.shippingAddress.name})]}),e.jsxs("div",{className:"flex items-start",children:[e.jsx("span",{className:"text-muted-foreground w-32",children:"Số điện thoại:"}),e.jsx("span",{children:t.data.shippingAddress.phoneNumber})]}),e.jsxs("div",{className:"flex items-start",children:[e.jsx("span",{className:"text-muted-foreground w-32",children:"Địa chỉ:"}),e.jsx("span",{children:t.data.shippingAddress.specificAddress})]})]})]}),e.jsxs(C,{children:[e.jsx(k,{className:"pb-3",children:e.jsxs(P,{className:"flex items-center gap-2",children:[e.jsx(p.Icon,{path:Oe,size:.7,className:"mr-2"}),"Thông tin thanh toán"]})}),e.jsxs(T,{className:"space-y-4 text-sm",children:[e.jsxs("div",{className:"flex items-start",children:[e.jsx("span",{className:"text-muted-foreground w-32",children:"Phương thức:"}),e.jsxs("div",{className:"flex items-center",children:[e.jsx(p.Icon,{path:t.data.paymentMethod==="COD"?ts:Oe,size:.7,className:"mr-2 text-primary"}),e.jsx("span",{children:v(t.data.paymentMethod)})]})]}),e.jsxs("div",{className:"flex items-start",children:[e.jsx("span",{className:"text-muted-foreground w-32",children:"Trạng thái:"}),e.jsx("span",{children:e.jsx(te,{className:t.data.paymentStatus==="PAID"?"bg-green-100 text-green-800 border-green-200":"!bg-extra text-white",children:s(t.data.paymentStatus)})})]})]})]})]}),e.jsxs(C,{children:[e.jsx(k,{className:"pb-3",children:e.jsxs(P,{className:"flex items-center gap-2",children:[e.jsx(p.Icon,{path:pe,size:.7,className:"mr-2"}),"Chi tiết đơn hàng"]})}),e.jsxs(T,{children:[e.jsxs(fe,{children:[e.jsx(be,{children:e.jsxs(X,{children:[e.jsx(y,{className:"w-[100px]",children:"Hình ảnh"}),e.jsx(y,{children:"Sản phẩm"}),e.jsx(y,{className:"text-right",children:"Đơn giá"}),e.jsx(y,{className:"text-center",children:"Số lượng"}),e.jsx(y,{className:"text-right",children:"Thành tiền"})]})}),e.jsx(ye,{children:t.data.items.map((c,D)=>{var I,E;const o=c.product,h=(I=o==null?void 0:o.variants)==null?void 0:I[0],S=(E=h==null?void 0:h.images)==null?void 0:E[0];return e.jsxs(X,{children:[e.jsx(w,{children:S?e.jsx("img",{src:S,alt:(o==null?void 0:o.name)||"",className:"w-16 h-16 object-contain rounded-md"}):e.jsx("img",{src:"/images/white-image.png",alt:(o==null?void 0:o.name)||"",className:"w-16 h-16 object-contain rounded-md"})}),e.jsx(w,{className:"font-medium",children:e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:(o==null?void 0:o.name)||"Sản phẩm không xác định"}),e.jsxs("div",{className:"text-xs text-muted-foreground",children:["Mã: ",(o==null?void 0:o.code)||"N/A"]}),(o==null?void 0:o.brand)&&e.jsxs("div",{className:"text-xs text-muted-foreground",children:["Thương hiệu: ",o.brand.name]})]})}),e.jsx(w,{className:"text-right",children:g(c.price)}),e.jsx(w,{className:"text-center",children:c.quantity}),e.jsx(w,{className:"text-right font-medium",children:g(c.price*c.quantity)})]},D)})})]}),e.jsxs("div",{className:"mt-6 space-y-4 border-t pt-4",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-muted-foreground",children:"Tạm tính:"}),e.jsx("span",{children:g(t.data.subTotal)})]}),t.data.discount>0&&e.jsxs("div",{className:"flex justify-between items-center text-green-600",children:[e.jsx("span",{children:"Giảm giá:"}),e.jsxs("span",{children:["-",g(t.data.discount)]})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-muted-foreground",children:"Phí vận chuyển:"}),e.jsx("span",{children:g(t.data.total-t.data.subTotal+t.data.discount||0)})]}),e.jsxs("div",{className:"flex justify-between items-center text-lg font-bold border-t pt-3",children:[e.jsx("span",{children:"Tổng tiền:"}),e.jsx("span",{className:"text-primary",children:g(t.data.total)})]})]})]})]}),e.jsxs(C,{className:"overflow-hidden",children:[e.jsx(k,{children:e.jsxs(P,{className:"flex items-center gap-2",children:[e.jsx(p.Icon,{path:le,size:.7,className:"mr-3 text-primary"}),"Tiến trình đơn hàng"]})}),e.jsx(T,{className:"p-4",children:e.jsx("div",{className:"relative",children:m(t.data.orderStatus,t.data.createdAt).map((c,D,o)=>e.jsxs("div",{className:"relative flex items-start pb-8 last:pb-0",children:[D<o.length-1&&e.jsx("div",{className:"absolute left-6 top-12 w-0.5 h-full bg-gradient-to-b from-gray-300 to-gray-200"}),e.jsx("div",{className:"relative flex-shrink-0 mr-4",children:e.jsx("div",{className:`w-12 h-12 rounded-full ${c.color} flex items-center justify-center shadow-lg ring-4 ring-white`,children:e.jsx(p.Icon,{path:c.icon,size:.7,className:"text-white"})})}),e.jsxs("div",{className:"flex-1 min-w-0 bg-white rounded-lg border border-gray-100 p-4 shadow-sm hover:shadow-md transition-shadow duration-200",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("h4",{className:"text-sm font-semibold text-maintext",children:c.title}),e.jsx("span",{className:"text-xs text-muted-foreground bg-gray-50 px-2 py-1 rounded-full",children:c.time})]}),e.jsx("p",{className:"text-sm text-maintext leading-relaxed",children:c.message}),c.completed&&e.jsxs("div",{className:"mt-3 flex items-center text-xs text-green-600",children:[e.jsx(p.Icon,{path:Z,size:.7,className:"mr-1"}),"Hoàn thành"]})]})]},D))})})]})]}),e.jsx(Pe,{className:"border-t pt-4",children:e.jsx(b,{variant:"outline",onClick:()=>l(!1),children:"Đóng"})})]}):e.jsx("div",{className:"p-8 text-center",children:e.jsx("p",{className:"text-muted-foreground",children:"Không tìm thấy thông tin đơn hàng."})})})})},Ue=({status:n})=>{const l={CHO_XU_LY:{label:"Chờ xử lý",className:"!bg-yellow-400 !text-white !border-yellow-500 text-nowrap"},DA_HOAN_TIEN:{label:"Đã hoàn tiền",className:"!bg-green-400 !text-white !border-green-500 text-nowrap"},DA_HUY:{label:"Đã hủy",className:"!bg-red-400 !text-white !border-red-500 text-nowrap"}}[n]||{label:n,className:"bg-gray-400 text-maintext border-gray-500"};return e.jsx(te,{className:`${l.className} rounded-[4px] font-normal`,children:l.label})},ws=({orderId:n,open:i,onOpenChange:l,onSuccess:t})=>{var ae,ne,Q,V,re;const u=gs(),{data:d}=Be(),{profile:f}=he(),g=(ae=f==null?void 0:f.data)==null?void 0:ae.id,{data:v}=Fe(g||""),[s,m]=H.useState([]),[a,c]=H.useState(""),D=(Q=(ne=d==null?void 0:d.data)==null?void 0:ne.orders)==null?void 0:Q.find(x=>x.id===n),h=((re=(V=v==null?void 0:v.data)==null?void 0:V.orders)==null?void 0:re.find(x=>x.id===n))||D,S=x=>{var q;if(!x.product)return;const j=x.product,N=(q=j==null?void 0:j.variants)==null?void 0:q[0];if(!N){R.error("Không thể xác định thông tin variant của sản phẩm");return}const M=s.findIndex(A=>A.product===j.id&&A.variant.colorId===N.colorId&&A.variant.sizeId===N.sizeId);if(M>=0){const A=[...s];A[M].quantity<x.quantity&&(A[M].quantity+=1,m(A))}else m([...s,{product:j.id,variant:{colorId:N.colorId,sizeId:N.sizeId},quantity:1,maxQuantity:x.quantity,productName:j.name,price:x.price}])},I=x=>{const j=[...s];j[x].quantity>1?j[x].quantity-=1:j.splice(x,1),m(j)},E=()=>{if(!n||s.length===0||!a.trim()){R.error("Vui lòng chọn sản phẩm và nhập lý do trả hàng");return}const x={originalOrder:n,items:s.map(j=>({product:j.product,variant:j.variant,quantity:j.quantity})),reason:a.trim()};u.mutate(x,{onSuccess:()=>{R.success("Yêu cầu trả hàng đã được gửi thành công"),m([]),c(""),l(!1),t==null||t()},onError:j=>{R.error("Đã xảy ra lỗi khi tạo yêu cầu trả hàng")}})};return!i||!n||!h?null:e.jsx(we,{open:i,onOpenChange:l,children:e.jsxs(ve,{className:"max-w-4xl max-h-[90vh] overflow-auto",children:[e.jsxs(Ce,{children:[e.jsxs(ke,{children:["Tạo yêu cầu trả hàng - Đơn #",h.code]}),e.jsx(Te,{children:"Chọn sản phẩm bạn muốn trả và nhập lý do trả hàng"})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium mb-3",children:"Sản phẩm trong đơn hàng:"}),e.jsx("div",{className:"space-y-2 max-h-60 overflow-y-auto",children:h.items.map((x,j)=>{var A,ie;const N=x.product,M=(A=N==null?void 0:N.variants)==null?void 0:A[0],q=(ie=M==null?void 0:M.images)==null?void 0:ie[0];return N?e.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-lg",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("img",{src:q||"/images/white-image.png",alt:(N==null?void 0:N.name)||"Sản phẩm",className:"w-12 h-12 object-contain rounded"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:(N==null?void 0:N.name)||"Sản phẩm không xác định"}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:["Số lượng: ",x.quantity," | Giá: ",_(x.price)]}),(N==null?void 0:N.code)&&e.jsxs("p",{className:"text-xs text-muted-foreground",children:["Mã: ",N.code]})]})]}),e.jsxs(b,{variant:"outline",size:"sm",onClick:()=>S(x),className:"gap-2",children:[e.jsx(p.Icon,{path:as,size:.7}),"Thêm"]})]},j):e.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-lg bg-muted/50",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("img",{src:"/images/white-image.png",alt:"Sản phẩm không xác định",className:"w-12 h-12 object-contain rounded"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-muted-foreground",children:"Sản phẩm không xác định"}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:["Số lượng: ",x.quantity," | Giá: ",_(x.price)]})]})]}),e.jsx(b,{variant:"outline",size:"sm",disabled:!0,className:"gap-2",children:"Không thể trả"})]},j)})})]}),s.length>0&&e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium mb-3",children:"Sản phẩm trả hàng:"}),e.jsx("div",{className:"space-y-2",children:s.map((x,j)=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-muted rounded-lg",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:x.productName}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:["Số lượng: ",x.quantity," | Giá: ",_(x.price)]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(b,{variant:"outline",size:"sm",onClick:()=>I(j),className:"gap-1",children:e.jsx(p.Icon,{path:ns,size:.7})}),e.jsx(b,{variant:"outline",size:"sm",onClick:()=>{const N=[...s];N.splice(j,1),m(N)},className:"gap-1 text-red-600 hover:text-red-700",children:e.jsx(p.Icon,{path:rs,size:.7})})]})]},j))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Lý do trả hàng *"}),e.jsx(fs,{value:a,onChange:x=>c(x.target.value),placeholder:"Nhập lý do bạn muốn trả hàng...",rows:3})]})]}),e.jsxs(Pe,{children:[e.jsx(b,{variant:"outline",onClick:()=>l(!1),children:"Hủy"}),e.jsxs(b,{onClick:E,disabled:u.isPending||s.length===0||!a.trim(),className:"gap-2",children:[u.isPending?e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-2 border-t-transparent border-white"}):e.jsx(p.Icon,{path:oe,size:.7}),"Gửi yêu cầu trả hàng"]})]})]})})},vs=({returnId:n,open:i,onOpenChange:l,onCancel:t})=>{const{data:u,isLoading:d,isError:f}=ps(n||""),g=js(),v=()=>{n&&g.mutate(n,{onSuccess:()=>{R.success("Đã hủy yêu cầu trả hàng"),t==null||t(),l(!1)},onError:s=>{R.error("Đã xảy ra lỗi khi hủy yêu cầu")}})};return!i||!n?null:e.jsx(we,{open:i,onOpenChange:l,children:e.jsx(ve,{className:"max-w-3xl max-h-[90vh] overflow-auto",children:d?e.jsx("div",{className:"flex items-center justify-center p-8",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-primary"})}):f?e.jsx("div",{className:"p-8 text-center",children:e.jsx("p",{className:"text-red-500",children:"Đã xảy ra lỗi khi tải thông tin trả hàng."})}):u&&u.data?e.jsxs(e.Fragment,{children:[e.jsxs(Ce,{children:[e.jsxs(ke,{children:["Chi tiết trả hàng #",u.data.code]}),e.jsxs(Te,{children:["Ngày tạo: ",ee(new Date(u.data.createdAt),"dd/MM/yyyy HH:mm",{locale:se})]}),e.jsx("div",{className:"mt-2",children:e.jsx(Ue,{status:u.data.status})})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs(C,{children:[e.jsx(k,{className:"pb-3",children:e.jsx(P,{className:"text-base",children:"Thông tin đơn hàng gốc"})}),e.jsx(T,{children:e.jsxs("p",{className:"text-sm",children:["Mã đơn hàng: ",e.jsx("span",{className:"font-medium",children:typeof u.data.originalOrder=="string"?u.data.originalOrder:u.data.originalOrder.code})]})})]}),e.jsxs(C,{children:[e.jsx(k,{className:"pb-3",children:e.jsx(P,{className:"text-base",children:"Sản phẩm trả hàng"})}),e.jsx(T,{children:e.jsx("div",{className:"space-y-3",children:u.data.items.map((s,m)=>{var o,h;const a=s.product,c=(o=a==null?void 0:a.variants)==null?void 0:o[0],D=(h=c==null?void 0:c.images)==null?void 0:h[0];return e.jsxs("div",{className:"flex items-center space-x-3 p-3 border rounded-lg",children:[e.jsx("img",{src:D||"/images/white-image.png",alt:(a==null?void 0:a.name)||"Sản phẩm",className:"w-12 h-12 object-contain rounded"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"font-medium",children:(a==null?void 0:a.name)||"Sản phẩm không xác định"}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:["Số lượng: ",s.quantity," | Giá: ",_(s.price)]}),(a==null?void 0:a.code)&&e.jsxs("p",{className:"text-xs text-muted-foreground",children:["Mã: ",a.code]}),s.reason&&e.jsxs("p",{className:"text-sm text-muted-foreground",children:["Lý do: ",s.reason]})]})]},m)})})})]}),e.jsxs(C,{children:[e.jsx(k,{className:"pb-3",children:e.jsx(P,{className:"text-base",children:"Thông tin hoàn tiền"})}),e.jsx(T,{children:e.jsxs("div",{className:"flex justify-between items-center text-lg font-bold",children:[e.jsx("span",{children:"Tổng tiền hoàn:"}),e.jsx("span",{className:"text-primary",children:_(u.data.totalRefund)})]})})]})]}),e.jsxs(Pe,{children:[u.data.status==="CHO_XU_LY"&&e.jsxs(b,{variant:"destructive",onClick:v,disabled:g.isPending,className:"gap-2",children:[g.isPending?e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-2 border-t-transparent border-white"}):e.jsx(p.Icon,{path:Ee,size:.7}),"Hủy yêu cầu"]}),e.jsx(b,{variant:"outline",onClick:()=>l(!1),children:"Đóng"})]})]}):e.jsx("div",{className:"p-8 text-center",children:e.jsx("p",{className:"text-muted-foreground",children:"Không tìm thấy thông tin trả hàng."})})})})},Cs=()=>{var g,v;const{profile:n}=he(),i=n==null?void 0:n.data,{showToast:l}=Le(),t=We(),u=Ge({fullName:L().min(2,{message:"Họ và tên phải có ít nhất 2 ký tự"}),email:L().email({message:"Email không hợp lệ"}),phoneNumber:L().regex(/^[0-9]{10,11}$/,{message:"Số điện thoại không hợp lệ"}).optional().or(is(""))}),d=Re({resolver:_e(u),defaultValues:{fullName:(i==null?void 0:i.fullName)||"",email:(i==null?void 0:i.email)||"",phoneNumber:(i==null?void 0:i.phoneNumber)||""}});H.useEffect(()=>{i&&d.reset({fullName:i.fullName||"",email:i.email||"",phoneNumber:i.phoneNumber||""})},[i,d]);const f=s=>{t.mutate({fullName:s.fullName,phoneNumber:s.phoneNumber||void 0},{onSuccess:m=>{l({title:"Cập nhật thành công",message:"Thông tin cá nhân đã được cập nhật",type:"success"})},onError:m=>{l({title:"Lỗi",message:m.message||"Đã xảy ra lỗi khi cập nhật thông tin",type:"error"})}})};return e.jsxs(C,{children:[e.jsx(k,{children:e.jsxs(P,{className:"flex items-center gap-2",children:[e.jsx(p.Icon,{path:Me,size:.7,className:"text-primary"}),e.jsx("span",{children:"Cập nhật thông tin cá nhân"})]})}),e.jsx(T,{children:e.jsx(Ve,{...d,children:e.jsxs("form",{onSubmit:d.handleSubmit(f),className:"space-y-4",children:[e.jsxs("div",{className:"flex flex-col space-y-4 sm:flex-row sm:space-y-0 sm:space-x-4",children:[e.jsxs("div",{className:"sm:w-1/3 flex flex-col items-center space-y-4",children:[e.jsx("div",{className:"h-32 w-32 rounded-full bg-primary/10 flex items-center justify-center text-primary text-4xl font-semibold",children:((g=i==null?void 0:i.fullName)==null?void 0:g.charAt(0))||((v=i==null?void 0:i.email)==null?void 0:v.charAt(0))||"U"}),e.jsx(b,{variant:"outline",className:"w-full max-w-[160px]",type:"button",children:"Thay đổi ảnh"})]}),e.jsxs("div",{className:"sm:w-2/3 space-y-4",children:[e.jsx(B,{control:d.control,name:"fullName",render:({field:s})=>e.jsxs(K,{children:[e.jsx(U,{children:"Họ và tên"}),e.jsx(Y,{children:e.jsx(F,{placeholder:"Nhập họ và tên",...s})}),e.jsx($,{})]})}),e.jsx(B,{control:d.control,name:"email",render:({field:s})=>e.jsxs(K,{children:[e.jsx(U,{children:"Email"}),e.jsx(Y,{children:e.jsx(F,{placeholder:"Nhập email",...s,disabled:!0})}),e.jsx(qe,{children:"Email không thể thay đổi"}),e.jsx($,{})]})}),e.jsx(B,{control:d.control,name:"phoneNumber",render:({field:s})=>e.jsxs(K,{children:[e.jsx(U,{children:"Số điện thoại"}),e.jsx(Y,{children:e.jsx(F,{placeholder:"Nhập số điện thoại",...s})}),e.jsx($,{})]})})]})]}),e.jsxs("div",{className:"flex justify-end space-x-2",children:[e.jsx(b,{variant:"outline",type:"button",onClick:()=>d.reset(),children:"Hủy"}),e.jsxs(b,{type:"submit",disabled:t.isPending,className:"gap-2",children:[t.isPending?e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-2 border-t-transparent border-white"}):e.jsx(p.Icon,{path:Ze,size:.7}),"Lưu thay đổi"]})]})]})})})]})},ks=()=>{const n=Je(),{showToast:i}=Le(),l=Ge({currentPassword:L().min(6,{message:"Mật khẩu phải có ít nhất 6 ký tự"}),newPassword:L().min(6,{message:"Mật khẩu mới phải có ít nhất 6 ký tự"}),confirmPassword:L().min(6,{message:"Mật khẩu xác nhận phải có ít nhất 6 ký tự"})}).refine(d=>d.newPassword===d.confirmPassword,{message:"Mật khẩu xác nhận không khớp",path:["confirmPassword"]}),t=Re({resolver:_e(l),defaultValues:{currentPassword:"",newPassword:"",confirmPassword:""}}),u=d=>{n.mutate({currentPassword:d.currentPassword,newPassword:d.newPassword,confirmPassword:d.newPassword},{onSuccess:f=>{i({title:"Thành công",message:"Đổi mật khẩu thành công",type:"success"}),t.reset()},onError:f=>{i({title:"Lỗi",message:f.message||"Đã xảy ra lỗi khi đổi mật khẩu",type:"error"})}})};return e.jsxs(C,{children:[e.jsxs(k,{children:[e.jsxs(P,{className:"flex items-center gap-2",children:[e.jsx(p.Icon,{path:ge,size:.7,className:"text-primary"}),e.jsx("span",{children:"Đổi mật khẩu"})]}),e.jsx(Ne,{children:"Cập nhật mật khẩu để bảo vệ tài khoản của bạn"})]}),e.jsx(T,{children:e.jsx(Ve,{...t,children:e.jsxs("form",{onSubmit:t.handleSubmit(u),className:"space-y-4",children:[e.jsx(B,{control:t.control,name:"currentPassword",render:({field:d})=>e.jsxs(K,{children:[e.jsx(U,{children:"Mật khẩu hiện tại"}),e.jsx(Y,{children:e.jsx(F,{type:"password",placeholder:"Nhập mật khẩu hiện tại",...d})}),e.jsx($,{})]})}),e.jsx(B,{control:t.control,name:"newPassword",render:({field:d})=>e.jsxs(K,{children:[e.jsx(U,{children:"Mật khẩu mới"}),e.jsx(Y,{children:e.jsx(F,{type:"password",placeholder:"Nhập mật khẩu mới",...d})}),e.jsx(qe,{children:"Mật khẩu phải có ít nhất 6 ký tự"}),e.jsx($,{})]})}),e.jsx(B,{control:t.control,name:"confirmPassword",render:({field:d})=>e.jsxs(K,{children:[e.jsx(U,{children:"Xác nhận mật khẩu mới"}),e.jsx(Y,{children:e.jsx(F,{type:"password",placeholder:"Nhập lại mật khẩu mới",...d})}),e.jsx($,{})]})}),e.jsxs("div",{className:"flex justify-end space-x-2 pt-4",children:[e.jsx(b,{variant:"outline",type:"button",onClick:()=>t.reset(),children:"Hủy"}),e.jsxs(b,{type:"submit",disabled:n.isPending,className:"gap-2",children:[n.isPending?e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-2 border-t-transparent border-white"}):e.jsx(p.Icon,{path:ge,size:.7}),"Cập nhật mật khẩu"]})]})]})})})]})},Ts=()=>{var g,v;const{profile:n}=he(),i=(g=n==null?void 0:n.data)==null?void 0:g.id,{data:l,isLoading:t,isError:u}=xs(i||"",{}),d=(s,m)=>s==="PERCENTAGE"?`${m}%`:new Intl.NumberFormat("vi-VN",{style:"currency",currency:"VND"}).format(m);if(t)return e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[...Array(3)].map((s,m)=>e.jsxs(C,{children:[e.jsxs(k,{children:[e.jsx(W,{className:"h-6 w-3/4"}),e.jsx(W,{className:"h-4 w-1/2 mt-2"})]}),e.jsxs(T,{className:"space-y-4",children:[e.jsx(W,{className:"h-4 w-full"}),e.jsx(W,{className:"h-4 w-2/3"}),e.jsx(W,{className:"h-10 w-1/3 mt-2"})]})]},m))});if(u)return e.jsxs(C,{children:[e.jsx(k,{children:e.jsxs(P,{className:"flex items-center gap-2",children:[e.jsx(p.Icon,{path:es,size:.7,className:"text-primary"}),e.jsx("span",{children:"Lỗi tải mã giảm giá"})]})}),e.jsx(T,{children:e.jsx("p",{className:"text-red-500",children:"Đã xảy ra lỗi khi tải danh sách mã giảm giá của bạn. Vui lòng thử lại sau."})})]});const f=(v=l==null?void 0:l.data)==null?void 0:v.vouchers;return!f||f.length===0?e.jsxs(C,{children:[e.jsx(k,{children:e.jsxs(P,{className:"flex items-center gap-2",children:[e.jsx(p.Icon,{path:je,size:.7}),e.jsx("span",{children:"Mã giảm giá"})]})}),e.jsx(T,{children:e.jsx("p",{className:"text-muted-foreground",children:"Bạn không có mã giảm giá nào hiện có."})})]}):e.jsx("div",{className:"space-y-4",children:e.jsxs(C,{children:[e.jsxs(k,{children:[e.jsxs(P,{className:"flex items-center gap-2",children:[e.jsx(p.Icon,{path:je,size:.7,className:"text-primary"}),e.jsx("span",{children:"Mã giảm giá của bạn"})]}),e.jsx(Ne,{children:"Danh sách các mã giảm giá bạn có thể sử dụng để tiết kiệm khi mua sắm."})]}),e.jsx(T,{children:e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-x-6 gap-y-8",children:f.map(s=>e.jsxs(C,{className:`relative overflow-hidden shadow-lg transition-all hover:shadow-xl group
                                ${s.status==="KHONG_HOAT_DONG"||new Date(s.endDate)<new Date?"bg-muted/30 border-dashed":"bg-card border-primary/20 hover:border-primary/50"}`,children:[(s.status==="KHONG_HOAT_DONG"||new Date(s.endDate)<new Date)&&e.jsx("div",{className:"absolute top-3 right-3 z-10",children:e.jsx(te,{variant:"destructive",className:"text-xs px-2 py-1 rounded-full shadow-md",children:new Date(s.endDate)<new Date?"Đã hết hạn":"Ngừng hoạt động"})}),e.jsxs(k,{className:"pb-3 relative",children:[!(s.status==="KHONG_HOAT_DONG"||new Date(s.endDate)<new Date)&&e.jsx("div",{className:"absolute -top-4 -left-5 w-16 h-16 bg-primary/10 rounded-full transform rotate-45 group-hover:scale-110 transition-transform duration-300"}),e.jsxs("div",{className:"relative z-0",children:[e.jsx(P,{className:"text-lg font-bold flex items-center gap-2.5 text-primary tracking-wide",children:s.name}),e.jsxs(Ne,{className:"text-xs mt-1",children:["Mã: ",e.jsx("span",{className:"font-semibold text-foreground tracking-wider bg-primary/10 px-1.5 py-0.5 rounded",children:s.code})]})]})]}),e.jsxs(T,{className:"space-y-4.5 text-sm pt-2",children:[e.jsxs("div",{className:"border-t border-border pt-3 space-y-2",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"font-medium text-muted-foreground",children:"Giá trị giảm:"}),e.jsx("span",{className:"font-bold text-lg text-primary",children:d(s.discountType,s.discountValue)})]}),s.discountType==="PERCENTAGE"&&s.maxDiscount&&e.jsxs("div",{className:"flex justify-between items-center text-xs text-muted-foreground",children:[e.jsx("span",{children:"Tối đa:"}),e.jsx("span",{children:_(s.maxDiscount)})]})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"font-medium text-muted-foreground",children:"Đơn tối thiểu:"}),e.jsx("span",{className:"font-semibold",children:_(s.minOrderValue||0)})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"font-medium text-muted-foreground",children:"Hiệu lực:"}),e.jsxs("span",{className:"font-semibold",children:[Se(s.startDate)," - ",Se(s.endDate)]})]}),s.quantity-s.usedCount>0&&s.quantity<1/0&&e.jsxs("div",{className:"text-xs text-blue-600 flex justify-between items-center",children:[e.jsx("span",{className:"font-medium text-muted-foreground",children:"Lượt sử dụng còn lại:"}),e.jsx("span",{className:"font-semibold",children:s.quantity-s.usedCount})]}),s.status==="HOAT_DONG"&&new Date(s.endDate)>=new Date?e.jsxs(b,{variant:"default",size:"sm",className:"w-full mt-4 bg-primary hover:bg-primary/80 text-primary-foreground gap-2 shadow-md hover:shadow-lg transition-shadow",onClick:()=>{navigator.clipboard.writeText(s.code).then(()=>{R.success(`Đã sao chép mã: ${s.code}`,{position:"top-right",autoClose:3e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0,theme:"light"})}).catch(m=>{R.error("Không thể sao chép mã giảm giá.",{position:"top-right",autoClose:3e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0,theme:"light"})})},children:[e.jsx(p.Icon,{path:ss,size:.7}),"Sao chép mã"]}):e.jsx(b,{variant:"outline",size:"sm",className:"w-full mt-4 cursor-not-allowed",disabled:!0,children:"Không thể sử dụng"})]})]},s.id))})})]})})},Ps=()=>{const{data:n,isLoading:i,isError:l,refetch:t}=us(),[u,d]=H.useState(null),[f,g]=H.useState(!1),v=a=>{d(a),g(!0)},s=a=>{try{return ee(new Date(a),"dd/MM/yyyy",{locale:se})}catch{return a}},m=a=>new Intl.NumberFormat("vi-VN",{style:"currency",currency:"VND"}).format(a);return e.jsxs(e.Fragment,{children:[e.jsxs(C,{children:[e.jsx(k,{children:e.jsxs(P,{className:"flex items-center gap-2",children:[e.jsx(p.Icon,{path:oe,size:.7,className:"text-primary"}),e.jsx("span",{children:"Đơn trả hàng của bạn"})]})}),e.jsx(T,{children:i?e.jsx("div",{className:"flex items-center justify-center py-8",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-t-2 border-b-2 border-primary"})}):l?e.jsx("div",{className:"py-8 text-center",children:e.jsx("p",{className:"text-red-500",children:"Đã xảy ra lỗi khi tải đơn trả hàng. Vui lòng thử lại sau."})}):!n||!n.data||!n.data.returns||n.data.returns.length===0?e.jsx("div",{className:"py-8 text-center",children:e.jsx("p",{className:"text-muted-foreground mb-4",children:"Bạn chưa có đơn trả hàng nào."})}):e.jsxs("div",{children:[e.jsxs(fe,{children:[e.jsx(be,{children:e.jsxs(X,{children:[e.jsx(y,{className:"w-[120px] px-3 py-2",children:"Mã trả hàng"}),e.jsx(y,{className:"px-3 py-2",children:"Ngày tạo"}),e.jsx(y,{className:"px-3 py-2",children:"Đơn hàng gốc"}),e.jsx(y,{className:"px-3 py-2",children:"Sản phẩm"}),e.jsx(y,{className:"text-right px-3 py-2",children:"Số tiền hoàn"}),e.jsx(y,{className:"px-3 py-2",children:"Trạng thái"}),e.jsx(y,{className:"text-center px-3 py-2",children:"Thao tác"})]})}),e.jsx(ye,{children:n.data.returns.map(a=>e.jsxs(X,{children:[e.jsx(w,{className:"font-medium px-3 py-2",children:a.code}),e.jsx(w,{className:"px-3 py-2",children:s(a.createdAt)}),e.jsx(w,{className:"px-3 py-2",children:typeof a.originalOrder=="string"?a.originalOrder:a.originalOrder.code}),e.jsx(w,{className:"px-3 py-2",children:e.jsxs("div",{className:"flex flex-col gap-1",children:[a.items.slice(0,2).map((c,D)=>{var o;return e.jsxs("div",{className:"text-xs",children:[((o=c.product)==null?void 0:o.name)||"Sản phẩm không xác định"," x",c.quantity]},D)}),a.items.length>2&&e.jsxs("div",{className:"text-xs text-muted-foreground",children:["+",a.items.length-2," sản phẩm khác"]})]})}),e.jsx(w,{className:"text-right font-medium px-3 py-2",children:m(a.totalRefund)}),e.jsx(w,{className:"px-3 py-2",children:e.jsx(Ue,{status:a.status})}),e.jsx(w,{className:"text-center px-3 py-2",children:e.jsx(b,{variant:"outline",size:"icon",onClick:()=>v(a==null?void 0:a.id),title:"Xem chi tiết",children:e.jsx(p.Icon,{path:ze,size:.7})})})]},a==null?void 0:a.id))})]}),n.data.pagination&&n.data.pagination.totalPages>1&&e.jsx("div",{className:"flex items-center justify-center space-x-2 py-4",children:e.jsxs("div",{className:"text-sm text-muted-foreground",children:["Trang ",n.data.pagination.currentPage," / ",n.data.pagination.totalPages]})})]})})]}),e.jsx(vs,{returnId:u,open:f,onOpenChange:g,onCancel:()=>t()})]})};function Ds(){var De;const n=$e();Xe().pathname;const[l,t]=H.useState("profile"),{isAuthenticated:u,profile:d,isLoadingProfile:f}=he(),[g,v]=H.useState(1),s=(De=d==null?void 0:d.data)==null?void 0:De.id,{data:m,isLoading:a,isError:c,refetch:D}=Fe(s||""),[o,h]=H.useState(null),[S,I]=H.useState(!1),[E,ae]=H.useState(null),[ne,Q]=H.useState(!1),{data:V,refetch:re}=Be();if(H.useEffect(()=>{const r=()=>{if(typeof window<"u"&&window.location.hash==="#account-tabs"){const G=new URLSearchParams(window.location.search).get("tab");G&&["profile","password","settings","orders","vouchers","returns"].includes(G)?t(G):t("profile")}};return r(),window.addEventListener("hashchange",r),()=>{window.removeEventListener("hashchange",r)}},[]),H.useEffect(()=>{!u&&!f&&n("/auth/login")},[u,f,router]),f)return e.jsx("div",{className:"flex items-center justify-center h-screen",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-primary"})});if(!u)return null;const x=[{title:"Thông tin cá nhân",icon:Me,value:"profile"},{title:"Đổi mật khẩu",icon:ge,value:"password"},{title:"Đơn hàng của bạn",icon:pe,value:"orders"},{title:"Trả hàng",icon:oe,value:"returns"},{title:"Mã giảm giá",icon:je,value:"vouchers"}],j=r=>{h(r),I(!0)},N=r=>{ae(r),Q(!0)},M=r=>{var z,G;return r.orderStatus==="HOAN_THANH"&&((G=(z=V==null?void 0:V.data)==null?void 0:z.orders)==null?void 0:G.some(O=>O.id===r.id))},q=r=>new Intl.NumberFormat("vi-VN",{style:"currency",currency:"VND"}).format(r),A=r=>{switch(r){case"COD":return"Thanh toán khi nhận hàng";case"VNPAY":return"Thanh toán qua VNPay";case"BANK_TRANSFER":return"Chuyển khoản ngân hàng";default:return r}},ie=r=>{switch(r){case"PENDING":return"Chờ thanh toán";case"PAID":return"Đã thanh toán";case"FAILED":return"Thanh toán thất bại";case"REFUNDED":return"Đã hoàn tiền";default:return r}};return e.jsxs(bs.Provider,{value:{activeTab:l,setActiveTab:t},children:[e.jsxs("div",{className:"container mx-auto py-8 relative",children:[e.jsx(cs,{className:"mb-4",children:e.jsxs(ls,{children:[e.jsx(Ie,{children:e.jsx(ds,{href:"/",className:"!text-maintext hover:!text-maintext",children:"Trang chủ"})}),e.jsx(os,{className:"!text-maintext hover:!text-maintext"}),e.jsx(Ie,{children:e.jsx(hs,{className:"!text-maintext hover:!text-maintext",children:"Quản lý chung"})})]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-12 gap-4",children:[e.jsx(xe.div,{className:"md:col-span-3",initial:"hidden",animate:"visible",children:e.jsxs(C,{className:"sticky",children:[e.jsx(k,{children:e.jsx(P,{children:"Quản lý chung"})}),e.jsx(T,{className:"p-0",children:e.jsx("nav",{className:"flex flex-col",id:"account-sidebar-tabs",children:x.map(r=>e.jsx(xe.div,{whileHover:{x:5},transition:{duration:.2},children:e.jsxs("a",{href:`#account-tabs?tab=${r.value}`,"data-value":r.value,className:`flex items-center justify-between px-4 py-3 hover:bg-muted ${l===r.value?"bg-muted text-primary font-medium":""}`,onClick:()=>{t(r.value);const z=document.getElementById("account-tabs");z&&z.scrollIntoView({behavior:"smooth"})},children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(p.Icon,{path:r.icon,size:.7,className:`mr-3 text-maintext ${l===r.value?"text-primary":""}`}),e.jsx("span",{className:"text-maintext",children:r.title})]}),l===r.value&&e.jsx(p.Icon,{path:Qe,size:.7,className:"text-primary"})]})},r.value))})})]})}),e.jsx(xe.div,{className:"md:col-span-9",initial:"hidden",animate:"visible",children:e.jsxs(Ns,{value:l,className:"w-full",children:[e.jsx(J,{value:"profile",children:l==="profile"&&e.jsx(Cs,{})}),e.jsx(J,{value:"password",children:l==="password"&&e.jsx(ks,{})}),e.jsx(J,{value:"orders",children:e.jsxs(C,{children:[e.jsx(k,{children:e.jsxs(P,{className:"flex items-center gap-2",children:[e.jsx(p.Icon,{path:pe,size:.7,className:"text-primary"}),e.jsx("span",{children:"Đơn hàng của bạn"})]})}),e.jsx(T,{children:a?e.jsx("div",{className:"flex items-center justify-center py-8",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-t-2 border-b-2 border-primary"})}):c?e.jsx("div",{className:"py-8 text-center",children:e.jsx("p",{className:"text-red-500",children:"Đã xảy ra lỗi khi tải đơn hàng. Vui lòng thử lại sau."})}):!m||!m.data||!m.data.orders||m.data.orders.length===0?e.jsxs("div",{className:"py-8 text-center",children:[e.jsx("p",{className:"text-muted-foreground mb-4",children:"Bạn chưa có đơn hàng nào."}),e.jsx(b,{variant:"outline",asChild:!0,children:e.jsx("a",{href:"/products",children:"Mua sắm ngay"})})]}):e.jsxs("div",{className:"overflow-x-auto",children:[e.jsxs(fe,{className:"min-w-[1200px]",children:[e.jsx(be,{children:e.jsxs(X,{children:[e.jsx(y,{className:"w-[120px] px-3 py-2 whitespace-nowrap",children:"Mã đơn hàng"}),e.jsx(y,{className:"w-[180px] px-3 py-2 whitespace-nowrap",children:"Ngày đặt"}),e.jsx(y,{className:"w-[200px] px-3 py-2 whitespace-nowrap",children:"Sản phẩm"}),e.jsx(y,{className:"w-[120px] text-right px-3 py-2 whitespace-nowrap",children:"Tổng tiền"}),e.jsx(y,{className:"w-[140px] px-3 py-2 whitespace-nowrap",children:"Trạng thái đơn hàng"}),e.jsx(y,{className:"w-[180px] px-3 py-2 whitespace-nowrap",children:"Phương thức thanh toán"}),e.jsx(y,{className:"w-[140px] px-3 py-2 whitespace-nowrap",children:"Trạng thái thanh toán"}),e.jsx(y,{className:"w-[120px] text-center px-3 py-2 whitespace-nowrap",children:"Thao tác"})]})}),e.jsx(ye,{children:m.data.orders.map(r=>e.jsxs(X,{children:[e.jsx(w,{className:"font-medium px-3 py-2 whitespace-nowrap text-maintext",children:r.code}),e.jsx(w,{className:"px-3 py-2 whitespace-nowrap text-maintext",children:ee(new Date(r.createdAt),"dd/MM/yyyy HH:mm",{locale:se})}),e.jsx(w,{className:"px-3 py-2",children:e.jsxs("div",{className:"flex gap-1 flex-wrap",children:[r.items.slice(0,3).map((z,G)=>{var He,Ae;const O=z.product,me=(He=O==null?void 0:O.variants)==null?void 0:He[0],Ye=(Ae=me==null?void 0:me.images)==null?void 0:Ae[0];return e.jsxs("div",{className:"relative",children:[e.jsx("img",{src:Ye||"/images/white-image.png",alt:(O==null?void 0:O.name)||"Sản phẩm",className:"w-12 h-12 object-contain rounded border",title:(O==null?void 0:O.name)||"Sản phẩm không xác định"}),e.jsx("span",{className:"absolute -top-1 -right-1 bg-primary text-white text-xs rounded-full w-5 h-5 flex items-center justify-center",children:z.quantity})]},G)}),r.items.length>3&&e.jsxs("div",{className:"w-12 h-12 bg-muted rounded border flex items-center justify-center text-xs text-muted-foreground",children:["+",r.items.length-3]})]})}),e.jsx(w,{className:"text-right font-medium px-3 py-2 whitespace-nowrap text-maintext",children:q(r.total)}),e.jsx(w,{className:"px-3 py-2 ",children:e.jsx(Ke,{status:r.orderStatus})}),e.jsx(w,{className:"px-3 py-2 whitespace-nowrap text-maintext",children:A(r.paymentMethod)}),e.jsx(w,{className:"px-3 py-2",children:e.jsx(te,{className:r.paymentStatus==="PAID"?"!bg-emerald-400 !text-white !border-emerald-500 text-nowrap !rounded":"!bg-extra text-nowrap text-white px-2 py-1 rounded",children:ie(r.paymentStatus)})}),e.jsx(w,{className:"text-center px-3 py-2",children:e.jsxs("div",{className:"flex items-center justify-start space-x-2",children:[e.jsx(b,{variant:"outline",size:"icon",onClick:()=>j(r.id),title:"Xem chi tiết",children:e.jsx(p.Icon,{path:ze,size:.7})}),M(r)&&e.jsx(b,{variant:"outline",size:"icon",onClick:()=>N(r.id),title:"Yêu cầu trả hàng",children:e.jsx(p.Icon,{path:oe,size:.7})})]})})]},r.id))})]}),m.data.pagination&&m.data.pagination.totalPages>1&&e.jsxs("div",{className:"flex items-center justify-center space-x-2 py-4",children:[e.jsx(b,{variant:"outline",size:"sm",disabled:g===1,onClick:()=>v(g-1),children:"Trang trước"}),e.jsxs("div",{className:"text-sm text-muted-foreground",children:["Trang ",g," / ",m.data.pagination.totalPages]}),e.jsx(b,{variant:"outline",size:"sm",disabled:g===m.data.pagination.totalPages,onClick:()=>v(g+1),children:"Trang sau"})]})]})})]})}),e.jsx(J,{value:"returns",children:l==="returns"&&e.jsx(Ps,{})}),e.jsx(J,{value:"vouchers",children:l==="vouchers"&&e.jsx(Ts,{})})]})})]})]}),e.jsx(ys,{orderId:o,open:S,onOpenChange:I}),e.jsx(ws,{orderId:E,open:ne,onOpenChange:Q,onSuccess:()=>{D(),re()}})]})}const Ys=()=>e.jsx(Ds,{});export{Ys as default};
