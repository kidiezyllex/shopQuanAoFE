import{U as R,a as u,b7 as _,b8 as P,b2 as U,j as e,k as b,aQ as C,B as p,w as Q,J as q,K as M,L as V,q as l,a6 as r,b9 as $}from"./index-Dpx_4rWJ.js";import{B as J,a as W,b as f,c as T,d as k,e as X}from"./breadcrumb-CJedQ5QG.js";import{C as A,a as S,b as I,c as D}from"./card-fT6uSY2F.js";import{L as n}from"./label-B0XdI4bT.js";import{R as Y,a as v}from"./radio-group-DsRvEBcz.js";import{S as Z}from"./switch-KIImwJ91.js";import{T as ee,b as se,c as O,a as w}from"./tabs-BXj1bKUw.js";import"./createLucideIcon-BdgKQErZ.js";import"./index-qvEK80KO.js";function ae({params:h}){const{id:N}=h,j=R(),[F,G]=u.useState("info"),{data:i,isLoading:K,error:m}=_(N),g=P(N),L=U(N),[a,o]=u.useState({fullName:"",email:"",phoneNumber:"",gender:void 0,status:"HOAT_DONG"}),[H,y]=u.useState("Khác");u.useEffect(()=>{if(i!=null&&i.data){const s=i.data,t=s.gender==="Nam"?!0:s.gender==="Nữ"?!1:void 0;o({fullName:s.fullName,email:s.email,phoneNumber:s.phoneNumber,gender:t,birthday:s.birthday,citizenId:s.citizenId,avatar:s.avatar,status:s.status}),y(s.gender==="Nam"?"Nam":s.gender==="Nữ"?"Nữ":"Khác")}},[i]);const c=s=>{const{name:t,value:d}=s.target;o(x=>({...x,[t]:d}))},z=async s=>{if(s.preventDefault(),!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(a.email||"")){r.error("Email không hợp lệ");return}const d=/(84|0[3|5|7|8|9])+([0-9]{8})\b/;if(a.phoneNumber&&!d.test(a.phoneNumber)){r.error("Số điện thoại không hợp lệ");return}try{await g.mutateAsync({...a},{onSuccess:()=>{r.success("Cập nhật tài khoản thành công")},onError:x=>{r.error("Cập nhật tài khoản thất bại: "+(x.message||"Không xác định"))}})}catch{r.error("Cập nhật tài khoản thất bại")}},B=async()=>{const s={status:a.status==="HOAT_DONG"?"KHONG_HOAT_DONG":"HOAT_DONG"};try{await L.mutateAsync(s,{onSuccess:()=>{o(t=>({...t,status:s.status})),r.success(`Tài khoản đã được ${s.status==="HOAT_DONG"?"kích hoạt":"vô hiệu hóa"}`)},onError:t=>{r.error("Cập nhật trạng thái thất bại: "+(t.message||"Không xác định"))}})}catch{r.error("Cập nhật trạng thái thất bại")}},E=s=>s.split(" ").map(t=>t[0]).join("").toUpperCase().substring(0,2);return K?e.jsx("div",{className:"flex items-center justify-center h-full",children:e.jsx(b.Icon,{path:C,size:2,className:"animate-spin text-primary"})}):m||!i?e.jsxs("div",{className:"flex flex-col items-center justify-center h-full",children:[e.jsx("h2",{className:"text-xl font-bold",children:"Không thể tải thông tin tài khoản"}),e.jsxs("p",{className:"text-maintext",children:["Có lỗi xảy ra: ",(m==null?void 0:m.message)||"Không tìm thấy tài khoản"]}),e.jsx(p,{variant:"outline",onClick:()=>j(-1),className:"mt-4",children:"Quay lại"})]}):e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsx(J,{children:e.jsxs(W,{children:[e.jsx(f,{children:e.jsx(T,{href:"/admin/statistics",children:"Dashboard"})}),e.jsx(k,{}),e.jsx(f,{children:e.jsx(T,{href:"/admin/accounts",children:"Quản lý tài khoản"})}),e.jsx(k,{}),e.jsx(f,{children:e.jsx(X,{children:"Chỉnh sửa tài khoản"})})]})}),e.jsxs(p,{variant:"outline",onClick:()=>j(-1),className:"flex items-center gap-2",children:[e.jsx(b.Icon,{path:Q,size:.7}),"Quay lại"]})]}),e.jsxs("div",{className:"flex items-center space-x-4 bg-white p-8 rounded-[6px] shadow-md",children:[e.jsxs(q,{className:"w-24 h-24 border-2 border-primary",children:[e.jsx(M,{src:a.avatar}),e.jsx(V,{className:"text-2xl",children:E(a.fullName||"")})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("h2",{className:"text-3xl font-bold",children:a.fullName}),e.jsx("p",{className:"text-maintext text-lg",children:i.data.role==="ADMIN"?"Quản trị viên":i.data.role==="STAFF"?"Nhân viên":"Khách hàng"}),e.jsxs("div",{className:"flex items-center pt-3",children:[e.jsx(Z,{checked:a.status==="HOAT_DONG",onCheckedChange:B,id:"status",className:"data-[state=checked]:bg-green-500"}),e.jsx(n,{htmlFor:"status",className:"ml-3 text-sm font-medium",children:a.status==="HOAT_DONG"?"Đang hoạt động":"Không hoạt động"})]})]})]}),e.jsxs("form",{onSubmit:z,className:"bg-white p-4 rounded-[6px] shadow-md",children:[e.jsxs(ee,{value:F,onValueChange:G,className:"space-y-4 bg-white",children:[e.jsxs(se,{className:"grid w-full md:w-[400px] grid-cols-2",children:[e.jsx(O,{value:"info",className:"text-maintext",children:"Thông tin cơ bản"}),e.jsx(O,{value:"advanced",className:"text-maintext",children:"Thông tin bổ sung"})]}),e.jsx(w,{value:"info",className:"space-y-4",children:e.jsxs(A,{children:[e.jsx(S,{children:e.jsx(I,{children:"Thông tin cơ bản"})}),e.jsx(D,{className:"space-y-4",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs(n,{htmlFor:"fullName",children:["Họ và tên ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(l,{id:"fullName",name:"fullName",value:a.fullName,onChange:c,placeholder:"Nhập họ và tên",required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(n,{htmlFor:"email",children:["Email ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(l,{id:"email",name:"email",type:"email",value:a.email,onChange:c,placeholder:"Nhập email",required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(n,{htmlFor:"phoneNumber",children:["Số điện thoại ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(l,{id:"phoneNumber",name:"phoneNumber",value:a.phoneNumber,onChange:c,placeholder:"Nhập số điện thoại",required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{children:"Giới tính"}),e.jsxs(Y,{value:H,onValueChange:s=>{y(s);const t=s==="Nam"?!0:s==="Nữ"?!1:void 0;o(d=>({...d,gender:t}))},className:"flex space-x-4",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(v,{value:"Nam",id:"gender-nam"}),e.jsx(n,{htmlFor:"gender-nam",children:"Nam"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(v,{value:"Nữ",id:"gender-nu"}),e.jsx(n,{htmlFor:"gender-nu",children:"Nữ"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(v,{value:"Khác",id:"gender-khac"}),e.jsx(n,{htmlFor:"gender-khac",children:"Khác"})]})]})]})]})})]})}),e.jsx(w,{value:"advanced",className:"space-y-4",children:e.jsxs(A,{children:[e.jsx(S,{children:e.jsx(I,{children:"Thông tin bổ sung"})}),e.jsx(D,{className:"space-y-4",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{htmlFor:"citizenId",children:"CCCD/CMND (Tuỳ chọn)"}),e.jsx(l,{id:"citizenId",name:"citizenId",value:a.citizenId||"",onChange:c,placeholder:"Nhập số CCCD/CMND"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{htmlFor:"birthday",children:"Ngày sinh"}),e.jsx(l,{id:"birthday",name:"birthday",type:"date",value:a.birthday?typeof a.birthday=="string"?a.birthday.split("T")[0]:a.birthday.toISOString().split("T")[0]:"",onChange:c})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{htmlFor:"avatar",children:"URL Ảnh đại diện"}),e.jsx(l,{id:"avatar",name:"avatar",value:a.avatar||"",onChange:c,placeholder:"Nhập URL ảnh đại diện"})]})]})})]})})]}),e.jsxs("div",{className:"mt-4 flex justify-end space-x-4",children:[e.jsx(p,{variant:"outline",type:"button",onClick:()=>j(-1),children:"Hủy"}),e.jsx(p,{type:"submit",disabled:g.isPending,className:"flex items-center gap-2",children:g.isPending?e.jsxs(e.Fragment,{children:[e.jsx(b.Icon,{path:C,size:.7,className:"animate-spin"}),"Đang xử lý..."]}):"Lưu thay đổi"})]})]})]})}const oe=()=>{const{id:h}=$();return h?e.jsx(ae,{params:{id:h}}):e.jsxs("div",{className:"container mx-auto px-4 py-8",children:[e.jsx("h1",{className:"text-3xl font-bold mb-6",children:"Sửa tài khoản"}),e.jsx("p",{className:"text-gray-600",children:"ID tài khoản không hợp lệ"})]})};export{oe as default};
