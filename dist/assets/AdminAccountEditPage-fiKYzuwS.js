import{j as e}from"./ui-vendor-CFM_MCUz.js";import{u as s,r as a,i as n}from"./react-vendor-B55MjJUH.js";import{z as i,C as t,w as r,B as l,A as c,b as h,c as d,I as m,y as o}from"./index-BHeY-5EX.js";import{B as x,a as j,b as u,c as p,d as N,e as g}from"./breadcrumb-CP4jYkI2.js";import{C as v,a as f,b,c as y}from"./card-ClEzRAeX.js";import{L as C}from"./label-Bm9nFuXD.js";import{R as k,a as T}from"./radio-group-DwYjaxP8.js";import{S as O}from"./switch-2xj7mmYN.js";import{t as D,aC as w,M as F}from"./icons-vendor-BrsZP2ku.js";import{T as I,b as S,c as A,a as K}from"./tabs-z4DSy6tE.js";import"./query-vendor-CBwfxcof.js";import"./heavy-vendor-BfN2pHnQ.js";function z({params:n}){const{id:z}=n,H=s(),[G,_]=a.useState("info"),{data:E,isLoading:L,error:q}=i(z),M=t(z),Q=r(z),[R,U]=a.useState({fullName:"",email:"",phoneNumber:"",gender:void 0,status:"HOAT_DONG"}),[B,P]=a.useState("Khác");a.useEffect((()=>{if(null==E?void 0:E.data){const e=E.data,s="Nam"===e.gender||"Nữ"!==e.gender&&void 0;U({fullName:e.fullName,email:e.email,phoneNumber:e.phoneNumber,gender:s,birthday:e.birthday,citizenId:e.citizenId,avatar:e.avatar,status:e.status}),P("Nam"===e.gender?"Nam":"Nữ"===e.gender?"Nữ":"Khác")}}),[E]);const V=e=>{const{name:s,value:a}=e.target;U((e=>({...e,[s]:a})))};return L?e.jsx("div",{className:"flex items-center justify-center h-full",children:e.jsx(D.Icon,{path:w,size:2,className:"animate-spin text-primary"})}):q||!E?e.jsxs("div",{className:"flex flex-col items-center justify-center h-full",children:[e.jsx("h2",{className:"text-xl font-bold",children:"Không thể tải thông tin tài khoản"}),e.jsxs("p",{className:"text-maintext",children:["Có lỗi xảy ra: ",(null==q?void 0:q.message)||"Không tìm thấy tài khoản"]}),e.jsx(l,{variant:"outline",onClick:()=>H(-1),className:"mt-4",children:"Quay lại"})]}):e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsx(x,{children:e.jsxs(j,{children:[e.jsx(u,{children:e.jsx(p,{href:"/admin/statistics",children:"Dashboard"})}),e.jsx(N,{}),e.jsx(u,{children:e.jsx(p,{href:"/admin/accounts",children:"Quản lý tài khoản"})}),e.jsx(N,{}),e.jsx(u,{children:e.jsx(g,{children:"Chỉnh sửa tài khoản"})})]})}),e.jsxs(l,{variant:"outline",onClick:()=>H(-1),className:"flex items-center gap-2",children:[e.jsx(D.Icon,{path:F,size:.7}),"Quay lại"]})]}),e.jsxs("div",{className:"flex items-center space-x-4 bg-white p-8 rounded-[6px] shadow-md",children:[e.jsxs(c,{className:"w-24 h-24 border-2 border-primary",children:[e.jsx(h,{src:R.avatar}),e.jsx(d,{className:"text-2xl",children:($=R.fullName||"",$.split(" ").map((e=>e[0])).join("").toUpperCase().substring(0,2))})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("h2",{className:"text-3xl font-bold",children:R.fullName}),e.jsx("p",{className:"text-maintext text-lg",children:"ADMIN"===E.data.role?"Quản trị viên":"STAFF"===E.data.role?"Nhân viên":"Khách hàng"}),e.jsxs("div",{className:"flex items-center pt-3",children:[e.jsx(O,{checked:"HOAT_DONG"===R.status,onCheckedChange:async()=>{const e={status:"HOAT_DONG"===R.status?"KHONG_HOAT_DONG":"HOAT_DONG"};try{await Q.mutateAsync(e,{onSuccess:()=>{U((s=>({...s,status:e.status}))),o.success("Tài khoản đã được "+("HOAT_DONG"===e.status?"kích hoạt":"vô hiệu hóa"))},onError:e=>{o.error("Cập nhật trạng thái thất bại: "+(e.message||"Không xác định"))}})}catch(s){o.error("Cập nhật trạng thái thất bại")}},id:"status",className:"data-[state=checked]:bg-green-500"}),e.jsx(C,{htmlFor:"status",className:"ml-3 text-sm font-medium",children:"HOAT_DONG"===R.status?"Đang hoạt động":"Không hoạt động"})]})]})]}),e.jsxs("form",{onSubmit:async e=>{e.preventDefault();if(!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(R.email||""))return void o.error("Email không hợp lệ");if(!R.phoneNumber||/(84|0[3|5|7|8|9])+([0-9]{8})\b/.test(R.phoneNumber))try{await M.mutateAsync({...R},{onSuccess:()=>{o.success("Cập nhật tài khoản thành công")},onError:e=>{o.error("Cập nhật tài khoản thất bại: "+(e.message||"Không xác định"))}})}catch(s){o.error("Cập nhật tài khoản thất bại")}else o.error("Số điện thoại không hợp lệ")},className:"bg-white p-4 rounded-[6px] shadow-md",children:[e.jsxs(I,{value:G,onValueChange:_,className:"space-y-4 bg-white",children:[e.jsxs(S,{className:"grid w-full md:w-[400px] grid-cols-2",children:[e.jsx(A,{value:"info",className:"text-maintext",children:"Thông tin cơ bản"}),e.jsx(A,{value:"advanced",className:"text-maintext",children:"Thông tin bổ sung"})]}),e.jsx(K,{value:"info",className:"space-y-4",children:e.jsxs(v,{children:[e.jsx(f,{children:e.jsx(b,{children:"Thông tin cơ bản"})}),e.jsx(y,{className:"space-y-4",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs(C,{htmlFor:"fullName",children:["Họ và tên ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(m,{id:"fullName",name:"fullName",value:R.fullName,onChange:V,placeholder:"Nhập họ và tên",required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(C,{htmlFor:"email",children:["Email ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(m,{id:"email",name:"email",type:"email",value:R.email,onChange:V,placeholder:"Nhập email",required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(C,{htmlFor:"phoneNumber",children:["Số điện thoại ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(m,{id:"phoneNumber",name:"phoneNumber",value:R.phoneNumber,onChange:V,placeholder:"Nhập số điện thoại",required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(C,{children:"Giới tính"}),e.jsxs(k,{value:B,onValueChange:e=>{P(e);const s="Nam"===e||"Nữ"!==e&&void 0;U((e=>({...e,gender:s})))},className:"flex space-x-4",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(T,{value:"Nam",id:"gender-nam"}),e.jsx(C,{htmlFor:"gender-nam",children:"Nam"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(T,{value:"Nữ",id:"gender-nu"}),e.jsx(C,{htmlFor:"gender-nu",children:"Nữ"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(T,{value:"Khác",id:"gender-khac"}),e.jsx(C,{htmlFor:"gender-khac",children:"Khác"})]})]})]})]})})]})}),e.jsx(K,{value:"advanced",className:"space-y-4",children:e.jsxs(v,{children:[e.jsx(f,{children:e.jsx(b,{children:"Thông tin bổ sung"})}),e.jsx(y,{className:"space-y-4",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(C,{htmlFor:"citizenId",children:"CCCD/CMND (Tuỳ chọn)"}),e.jsx(m,{id:"citizenId",name:"citizenId",value:R.citizenId||"",onChange:V,placeholder:"Nhập số CCCD/CMND"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(C,{htmlFor:"birthday",children:"Ngày sinh"}),e.jsx(m,{id:"birthday",name:"birthday",type:"date",value:R.birthday?"string"==typeof R.birthday?R.birthday.split("T")[0]:R.birthday.toISOString().split("T")[0]:"",onChange:V})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(C,{htmlFor:"avatar",children:"URL Ảnh đại diện"}),e.jsx(m,{id:"avatar",name:"avatar",value:R.avatar||"",onChange:V,placeholder:"Nhập URL ảnh đại diện"})]})]})})]})})]}),e.jsxs("div",{className:"mt-4 flex justify-end space-x-4",children:[e.jsx(l,{variant:"outline",type:"button",onClick:()=>H(-1),children:"Hủy"}),e.jsx(l,{type:"submit",disabled:M.isPending,className:"flex items-center gap-2",children:M.isPending?e.jsxs(e.Fragment,{children:[e.jsx(D.Icon,{path:w,size:.7,className:"animate-spin"}),"Đang xử lý..."]}):"Lưu thay đổi"})]})]})]});var $}const H=()=>{const{id:s}=n();return s?e.jsx(z,{params:{id:s}}):e.jsxs("div",{className:"container mx-auto px-4 py-8",children:[e.jsx("h1",{className:"text-3xl font-bold mb-6",children:"Sửa tài khoản"}),e.jsx("p",{className:"text-gray-600",children:"ID tài khoản không hợp lệ"})]})};export{H as default};
