import{j as e}from"./ui-vendor-CFM_MCUz.js";import{r as t,u as n}from"./react-vendor-B55MjJUH.js";import{C as i,c as a}from"./card-ClEzRAeX.js";import{I as s,B as r,k as l,D as o,a as h,d,g as c,y as u}from"./index-BHeY-5EX.js";import{S as m,a as g,b as f,c as p,d as x}from"./select-C6W71KWg.js";import{T as y,b as v,c as j,a as b}from"./tabs-z4DSy6tE.js";import{t as w,ad as N,aO as S,ae as C,aP as D,J as H,a7 as A,aG as P,aQ as W}from"./icons-vendor-BrsZP2ku.js";import{B as F}from"./badge-BeHegjHt.js";import{P as T,a as k,b as _,C as z}from"./calendar-DBvhqSTH.js";import{B as O,a as I,b as M,c as E,d as R,e as L}from"./breadcrumb-CP4jYkI2.js";import{D as B,a as K,b as G,c as Y,e as U}from"./dialog-Va24CY58.js";import{T as $,a as V,b as q,c as X,d as Q,e as J}from"./table-DL-K3PV4.js";import{S as Z}from"./skeleton-4G_X8bY4.js";import{c as ee,a as te,d as ne,e as ie}from"./order-BDDy-DF1.js";import{d as ae}from"./query-vendor-CBwfxcof.js";import{A as se,m as re,a as le,w as oe,E as he}from"./heavy-vendor-BfN2pHnQ.js";import{f as de}from"./utils-vendor-C6znz4jh.js";import{l as ce}from"./index-DwIVA3Vd.js";function ue(e,t,n,i,a){i=i||{};var s=a.internal.scaleFactor,r=a.internal.getFontSize()/s,l=r*(a.getLineHeightFactor?a.getLineHeightFactor():1.15),o="",h=1;if("middle"!==i.valign&&"bottom"!==i.valign&&"center"!==i.halign&&"right"!==i.halign||(h=(o="string"==typeof e?e.split(/\r\n|\r|\n/g):e).length||1),n+=r*(2-1.15),"middle"===i.valign?n-=h/2*l:"bottom"===i.valign&&(n-=h*l),"center"===i.halign||"right"===i.halign){var d=r;if("center"===i.halign&&(d*=.5),o&&h>=1){for(var c=0;c<o.length;c++)a.text(o[c],t-a.getStringUnitWidth(o[c])*d,n),n+=l;return a}t-=a.getStringUnitWidth(e)*d}return"justify"===i.halign?a.text(e,t,n,{maxWidth:i.maxWidth||100,align:"justify"}):a.text(e,t,n),a}var me={},ge=function(){function e(e){this.jsPDFDocument=e,this.userStyles={textColor:e.getTextColor?this.jsPDFDocument.getTextColor():0,fontSize:e.internal.getFontSize(),fontStyle:e.internal.getFont().fontStyle,font:e.internal.getFont().fontName,lineWidth:e.getLineWidth?this.jsPDFDocument.getLineWidth():0,lineColor:e.getDrawColor?this.jsPDFDocument.getDrawColor():0}}return e.setDefaults=function(e,t){void 0===t&&(t=null),t?t.__autoTableDocumentDefaults=e:me=e},e.unifyColor=function(e){return Array.isArray(e)?e:"number"==typeof e?[e,e,e]:"string"==typeof e?[e]:null},e.prototype.applyStyles=function(t,n){var i,a,s;void 0===n&&(n=!1),t.fontStyle&&this.jsPDFDocument.setFontStyle&&this.jsPDFDocument.setFontStyle(t.fontStyle);var r=this.jsPDFDocument.internal.getFont(),l=r.fontStyle,o=r.fontName;if(t.font&&(o=t.font),t.fontStyle){l=t.fontStyle;var h=this.getFontList()[o];h&&-1===h.indexOf(l)&&this.jsPDFDocument.setFontStyle&&(this.jsPDFDocument.setFontStyle(h[0]),l=h[0])}if(this.jsPDFDocument.setFont(o,l),t.fontSize&&this.jsPDFDocument.setFontSize(t.fontSize),!n){var d=e.unifyColor(t.fillColor);d&&(i=this.jsPDFDocument).setFillColor.apply(i,d),(d=e.unifyColor(t.textColor))&&(a=this.jsPDFDocument).setTextColor.apply(a,d),(d=e.unifyColor(t.lineColor))&&(s=this.jsPDFDocument).setDrawColor.apply(s,d),"number"==typeof t.lineWidth&&this.jsPDFDocument.setLineWidth(t.lineWidth)}},e.prototype.splitTextToSize=function(e,t,n){return this.jsPDFDocument.splitTextToSize(e,t,n)},e.prototype.rect=function(e,t,n,i,a){return this.jsPDFDocument.rect(e,t,n,i,a)},e.prototype.getLastAutoTable=function(){return this.jsPDFDocument.lastAutoTable||null},e.prototype.getTextWidth=function(e){return this.jsPDFDocument.getTextWidth(e)},e.prototype.getDocument=function(){return this.jsPDFDocument},e.prototype.setPage=function(e){this.jsPDFDocument.setPage(e)},e.prototype.addPage=function(){return this.jsPDFDocument.addPage()},e.prototype.getFontList=function(){return this.jsPDFDocument.getFontList()},e.prototype.getGlobalOptions=function(){return me||{}},e.prototype.getDocumentOptions=function(){return this.jsPDFDocument.__autoTableDocumentDefaults||{}},e.prototype.pageSize=function(){var e=this.jsPDFDocument.internal.pageSize;return null==e.width&&(e={width:e.getWidth(),height:e.getHeight()}),e},e.prototype.scaleFactor=function(){return this.jsPDFDocument.internal.scaleFactor},e.prototype.getLineHeightFactor=function(){var e=this.jsPDFDocument;return e.getLineHeightFactor?e.getLineHeightFactor():1.15},e.prototype.getLineHeight=function(e){return e/this.scaleFactor()*this.getLineHeightFactor()},e.prototype.pageNumber=function(){var e=this.jsPDFDocument.internal.getCurrentPageInfo();return e?e.pageNumber:this.jsPDFDocument.internal.getNumberOfPages()},e}(),fe=function(e,t){return(fe=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)};function pe(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}fe(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}"function"==typeof SuppressedError&&SuppressedError;var xe=function(e){function t(t){var n=e.call(this)||this;return n._element=t,n}return pe(t,e),t}(Array);function ye(e,t,n){return n.applyStyles(t,!0),(Array.isArray(e)?e:[e]).map((function(e){return n.getTextWidth(e)})).reduce((function(e,t){return Math.max(e,t)}),0)}function ve(e,t,n,i){var a=t.settings.tableLineWidth,s=t.settings.tableLineColor;e.applyStyles({lineWidth:a,lineColor:s});var r=je(a,!1);r&&e.rect(n.x,n.y,t.getWidth(e.pageSize().width),i.y-n.y,r)}function je(e,t){var n=e>0,i=t||0===t;return n&&i?"DF":n?"S":i?"F":null}function be(e,t){var n,i,a,s;if(e=e||t,Array.isArray(e)){if(e.length>=4)return{top:e[0],right:e[1],bottom:e[2],left:e[3]};if(3===e.length)return{top:e[0],right:e[1],bottom:e[2],left:e[1]};if(2===e.length)return{top:e[0],right:e[1],bottom:e[0],left:e[1]};e=1===e.length?e[0]:t}return"object"==typeof e?("number"==typeof e.vertical&&(e.top=e.vertical,e.bottom=e.vertical),"number"==typeof e.horizontal&&(e.right=e.horizontal,e.left=e.horizontal),{left:null!==(n=e.left)&&void 0!==n?n:t,top:null!==(i=e.top)&&void 0!==i?i:t,right:null!==(a=e.right)&&void 0!==a?a:t,bottom:null!==(s=e.bottom)&&void 0!==s?s:t}):("number"!=typeof e&&(e=t),{top:e,right:e,bottom:e,left:e})}function we(e,t){var n=be(t.settings.margin,0);return e.pageSize().width-(n.left+n.right)}function Ne(e,t,n,i,a){var s={},r=96/72,l=Se(t,(function(e){return a.getComputedStyle(e).backgroundColor}));null!=l&&(s.fillColor=l);var o=Se(t,(function(e){return a.getComputedStyle(e).color}));null!=o&&(s.textColor=o);var h=function(e,t){var n=[e.paddingTop,e.paddingRight,e.paddingBottom,e.paddingLeft],i=96/(72/t),a=(parseInt(e.lineHeight)-parseInt(e.fontSize))/t/2,s=n.map((function(e){return parseInt(e||"0")/i})),r=be(s,0);a>r.top&&(r.top=a);a>r.bottom&&(r.bottom=a);return r}(i,n);h&&(s.cellPadding=h);var d="borderTopColor",c=r*n,u=i.borderTopWidth;if(i.borderBottomWidth===u&&i.borderRightWidth===u&&i.borderLeftWidth===u){var m=(parseFloat(u)||0)/c;m&&(s.lineWidth=m)}else s.lineWidth={top:(parseFloat(i.borderTopWidth)||0)/c,right:(parseFloat(i.borderRightWidth)||0)/c,bottom:(parseFloat(i.borderBottomWidth)||0)/c,left:(parseFloat(i.borderLeftWidth)||0)/c},s.lineWidth.top||(s.lineWidth.right?d="borderRightColor":s.lineWidth.bottom?d="borderBottomColor":s.lineWidth.left&&(d="borderLeftColor"));var g=Se(t,(function(e){return a.getComputedStyle(e)[d]}));null!=g&&(s.lineColor=g);var f=["left","right","center","justify"];-1!==f.indexOf(i.textAlign)&&(s.halign=i.textAlign),-1!==(f=["middle","bottom","top"]).indexOf(i.verticalAlign)&&(s.valign=i.verticalAlign);var p=parseInt(i.fontSize||"");isNaN(p)||(s.fontSize=p/r);var x=function(e){var t="";("bold"===e.fontWeight||"bolder"===e.fontWeight||parseInt(e.fontWeight)>=700)&&(t="bold");"italic"!==e.fontStyle&&"oblique"!==e.fontStyle||(t+="italic");return t}(i);x&&(s.fontStyle=x);var y=(i.fontFamily||"").toLowerCase();return-1!==e.indexOf(y)&&(s.font=y),s}function Se(e,t){var n=Ce(e,t);if(!n)return null;var i=n.match(/^rgba?\((\d+),\s*(\d+),\s*(\d+)(?:,\s*(\d*\.?\d*))?\)$/);if(!i||!Array.isArray(i))return null;var a=[parseInt(i[1]),parseInt(i[2]),parseInt(i[3])];return 0===parseInt(i[4])||isNaN(a[0])||isNaN(a[1])||isNaN(a[2])?null:a}function Ce(e,t){var n=t(e);return"rgba(0, 0, 0, 0)"===n||"transparent"===n||"initial"===n||"inherit"===n?null==e.parentElement?null:Ce(e.parentElement,t):n}function De(e,t,n,i,a){var s,r,l;void 0===i&&(i=!1),void 0===a&&(a=!1),l="string"==typeof t?n.document.querySelector(t):t;var o=Object.keys(e.getFontList()),h=e.scaleFactor(),d=[],c=[],u=[];if(!l)return{head:d,body:c,foot:u};for(var m=0;m<l.rows.length;m++){var g=l.rows[m],f=null===(r=null===(s=null==g?void 0:g.parentElement)||void 0===s?void 0:s.tagName)||void 0===r?void 0:r.toLowerCase(),p=He(o,h,n,g,i,a);p&&("thead"===f?d.push(p):"tfoot"===f?u.push(p):c.push(p))}return{head:d,body:c,foot:u}}function He(e,t,n,i,a,s){for(var r=new xe(i),l=0;l<i.cells.length;l++){var o=i.cells[l],h=n.getComputedStyle(o);if(a||"none"!==h.display){var d=void 0;s&&(d=Ne(e,o,t,h,n)),r.push({rowSpan:o.rowSpan,colSpan:o.colSpan,styles:d,_element:o,content:Ae(o)})}}var c=n.getComputedStyle(i);if(r.length>0&&(a||"none"!==c.display))return r}function Ae(e){var t=e.cloneNode(!0);return t.innerHTML=t.innerHTML.replace(/\n/g,"").replace(/ +/g," "),t.innerHTML=t.innerHTML.split(/<br.*?>/).map((function(e){return e.trim()})).join("\n"),t.innerText||t.textContent||""}function Pe(e,t,n,i,a){if(null==e)throw new TypeError("Cannot convert undefined or null to object");for(var s=Object(e),r=1;r<arguments.length;r++){var l=arguments[r];if(null!=l)for(var o in l)Object.prototype.hasOwnProperty.call(l,o)&&(s[o]=l[o])}return s}function We(e,t){var n=new ge(e),i=n.getDocumentOptions(),a=n.getGlobalOptions();!function(e,t,n){for(var i=0,a=[e,t,n];i<a.length;i++){var s=a[i];s.startY&&"number"!=typeof s.startY&&delete s.startY}}(a,i,t);var s,r=Pe({},a,i,t);"undefined"!=typeof window&&(s=window);var l=function(e,t,n){for(var i={styles:{},headStyles:{},bodyStyles:{},footStyles:{},alternateRowStyles:{},columnStyles:{}},a=function(a){if("columnStyles"===a){var s=e[a],r=t[a],l=n[a];i.columnStyles=Pe({},s,r,l)}else{var o=[e,t,n].map((function(e){return e[a]||{}}));i[a]=Pe({},o[0],o[1],o[2])}},s=0,r=Object.keys(i);s<r.length;s++){a(r[s])}return i}(a,i,t),o=function(e,t,n){for(var i={didParseCell:[],willDrawCell:[],didDrawCell:[],willDrawPage:[],didDrawPage:[]},a=0,s=[e,t,n];a<s.length;a++){var r=s[a];r.didParseCell&&i.didParseCell.push(r.didParseCell),r.willDrawCell&&i.willDrawCell.push(r.willDrawCell),r.didDrawCell&&i.didDrawCell.push(r.didDrawCell),r.willDrawPage&&i.willDrawPage.push(r.willDrawPage),r.didDrawPage&&i.didDrawPage.push(r.didDrawPage)}return i}(a,i,t),h=function(e,t){var n,i,a,s,r,l,o,h,d,c,u,m,g,f,p=be(t.margin,40/e.scaleFactor()),x=null!==(n=function(e,t){var n=e.getLastAutoTable(),i=e.scaleFactor(),a=e.pageNumber(),s=!1;if(n&&n.startPageNumber){s=n.startPageNumber+n.pageNumber-1===a}if("number"==typeof t)return t;if((null==t||!1===t)&&s&&null!=(null==n?void 0:n.finalY))return n.finalY+20/i;return null}(e,t.startY))&&void 0!==n?n:p.top;g=!0===t.showFoot?"everyPage":!1===t.showFoot?"never":null!==(i=t.showFoot)&&void 0!==i?i:"everyPage";f=!0===t.showHead?"everyPage":!1===t.showHead?"never":null!==(a=t.showHead)&&void 0!==a?a:"everyPage";var y=null!==(s=t.useCss)&&void 0!==s&&s,v=t.theme||(y?"plain":"striped"),j=!!t.horizontalPageBreak,b=null!==(r=t.horizontalPageBreakRepeat)&&void 0!==r?r:null;return{includeHiddenHtml:null!==(l=t.includeHiddenHtml)&&void 0!==l&&l,useCss:y,theme:v,startY:x,margin:p,pageBreak:null!==(o=t.pageBreak)&&void 0!==o?o:"auto",rowPageBreak:null!==(h=t.rowPageBreak)&&void 0!==h?h:"auto",tableWidth:null!==(d=t.tableWidth)&&void 0!==d?d:"auto",showHead:f,showFoot:g,tableLineWidth:null!==(c=t.tableLineWidth)&&void 0!==c?c:0,tableLineColor:null!==(u=t.tableLineColor)&&void 0!==u?u:200,horizontalPageBreak:j,horizontalPageBreakRepeat:b,horizontalPageBreakBehaviour:null!==(m=t.horizontalPageBreakBehaviour)&&void 0!==m?m:"afterAllRows"}}(n,r),d=function(e,t,n){var i=t.head||[],a=t.body||[],s=t.foot||[];if(t.html){var r=t.includeHiddenHtml;if(n){var l=De(e,t.html,n,r,t.useCss)||{};i=l.head||i,a=l.body||i,s=l.foot||i}}var o=t.columns||function(e,t,n){var i=e[0]||t[0]||n[0]||[],a=[];return Object.keys(i).filter((function(e){return"_element"!==e})).forEach((function(e){var t,n=1;"object"!=typeof(t=Array.isArray(i)?i[parseInt(e)]:i[e])||Array.isArray(t)||(n=(null==t?void 0:t.colSpan)||1);for(var s=0;s<n;s++){var r={dataKey:Array.isArray(i)?a.length:e+(s>0?"_".concat(s):"")};a.push(r)}})),a}(i,a,s);return{columns:o,head:i,body:a,foot:s}}(n,r,s);return{id:t.tableId,content:d,hooks:o,styles:l,settings:h}}var Fe,Te=function(){return function(e,t,n){this.table=t,this.pageNumber=t.pageNumber,this.settings=t.settings,this.cursor=n,this.doc=e.getDocument()}}(),ke=function(e){function t(t,n,i,a,s,r){var l=e.call(this,t,n,r)||this;return l.cell=i,l.row=a,l.column=s,l.section=a.section,l}return pe(t,e),t}(Te),_e=function(){function e(e,t){this.pageNumber=1,this.id=e.id,this.settings=e.settings,this.styles=e.styles,this.hooks=e.hooks,this.columns=t.columns,this.head=t.head,this.body=t.body,this.foot=t.foot}return e.prototype.getHeadHeight=function(e){return this.head.reduce((function(t,n){return t+n.getMaxCellHeight(e)}),0)},e.prototype.getFootHeight=function(e){return this.foot.reduce((function(t,n){return t+n.getMaxCellHeight(e)}),0)},e.prototype.allRows=function(){return this.head.concat(this.body).concat(this.foot)},e.prototype.callCellHooks=function(e,t,n,i,a,s){for(var r=0,l=t;r<l.length;r++){var o=!1===(0,l[r])(new ke(e,this,n,i,a,s));if(n.text=Array.isArray(n.text)?n.text:[n.text],o)return!1}return!0},e.prototype.callEndPageHooks=function(e,t){e.applyStyles(e.userStyles);for(var n=0,i=this.hooks.didDrawPage;n<i.length;n++){(0,i[n])(new Te(e,this,t))}},e.prototype.callWillDrawPageHooks=function(e,t){for(var n=0,i=this.hooks.willDrawPage;n<i.length;n++){(0,i[n])(new Te(e,this,t))}},e.prototype.getWidth=function(e){if("number"==typeof this.settings.tableWidth)return this.settings.tableWidth;if("wrap"===this.settings.tableWidth)return this.columns.reduce((function(e,t){return e+t.wrappedWidth}),0);var t=this.settings.margin;return e-t.left-t.right},e}(),ze=function(){function e(e,t,n,i,a){void 0===a&&(a=!1),this.height=0,this.raw=e,e instanceof xe&&(this.raw=e._element,this.element=e._element),this.index=t,this.section=n,this.cells=i,this.spansMultiplePages=a}return e.prototype.getMaxCellHeight=function(e){var t=this;return e.reduce((function(e,n){var i;return Math.max(e,(null===(i=t.cells[n.index])||void 0===i?void 0:i.height)||0)}),0)},e.prototype.hasRowSpan=function(e){var t=this;return e.filter((function(e){var n=t.cells[e.index];return!!n&&n.rowSpan>1})).length>0},e.prototype.canEntireRowFit=function(e,t){return this.getMaxCellHeight(t)<=e},e.prototype.getMinimumRowHeight=function(e,t){var n=this;return e.reduce((function(e,i){var a=n.cells[i.index];if(!a)return 0;var s=t.getLineHeight(a.styles.fontSize),r=a.padding("vertical")+s;return r>e?r:e}),0)},e}(),Oe=function(){function e(e,t,n){var i;this.contentHeight=0,this.contentWidth=0,this.wrappedWidth=0,this.minReadableWidth=0,this.minWidth=0,this.width=0,this.height=0,this.x=0,this.y=0,this.styles=t,this.section=n,this.raw=e;var a=e;null==e||"object"!=typeof e||Array.isArray(e)?(this.rowSpan=1,this.colSpan=1):(this.rowSpan=e.rowSpan||1,this.colSpan=e.colSpan||1,a=null!==(i=e.content)&&void 0!==i?i:e,e._element&&(this.raw=e._element));var s=null!=a?""+a:"";this.text=s.split(/\r\n|\r|\n/g)}return e.prototype.getTextPos=function(){var e,t;if("top"===this.styles.valign)e=this.y+this.padding("top");else if("bottom"===this.styles.valign)e=this.y+this.height-this.padding("bottom");else{var n=this.height-this.padding("vertical");e=this.y+n/2+this.padding("top")}if("right"===this.styles.halign)t=this.x+this.width-this.padding("right");else if("center"===this.styles.halign){var i=this.width-this.padding("horizontal");t=this.x+i/2+this.padding("left")}else t=this.x+this.padding("left");return{x:t,y:e}},e.prototype.getContentHeight=function(e,t){void 0===t&&(t=1.15);var n=(Array.isArray(this.text)?this.text.length:1)*(this.styles.fontSize/e*t)+this.padding("vertical");return Math.max(n,this.styles.minCellHeight)},e.prototype.padding=function(e){var t=be(this.styles.cellPadding,0);return"vertical"===e?t.top+t.bottom:"horizontal"===e?t.left+t.right:t[e]},e}(),Ie=function(){function e(e,t,n){this.wrappedWidth=0,this.minReadableWidth=0,this.minWidth=0,this.width=0,this.dataKey=e,this.raw=t,this.index=n}return e.prototype.getMaxCustomCellWidth=function(e){for(var t=0,n=0,i=e.allRows();n<i.length;n++){var a=i[n].cells[this.index];a&&"number"==typeof a.styles.cellWidth&&(t=Math.max(t,a.styles.cellWidth))}return t},e}();function Me(e,t){!function(e,t){var n=e.scaleFactor(),i=t.settings.horizontalPageBreak,a=we(e,t);t.allRows().forEach((function(s){for(var r=0,l=t.columns;r<l.length;r++){var o=l[r],h=s.cells[o.index];if(h){var d=t.hooks.didParseCell;t.callCellHooks(e,d,h,s,o,null);var c=h.padding("horizontal");h.contentWidth=ye(h.text,h.styles,e)+c;var u=ye(h.text.join(" ").split(/[^\S\u00A0]+/),h.styles,e);if(h.minReadableWidth=u+h.padding("horizontal"),"number"==typeof h.styles.cellWidth)h.minWidth=h.styles.cellWidth,h.wrappedWidth=h.styles.cellWidth;else if("wrap"===h.styles.cellWidth||!0===i)h.contentWidth>a?(h.minWidth=a,h.wrappedWidth=a):(h.minWidth=h.contentWidth,h.wrappedWidth=h.contentWidth);else{var m=10/n;h.minWidth=h.styles.minCellWidth||m,h.wrappedWidth=h.contentWidth,h.minWidth>h.wrappedWidth&&(h.wrappedWidth=h.minWidth)}}}})),t.allRows().forEach((function(e){for(var n=0,i=t.columns;n<i.length;n++){var a=i[n],s=e.cells[a.index];if(s&&1===s.colSpan)a.wrappedWidth=Math.max(a.wrappedWidth,s.wrappedWidth),a.minWidth=Math.max(a.minWidth,s.minWidth),a.minReadableWidth=Math.max(a.minReadableWidth,s.minReadableWidth);else{var r=t.styles.columnStyles[a.dataKey]||t.styles.columnStyles[a.index]||{},l=r.cellWidth||r.minCellWidth;l&&"number"==typeof l&&(a.minWidth=l,a.wrappedWidth=l)}s&&(s.colSpan>1&&!a.minWidth&&(a.minWidth=s.minWidth),s.colSpan>1&&!a.wrappedWidth&&(a.wrappedWidth=s.minWidth))}}))}(e,t);var n=[],i=0;t.columns.forEach((function(e){var a=e.getMaxCustomCellWidth(t);a?e.width=a:(e.width=e.wrappedWidth,n.push(e)),i+=e.width}));var a=t.getWidth(e.pageSize().width)-i;a&&(a=Ee(n,a,(function(e){return Math.max(e.minReadableWidth,e.minWidth)}))),a&&(a=Ee(n,a,(function(e){return e.minWidth}))),a=Math.abs(a),!t.settings.horizontalPageBreak&&a>.1/e.scaleFactor()&&(a=a<1?a:Math.round(a)),function(e){for(var t=e.allRows(),n=0;n<t.length;n++)for(var i=t[n],a=null,s=0,r=0,l=0;l<e.columns.length;l++){var o=e.columns[l];if((r-=1)>1&&e.columns[l+1])s+=o.width,delete i.cells[o.index];else if(a){var h=a;delete i.cells[o.index],a=null,h.width=o.width+s}else{if(!(h=i.cells[o.index]))continue;if(r=h.colSpan,s=0,h.colSpan>1){a=h,s+=o.width;continue}h.width=o.width+s}}}(t),function(e,t){for(var n={count:0,height:0},i=0,a=e.allRows();i<a.length;i++){for(var s=a[i],r=0,l=e.columns;r<l.length;r++){var o=l[r],h=s.cells[o.index];if(h){t.applyStyles(h.styles,!0);var d=h.width-h.padding("horizontal");if("linebreak"===h.styles.overflow)h.text=t.splitTextToSize(h.text,d+1/t.scaleFactor(),{fontSize:h.styles.fontSize});else if("ellipsize"===h.styles.overflow)h.text=Re(h.text,d,h.styles,t,"...");else if("hidden"===h.styles.overflow)h.text=Re(h.text,d,h.styles,t,"");else if("function"==typeof h.styles.overflow){var c=h.styles.overflow(h.text,d);h.text="string"==typeof c?[c]:c}h.contentHeight=h.getContentHeight(t.scaleFactor(),t.getLineHeightFactor());var u=h.contentHeight/h.rowSpan;h.rowSpan>1&&n.count*n.height<u*h.rowSpan?n={height:u,count:h.rowSpan}:n&&n.count>0&&n.height>u&&(u=n.height),u>s.height&&(s.height=u)}}n.count--}}(t,e),function(e){for(var t={},n=1,i=e.allRows(),a=0;a<i.length;a++)for(var s=i[a],r=0,l=e.columns;r<l.length;r++){var o=l[r],h=t[o.index];if(n>1)n--,delete s.cells[o.index];else if(h)h.cell.height+=s.height,n=h.cell.colSpan,delete s.cells[o.index],h.left--,h.left<=1&&delete t[o.index];else{var d=s.cells[o.index];if(!d)continue;if(d.height=s.height,d.rowSpan>1){var c=i.length-a,u=d.rowSpan>c?c:d.rowSpan;t[o.index]={cell:d,left:u,row:s}}}}}(t)}function Ee(e,t,n){for(var i=t,a=e.reduce((function(e,t){return e+t.wrappedWidth}),0),s=0;s<e.length;s++){var r=e[s],l=i*(r.wrappedWidth/a),o=r.width+l,h=n(r),d=o<h?h:o;t-=d-r.width,r.width=d}if(t=Math.round(1e10*t)/1e10){var c=e.filter((function(e){return!(t<0)||e.width>n(e)}));c.length&&(t=Ee(c,t,n))}return t}function Re(e,t,n,i,a){return e.map((function(e){return function(e,t,n,i,a){var s=1e4*i.scaleFactor();if(t=Math.ceil(t*s)/s,t>=ye(e,n,i))return e;for(;t<ye(e+a,n,i)&&!(e.length<=1);)e=e.substring(0,e.length-1);return e.trim()+a}(e,t,n,i,a)}))}function Le(e,t){var n=new ge(e),i=function(e,t){var n=e.content,i=function(e){return e.map((function(e,t){var n,i;return i="object"==typeof e&&null!==(n=e.dataKey)&&void 0!==n?n:t,new Ie(i,e,t)}))}(n.columns);if(0===n.head.length){(a=Ke(i,"head"))&&n.head.push(a)}if(0===n.foot.length){var a;(a=Ke(i,"foot"))&&n.foot.push(a)}var s=e.settings.theme,r=e.styles;return{columns:i,head:Be("head",n.head,i,r,s,t),body:Be("body",n.body,i,r,s,t),foot:Be("foot",n.foot,i,r,s,t)}}(t,n.scaleFactor()),a=new _e(t,i);return Me(n,a),n.applyStyles(n.userStyles),a}function Be(e,t,n,i,a,s){var r={};return t.map((function(t,l){for(var o=0,h={},d=0,c=0,u=0,m=n;u<m.length;u++){var g=m[u];if(null==r[g.index]||0===r[g.index].left)if(0===c){var f=void 0,p={};"object"!=typeof(f=Array.isArray(t)?t[g.index-d-o]:t[g.dataKey])||Array.isArray(f)||(p=(null==f?void 0:f.styles)||{});var x=Ge(e,g,l,a,i,s,p),y=new Oe(f,x,e);h[g.dataKey]=y,h[g.index]=y,c=y.colSpan-1,r[g.index]={left:y.rowSpan-1,times:c}}else c--,d++;else r[g.index].left--,c=r[g.index].times,o++}return new ze(t,l,e,h)}))}function Ke(e,t){var n={};return e.forEach((function(e){if(null!=e.raw){var i=function(e,t){if("head"===e){if("object"==typeof t)return t.header||null;if("string"==typeof t||"number"==typeof t)return t}else if("foot"===e&&"object"==typeof t)return t.footer;return null}(t,e.raw);null!=i&&(n[e.dataKey]=i)}})),Object.keys(n).length>0?n:null}function Ge(e,t,n,i,a,s,r){var l,o={striped:{table:{fillColor:255,textColor:80,fontStyle:"normal"},head:{textColor:255,fillColor:[41,128,185],fontStyle:"bold"},body:{},foot:{textColor:255,fillColor:[41,128,185],fontStyle:"bold"},alternateRow:{fillColor:245}},grid:{table:{fillColor:255,textColor:80,fontStyle:"normal",lineWidth:.1},head:{textColor:255,fillColor:[26,188,156],fontStyle:"bold",lineWidth:0},body:{},foot:{textColor:255,fillColor:[26,188,156],fontStyle:"bold",lineWidth:0},alternateRow:{}},plain:{head:{fontStyle:"bold"},foot:{fontStyle:"bold"}}}[i];"head"===e?l=a.headStyles:"body"===e?l=a.bodyStyles:"foot"===e&&(l=a.footStyles);var h=Pe({},o.table,o[e],a.styles,l),d=a.columnStyles[t.dataKey]||a.columnStyles[t.index]||{},c="body"===e?d:{},u="body"===e&&n%2==0?Pe({},o.alternateRow,a.alternateRowStyles):{},m=function(e){return{font:"helvetica",fontStyle:"normal",overflow:"linebreak",fillColor:!1,textColor:20,halign:"left",valign:"top",fontSize:10,cellPadding:5/e,lineColor:200,lineWidth:0,cellWidth:"auto",minCellHeight:0,minCellWidth:0}}(s),g=Pe({},m,h,u,c);return Pe(g,r)}function Ye(e,t,n){var i;void 0===n&&(n={});var a=we(e,t),s=new Map,r=[],l=[],o=[];Array.isArray(t.settings.horizontalPageBreakRepeat)?o=t.settings.horizontalPageBreakRepeat:"string"!=typeof t.settings.horizontalPageBreakRepeat&&"number"!=typeof t.settings.horizontalPageBreakRepeat||(o=[t.settings.horizontalPageBreakRepeat]),o.forEach((function(e){var n=t.columns.find((function(t){return t.dataKey===e||t.index===e}));n&&!s.has(n.index)&&(s.set(n.index,!0),r.push(n.index),l.push(t.columns[n.index]),a-=n.wrappedWidth)}));for(var h=!0,d=null!==(i=null==n?void 0:n.start)&&void 0!==i?i:0;d<t.columns.length;)if(s.has(d))d++;else{var c=t.columns[d].wrappedWidth;if(!(h||a>=c))break;h=!1,r.push(d),l.push(t.columns[d]),a-=c,d++}return{colIndexes:r,columns:l,lastIndex:d-1}}function Ue(e,t){var n=t.settings,i=n.startY,a=n.margin,s={x:a.left,y:i},r=t.getHeadHeight(t.columns)+t.getFootHeight(t.columns),l=i+a.bottom+r;"avoid"===n.pageBreak&&(l+=t.body.reduce((function(e,t){return e+t.height}),0));var o=new ge(e);("always"===n.pageBreak||null!=n.startY&&l>o.pageSize().height)&&(nt(o),s.y=a.top),t.callWillDrawPageHooks(o,s);var h=Pe({},s);t.startPageNumber=o.pageNumber(),n.horizontalPageBreak?function(e,t,n,i){var a=function(e,t){for(var n=[],i=0;i<t.columns.length;i++){var a=Ye(e,t,{start:i});a.columns.length&&(n.push(a),i=a.lastIndex)}return n}(e,t),s=t.settings;if("afterAllRows"===s.horizontalPageBreakBehaviour)a.forEach((function(a,s){e.applyStyles(e.userStyles),s>0?tt(e,t,n,i,a.columns,!0):$e(e,t,i,a.columns),function(e,t,n,i,a){e.applyStyles(e.userStyles),t.body.forEach((function(s,r){var l=r===t.body.length-1;Qe(e,t,s,l,n,i,a)}))}(e,t,n,i,a.columns),qe(e,t,i,a.columns)}));else for(var r=-1,l=a[0],o=function(){var s=r;if(l){e.applyStyles(e.userStyles);var o=l.columns;r>=0?tt(e,t,n,i,o,!0):$e(e,t,i,o),s=Ve(e,t,r+1,i,o),qe(e,t,i,o)}var h=s-r;a.slice(1).forEach((function(a){e.applyStyles(e.userStyles),tt(e,t,n,i,a.columns,!0),Ve(e,t,r+1,i,a.columns,h),qe(e,t,i,a.columns)})),r=s};r<t.body.length-1;)o()}(o,t,h,s):(o.applyStyles(o.userStyles),"firstPage"!==n.showHead&&"everyPage"!==n.showHead||t.head.forEach((function(e){return Je(o,t,e,s,t.columns)})),o.applyStyles(o.userStyles),t.body.forEach((function(e,n){var i=n===t.body.length-1;Qe(o,t,e,i,h,s,t.columns)})),o.applyStyles(o.userStyles),"lastPage"!==n.showFoot&&"everyPage"!==n.showFoot||t.foot.forEach((function(e){return Je(o,t,e,s,t.columns)}))),ve(o,t,h,s),t.callEndPageHooks(o,s),t.finalY=s.y,e.lastAutoTable=t,o.applyStyles(o.userStyles)}function $e(e,t,n,i){var a=t.settings;e.applyStyles(e.userStyles),"firstPage"!==a.showHead&&"everyPage"!==a.showHead||t.head.forEach((function(a){return Je(e,t,a,n,i)}))}function Ve(e,t,n,i,a,s){e.applyStyles(e.userStyles),s=null!=s?s:t.body.length;var r=Math.min(n+s,t.body.length),l=-1;return t.body.slice(n,r).forEach((function(s,r){var o=n+r===t.body.length-1,h=et(e,t,o,i);s.canEntireRowFit(h,a)&&(Je(e,t,s,i,a),l=n+r)})),l}function qe(e,t,n,i){var a=t.settings;e.applyStyles(e.userStyles),"lastPage"!==a.showFoot&&"everyPage"!==a.showFoot||t.foot.forEach((function(a){return Je(e,t,a,n,i)}))}function Xe(e,t,n){var i=n.getLineHeight(e.styles.fontSize),a=e.padding("vertical"),s=Math.floor((t-a)/i);return Math.max(0,s)}function Qe(e,t,n,i,a,s,r){var l=et(e,t,i,s);if(n.canEntireRowFit(l,r))Je(e,t,n,s,r);else if(function(e,t,n,i){var a=e.pageSize().height,s=i.settings.margin,r=a-(s.top+s.bottom);"body"===t.section&&(r-=i.getHeadHeight(i.columns)+i.getFootHeight(i.columns));var l=t.getMinimumRowHeight(i.columns,e);if(l>r)return!0;if(!(l<n))return!1;var o=t.hasRowSpan(i.columns);return!!(t.getMaxCellHeight(i.columns)>r)||!o&&"avoid"!==i.settings.rowPageBreak}(e,n,l,t)){var o=function(e,t,n,i){var a={};e.spansMultiplePages=!0,e.height=0;for(var s=0,r=0,l=n.columns;r<l.length;r++){var o=l[r];if(p=e.cells[o.index]){Array.isArray(p.text)||(p.text=[p.text]),(f=Pe(f=new Oe(p.raw,p.styles,p.section),p)).text=[];var h=Xe(p,t,i);p.text.length>h&&(f.text=p.text.splice(h,p.text.length));var d=i.scaleFactor(),c=i.getLineHeightFactor();p.contentHeight=p.getContentHeight(d,c),p.contentHeight>=t&&(p.contentHeight=t,f.styles.minCellHeight-=t),p.contentHeight>e.height&&(e.height=p.contentHeight),f.contentHeight=f.getContentHeight(d,c),f.contentHeight>s&&(s=f.contentHeight),a[o.index]=f}}var u=new ze(e.raw,-1,e.section,a,!0);u.height=s;for(var m=0,g=n.columns;m<g.length;m++){var f,p;o=g[m],(f=u.cells[o.index])&&(f.height=u.height),(p=e.cells[o.index])&&(p.height=e.height)}return u}(n,l,t,e);Je(e,t,n,s,r),tt(e,t,a,s,r),Qe(e,t,o,i,a,s,r)}else tt(e,t,a,s,r),Qe(e,t,n,i,a,s,r)}function Je(e,t,n,i,a){i.x=t.settings.margin.left;for(var s=0,r=a;s<r.length;s++){var l=r[s],o=n.cells[l.index];if(o)if(e.applyStyles(o.styles),o.x=i.x,o.y=i.y,!1!==t.callCellHooks(e,t.hooks.willDrawCell,o,n,l,i)){Ze(e,o,i);var h=o.getTextPos();ue(o.text,h.x,h.y,{halign:o.styles.halign,valign:o.styles.valign,maxWidth:Math.ceil(o.width-o.padding("left")-o.padding("right"))},e.getDocument()),t.callCellHooks(e,t.hooks.didDrawCell,o,n,l,i),i.x+=l.width}else i.x+=l.width;else i.x+=l.width}i.y+=n.height}function Ze(e,t,n){var i=t.styles;if(e.getDocument().setFillColor(e.getDocument().getFillColor()),"number"==typeof i.lineWidth){var a=je(i.lineWidth,i.fillColor);a&&e.rect(t.x,n.y,t.width,t.height,a)}else"object"==typeof i.lineWidth&&(i.fillColor&&e.rect(t.x,n.y,t.width,t.height,"F"),function(e,t,n,i){var a,s,r,l;i.top&&(a=n.x,s=n.y,r=n.x+t.width,l=n.y,i.right&&(r+=.5*i.right),i.left&&(a-=.5*i.left),o(i.top,a,s,r,l));i.bottom&&(a=n.x,s=n.y+t.height,r=n.x+t.width,l=n.y+t.height,i.right&&(r+=.5*i.right),i.left&&(a-=.5*i.left),o(i.bottom,a,s,r,l));i.left&&(a=n.x,s=n.y,r=n.x,l=n.y+t.height,i.top&&(s-=.5*i.top),i.bottom&&(l+=.5*i.bottom),o(i.left,a,s,r,l));i.right&&(a=n.x+t.width,s=n.y,r=n.x+t.width,l=n.y+t.height,i.top&&(s-=.5*i.top),i.bottom&&(l+=.5*i.bottom),o(i.right,a,s,r,l));function o(t,n,i,a,s){e.getDocument().setLineWidth(t),e.getDocument().line(n,i,a,s,"S")}}(e,t,n,i.lineWidth))}function et(e,t,n,i){var a=t.settings.margin.bottom,s=t.settings.showFoot;return("everyPage"===s||"lastPage"===s&&n)&&(a+=t.getFootHeight(t.columns)),e.pageSize().height-i.y-a}function tt(e,t,n,i,a,s){void 0===a&&(a=[]),void 0===s&&(s=!1),e.applyStyles(e.userStyles),"everyPage"!==t.settings.showFoot||s||t.foot.forEach((function(n){return Je(e,t,n,i,a)})),t.callEndPageHooks(e,i);var r=t.settings.margin;ve(e,t,n,i),nt(e),t.pageNumber++,i.x=r.left,i.y=r.top,n.y=r.top,t.callWillDrawPageHooks(e,i),"everyPage"===t.settings.showHead&&(t.head.forEach((function(n){return Je(e,t,n,i,a)})),e.applyStyles(e.userStyles))}function nt(e){var t=e.pageNumber();return e.setPage(t+1),e.pageNumber()===t&&(e.addPage(),!0)}try{if("undefined"!=typeof window&&window){var it=window,at=it.jsPDF||(null===(Fe=it.jspdf)||void 0===Fe?void 0:Fe.jsPDF);at&&function(e){e.API.autoTable=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return Ue(this,Le(this,We(this,e[0]))),this},e.API.lastAutoTable=!1,e.API.autoTableText=function(e,t,n,i){ue(e,t,n,i,this)},e.API.autoTableSetDefaults=function(e){return ge.setDefaults(e,this),this},e.autoTableSetDefaults=function(e,t){ge.setDefaults(e,t)},e.API.autoTableHtmlToJson=function(e,t){var n;if(void 0===t&&(t=!1),"undefined"==typeof window)return null;var i=De(new ge(this),e,window,t,!1),a=i.head,s=i.body;return{columns:(null===(n=a[0])||void 0===n?void 0:n.map((function(e){return e.content})))||[],rows:s,data:s}}}(at)}}catch(ct){}function st(){const[P,W]=t.useState(""),[F,ue]=t.useState({page:1,limit:10}),[me,ge]=t.useState("all"),[fe,pe]=t.useState(!1),[xe,ye]=t.useState(),[ve,je]=t.useState(null),[be,we]=t.useState(!1),[Ne,Se]=t.useState(!1),[Ce,De]=t.useState(!1),[He,Ae]=t.useState(null),[Pe,Fe]=t.useState(""),{data:Te,isLoading:ke,isError:_e}=ee(F),{data:ze}=te(ve||""),Oe=ne(),Ie=ie(),Me=ae(),Ee=n();t.useEffect((()=>{const e=setTimeout((()=>{if(P.trim())ue((e=>({...e,search:P,page:1})));else if(void 0!==F.search){const{search:e,...t}=F;ue({...t,page:1})}}),500);return()=>clearTimeout(e)}),[P]),t.useEffect((()=>{const e={page:1},t=new Date,n=t.getDay(),i=new Date(t);i.setDate(t.getDate()-n+(0===n?-6:1)),i.setHours(0,0,0,0);const a=new Date(i);a.setDate(i.getDate()+6),a.setHours(23,59,59,999);const s=new Date(t.getFullYear(),t.getMonth(),1);s.setHours(0,0,0,0);const r=new Date(t.getFullYear(),t.getMonth()+1,0);r.setHours(23,59,59,999),t.setHours(0,0,0,0);const l=new Date;if(l.setHours(23,59,59,999),"today"===me)e.startDate=t.toISOString().split("T")[0],e.endDate=l.toISOString().split("T")[0];else if("week"===me)e.startDate=i.toISOString().split("T")[0],e.endDate=a.toISOString().split("T")[0];else if("month"===me)e.startDate=s.toISOString().split("T")[0],e.endDate=r.toISOString().split("T")[0];else if(!(null==xe?void 0:xe.from)&&!(null==xe?void 0:xe.to)){const{startDate:t,endDate:n,...i}=F;return void ue((t=>({...i,...e})))}("all"===me&&(null==xe?void 0:xe.from)&&(null==xe?void 0:xe.to)||(null==xe?void 0:xe.from)&&(null==xe?void 0:xe.to)&&"today"!==me&&"week"!==me&&"month"!==me)&&(e.startDate=xe.from.toISOString().split("T")[0],e.endDate=xe.to.toISOString().split("T")[0]),ue((t=>({...t,...e})))}),[me,xe]);const Re=(e,t)=>{if(""===t||"all"===t){const t={...F};delete t[e],ue({...t,page:1})}else ue({...F,[e]:t,page:1})},Be=e=>new Intl.NumberFormat("vi-VN",{style:"currency",currency:"VND",maximumFractionDigits:0}).format(e),Ke=e=>de(new Date(e),"dd/MM/yyyy HH:mm",{locale:ce}),Ge=e=>{ue((t=>({...t,page:e})))};return e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"flex flex-col md:flex-row md:items-start justify-between gap-4",children:e.jsx("div",{className:"mb-0 md:mb-0",children:e.jsx(O,{children:e.jsxs(I,{children:[e.jsx(M,{children:e.jsx(E,{href:"/admin/statistics",children:"Dashboard"})}),e.jsx(R,{}),e.jsx(M,{children:e.jsx(L,{className:"font-medium",children:"Quản lý đơn hàng"})})]})})})}),e.jsx(i,{children:e.jsx(a,{className:"p-4",children:e.jsxs(y,{defaultValue:"all",className:"w-full",onValueChange:ge,children:[e.jsx("div",{className:"flex flex-col sm:flex-row gap-4 items-start sm:items-center justify-between mb-4",children:e.jsxs(v,{className:"h-9",children:[e.jsx(j,{value:"all",className:"px-4 text-maintext/70",onClick:()=>{ye(void 0),ge("all")},children:"Tất cả"}),e.jsx(j,{value:"today",className:"px-4 text-maintext/70",onClick:()=>{ye(void 0),ge("today")},children:"Hôm nay"}),e.jsx(j,{value:"week",className:"px-4 text-maintext/70",onClick:()=>{ye(void 0),ge("week")},children:"Tuần này"}),e.jsx(j,{value:"month",className:"px-4 text-maintext/70",onClick:()=>{ye(void 0),ge("month")},children:"Tháng này"})]})}),e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start mb-4 gap-4",children:[e.jsxs("div",{className:"relative w-full md:w-96",children:[e.jsx(w.Icon,{path:N,size:.7,className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-maintext"}),e.jsx(s,{type:"text",placeholder:"Tìm kiếm theo mã đơn, tên khách hàng, số điện thoại...",className:"pl-10 w-full",value:P,onChange:e=>W(e.target.value)})]}),e.jsxs("div",{className:"flex gap-2 w-full md:w-auto",children:[e.jsxs(T,{children:[e.jsx(k,{asChild:!0,children:e.jsxs(r,{variant:"outline",className:l("w-full justify-start text-left font-normal",!xe&&"text-muted-foreground"),children:[e.jsx(S,{className:"mr-2 h-4 w-4"}),(null==xe?void 0:xe.from)?xe.to?e.jsxs(e.Fragment,{children:[de(xe.from,"dd/MM/yyyy")," - ",de(xe.to,"dd/MM/yyyy")]}):de(xe.from,"dd/MM/yyyy"):"Chọn khoảng thời gian"]})}),e.jsx(_,{className:"w-auto p-0",align:"end",children:e.jsx(z,{initialFocus:!0,mode:"range",defaultMonth:null==xe?void 0:xe.from,selected:xe,onSelect:ye,numberOfMonths:2})})]}),e.jsxs(r,{variant:"outline",className:"flex items-center",onClick:()=>pe(!fe),children:[e.jsx(w.Icon,{path:C,size:.7,className:"mr-2"}),fe?"Ẩn bộ lọc":"Hiện bộ lọc"]}),e.jsx("div",{className:"flex flex-col sm:flex-row gap-2",children:e.jsxs(o,{children:[e.jsx(h,{asChild:!0,children:e.jsxs(r,{variant:"outline",children:[e.jsx(w.Icon,{path:D,size:.7,className:"mr-2"}),"Xuất dữ liệu"]})}),e.jsxs(d,{align:"end",children:[e.jsx(c,{onClick:function(){var e;if(!(null==(e=null==Te?void 0:Te.data)?void 0:e.orders)||0===Te.data.orders.length)return void u.warn("Không có dữ liệu để xuất.");const t=Te.data.orders,n=de(new Date,"yyyyMMdd");let i="orders_list";1===t.length&&t[0].code&&(i=t[0].code);const a=`${i}_${n}.xlsx`,s=t.map((e=>{var t,n;return{"Mã đơn hàng":e.code,"Khách hàng":(null==(t=e.shippingAddress)?void 0:t.name)||"N/A","Số điện thoại":(null==(n=e.shippingAddress)?void 0:n.phoneNumber)||"N/A","Ngày tạo":Ke(e.createdAt),"Tổng tiền":Be(e.total),"Trạng thái đơn hàng":e.orderStatus,"Trạng thái thanh toán":e.paymentStatus}})),r=le.json_to_sheet(s),l=le.book_new();le.book_append_sheet(l,r,"Đơn hàng"),oe(l,a),u.success(`Đã xuất file ${a} thành công!`)},children:"Xuất Excel"}),e.jsx(c,{onClick:function(){var e;if(!(null==(e=null==Te?void 0:Te.data)?void 0:e.orders)||0===Te.data.orders.length)return void u.warn("Không có dữ liệu để xuất.");const t=Te.data.orders,n=de(new Date,"yyyyMMdd");let i="orders_list";1===t.length&&t[0].code&&(i=t[0].code);const a=`${i}_${n}.pdf`,s=new he({orientation:"portrait",unit:"mm",format:"a4",putOnlyUsedFonts:!0,floatPrecision:16}),r=e=>{switch(e){case"CHO_XAC_NHAN":return"Chờ xác nhận";case"CHO_GIAO_HANG":return"Chờ giao hàng";case"DANG_VAN_CHUYEN":return"Đang vận chuyển";case"DA_GIAO_HANG":return"Đã giao hàng";case"HOAN_THANH":return"Hoàn thành";case"DA_HUY":return"Đã hủy";default:return e}},l=e=>{switch(e){case"PENDING":return"Chưa thanh toán";case"PARTIAL_PAID":return"Thanh toán một phần";case"PAID":return"Đã thanh toán";default:return e}};s.setFontSize(18),s.text("Danh sách Đơn hàng",14,22),s.setFontSize(11),s.setTextColor(100);const o=t.map((e=>{var t;return[e.code||"N/A",(null==(t=e.shippingAddress)?void 0:t.name)||"N/A",Ke(e.createdAt),Be(e.total),r(e.orderStatus),l(e.paymentStatus)]}));var h,d;h=s,d={startY:30,head:[["Mã đơn hàng","Khách hàng","Ngày tạo","Tổng tiền","Trạng thái ĐH","Trạng thái TT"]],body:o,theme:"grid",headStyles:{fillColor:[22,160,133],textColor:[255,255,255],fontStyle:"bold"},didDrawCell:e=>{},styles:{font:s.getFont().fontName,fontSize:9,cellPadding:3,overflow:"linebreak",halign:"left"},columnStyles:{3:{halign:"right"},4:{halign:"center"},5:{halign:"center"}}},Ue(h,Le(h,We(h,d))),s.save(a),u.success(`Đã xuất file ${a} thành công!`)},children:"Xuất PDF"}),e.jsx(c,{children:"In danh sách"})]})]})})]})]}),e.jsx(se,{children:fe&&e.jsx(re.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},transition:{duration:.3},className:"mb-4 border-t pt-4",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Trạng thái đơn hàng"}),e.jsxs(m,{value:F.orderStatus||"all",onValueChange:e=>Re("orderStatus",e),children:[e.jsx(g,{children:e.jsx(f,{placeholder:"Tất cả trạng thái"})}),e.jsxs(p,{children:[e.jsx(x,{value:"all",children:"Tất cả trạng thái"}),e.jsx(x,{value:"CHO_XAC_NHAN",children:"Chờ xác nhận"}),e.jsx(x,{value:"CHO_GIAO_HANG",children:"Chờ giao hàng"}),e.jsx(x,{value:"DANG_VAN_CHUYEN",children:"Đang vận chuyển"}),e.jsx(x,{value:"DA_GIAO_HANG",children:"Đã giao hàng"}),e.jsx(x,{value:"HOAN_THANH",children:"Hoàn thành"}),e.jsx(x,{value:"DA_HUY",children:"Đã hủy"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Trạng thái thanh toán"}),e.jsxs(m,{value:F.paymentStatus||"all",onValueChange:e=>Re("paymentStatus",e),children:[e.jsx(g,{children:e.jsx(f,{placeholder:"Tất cả trạng thái"})}),e.jsxs(p,{children:[e.jsx(x,{value:"all",children:"Tất cả trạng thái"}),e.jsx(x,{value:"PENDING",children:"Chưa thanh toán"}),e.jsx(x,{value:"PARTIAL_PAID",children:"Thanh toán một phần"}),e.jsx(x,{value:"PAID",children:"Đã thanh toán"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Khách hàng"}),e.jsx(s,{type:"text",value:F.customer||"",onChange:e=>Re("customer",e.target.value),placeholder:"Tìm theo tên khách hàng"})]})]})})}),e.jsx(b,{value:"all",className:"mt-0",children:Ye()}),e.jsx(b,{value:"today",className:"mt-0",children:Ye()}),e.jsx(b,{value:"week",className:"mt-0",children:Ye()}),e.jsx(b,{value:"month",className:"mt-0",children:Ye()})]})})}),e.jsx(ht,{isOpen:be,onClose:()=>we(!1),orderId:ve,orderDetail:null==ze?void 0:ze.data,formatCurrency:Be,formatDate:Ke,onUpdateStatus:(e,t)=>{je(e),Fe(t),Se(!0)},onCancelOrder:e=>{Ae(e),De(!0)}}),e.jsx(B,{open:Ne,onOpenChange:Se,children:e.jsxs(K,{children:[e.jsx(G,{children:e.jsx(Y,{children:"Cập nhật trạng thái đơn hàng"})}),e.jsx("div",{className:"py-4",children:e.jsxs(m,{value:Pe,onValueChange:Fe,children:[e.jsx(g,{children:e.jsx(f,{placeholder:"Chọn trạng thái"})}),e.jsxs(p,{children:[e.jsx(x,{value:"CHO_XAC_NHAN",children:"Chờ xác nhận"}),e.jsx(x,{value:"CHO_GIAO_HANG",children:"Chờ giao hàng"}),e.jsx(x,{value:"DANG_VAN_CHUYEN",children:"Đang vận chuyển"}),e.jsx(x,{value:"DA_GIAO_HANG",children:"Đã giao hàng"}),e.jsx(x,{value:"HOAN_THANH",children:"Hoàn thành"}),e.jsx(x,{value:"DA_HUY",children:"Đã hủy"})]})]})}),e.jsxs(U,{children:[e.jsx(r,{variant:"outline",onClick:()=>Se(!1),children:"Hủy"}),e.jsx(r,{onClick:async()=>{if(ve&&Pe)try{await Oe.mutateAsync({orderId:ve,payload:{status:Pe}},{onSuccess:()=>{u.success("Cập nhật trạng thái đơn hàng thành công"),Me.invalidateQueries({queryKey:["orders"]}),Me.invalidateQueries({queryKey:["order",ve]}),Se(!1)}})}catch(ct){u.error("Cập nhật trạng thái đơn hàng thất bại")}},children:"Cập nhật"})]})]})}),e.jsx(B,{open:Ce,onOpenChange:De,children:e.jsxs(K,{children:[e.jsx(G,{children:e.jsx(Y,{children:"Xác nhận hủy đơn hàng"})}),e.jsx("div",{className:"py-4",children:e.jsx("p",{children:"Bạn có chắc chắn muốn hủy đơn hàng này không? Hành động này không thể hoàn tác."})}),e.jsxs(U,{children:[e.jsx(r,{variant:"outline",onClick:()=>De(!1),children:"Không"}),e.jsx(r,{variant:"destructive",onClick:async()=>{if(He)try{await Ie.mutateAsync(He,{onSuccess:()=>{u.success("Hủy đơn hàng thành công"),Me.invalidateQueries({queryKey:["orders"]}),De(!1),ve===He&&Me.invalidateQueries({queryKey:["order",ve]})}})}catch(ct){u.error("Hủy đơn hàng thất bại")}},children:"Xác nhận hủy"})]})]})})]});function Ye(){return ke?e.jsx("div",{className:"space-y-4",children:[...Array(5)].map(((t,n)=>e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx(Z,{className:"h-12 w-12 rounded-[6px]"}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(Z,{className:"h-4 w-[250px]"}),e.jsx(Z,{className:"h-4 w-[200px]"})]})]},n)))}):_e?e.jsxs("div",{className:"text-center py-10",children:[e.jsx("p",{className:"text-red-500",children:"Đã xảy ra lỗi khi tải dữ liệu đơn hàng. Vui lòng thử lại sau."}),e.jsx(r,{variant:"outline",className:"mt-4",onClick:()=>Me.invalidateQueries({queryKey:["orders"]}),children:"Thử lại"})]}):(null==Te?void 0:Te.data.orders)&&0!==Te.data.orders.length?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"overflow-hidden",children:e.jsxs($,{children:[e.jsx(V,{children:e.jsxs(q,{children:[e.jsx(X,{className:"w-[120px]",children:"Mã đơn hàng"}),e.jsx(X,{children:"Khách hàng"}),e.jsx(X,{className:"hidden md:table-cell",children:"Ngày tạo"}),e.jsx(X,{className:"hidden lg:table-cell",children:"Loại đơn hàng"}),e.jsx(X,{className:"text-right",children:"Tổng tiền"}),e.jsx(X,{className:"hidden md:table-cell",children:"Trạng thái đơn hàng"}),e.jsx(X,{className:"hidden md:table-cell",children:"Trạng thái thanh toán"}),e.jsx(X,{className:"text-right",children:"Thao tác"})]})}),e.jsx(Q,{children:Te.data.orders.map((t=>{var n,i;return e.jsxs(q,{children:[e.jsx(J,{className:"font-medium",children:t.code}),e.jsx(J,{children:e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:null==(n=t.shippingAddress)?void 0:n.name}),e.jsx("div",{className:"text-sm text-maintext",children:null==(i=t.shippingAddress)?void 0:i.phoneNumber})]})}),e.jsx(J,{className:"hidden md:table-cell",children:Ke(t.createdAt)}),e.jsx(J,{className:"hidden lg:table-cell",children:e.jsx(ot,{orderCode:t.code})}),e.jsx(J,{className:"text-right font-medium",children:Be(t.total)}),e.jsx(J,{className:"hidden md:table-cell",children:e.jsx(rt,{status:t.orderStatus})}),e.jsx(J,{className:"hidden md:table-cell",children:e.jsx(lt,{status:t.paymentStatus})}),e.jsx(J,{className:"text-right",children:e.jsxs("div",{className:"flex justify-end space-x-2",children:[e.jsx(r,{variant:"outline",size:"icon",onClick:()=>{return e=t.id,void Ee(`/admin/orders/${e}`);var e},children:e.jsx(w.Icon,{path:H,size:.7})}),e.jsx(r,{variant:"outline",size:"icon",disabled:"DA_HUY"===t.orderStatus||"HOAN_THANH"===t.orderStatus,onClick:()=>{Ae(t.id),De(!0)},children:e.jsx(w.Icon,{path:A,size:.7})})]})})]},t.id)}))})]})}),Te.data.pagination.totalPages>1&&e.jsx("div",{className:"flex justify-center mt-6",children:e.jsxs("div",{className:"flex space-x-2",children:[e.jsx(r,{variant:"outline",size:"sm",onClick:()=>Ge(Math.max(1,Te.data.pagination.currentPage-1)),disabled:1===Te.data.pagination.currentPage,children:"Trước"}),Array.from({length:Te.data.pagination.totalPages},((e,t)=>t+1)).filter((e=>1===e||e===Te.data.pagination.currentPage||Math.abs(e-Te.data.pagination.currentPage)<=1)).reduce(((e,t,n,i)=>(n>0&&t-i[n-1]>1&&e.push("..."),e.push(t),e)),[]).map(((t,n)=>"..."===t?e.jsx(r,{variant:"outline",size:"sm",disabled:!0,children:"..."},`ellipsis-${n}`):e.jsx(r,{variant:Te.data.pagination.currentPage===t?"default":"outline",size:"sm",onClick:()=>Ge(t),children:t},`page-${t}`))),e.jsx(r,{variant:"outline",size:"sm",onClick:()=>Ge(Math.min(Te.data.pagination.totalPages,Te.data.pagination.currentPage+1)),disabled:Te.data.pagination.currentPage===Te.data.pagination.totalPages,children:"Sau"})]})})]}):e.jsx("div",{className:"text-center py-10",children:e.jsx("p",{className:"text-maintext",children:"Không tìm thấy đơn hàng nào."})})}}const rt=({status:t})=>{const n=(e=>{switch(e){case"CHO_XAC_NHAN":return{label:"Chờ xác nhận",className:"!bg-amber-50 !text-amber-500 !border-amber-500"};case"CHO_GIAO_HANG":return{label:"Chờ giao hàng",className:"!bg-blue-50 !text-blue-500 !border-blue-500"};case"DANG_VAN_CHUYEN":return{label:"Đang vận chuyển",className:"!bg-orange-50 !text-orange-500 !border-orange-500"};case"DA_GIAO_HANG":return{label:"Đã giao hàng",className:"!bg-green-50 !text-green-500 !border-green-500"};case"HOAN_THANH":return{label:"Hoàn thành",className:"!bg-green-50 !text-green-500 !border-green-500"};case"DA_HUY":return{label:"Đã hủy",className:"!bg-red-50 !text-red-500 !border-red-500"};default:return{label:"Không xác định",className:"!bg-gray-50 !text-maintext !border-gray-500"}}})(t);return e.jsx(F,{className:n.className,children:n.label})},lt=({status:t})=>{const n=(e=>{switch(e){case"PENDING":return{label:"Chưa thanh toán",className:"!bg-yellow-50 !text-yellow-500 !border-yellow-500"};case"PARTIAL_PAID":return{label:"Thanh toán một phần",className:"!bg-blue-50 !text-blue-500 !border-blue-500"};case"PAID":return{label:"Đã thanh toán",className:"!bg-green-50 !text-green-500 !border-green-500"};default:return{label:"Không xác định",className:"!bg-gray-50 !text-maintext !border-gray-500"}}})(t);return e.jsx(F,{className:n.className,children:n.label})},ot=({orderCode:t})=>{const n=(i=t)&&i.includes("POS")?{label:"Tại quầy",className:"!bg-purple-50 !text-purple-500 !border-purple-500"}:i&&i.includes("DH")?{label:"Online",className:"!bg-cyan-50 !text-cyan-500 !border-cyan-500"}:{label:"Không xác định",className:"!bg-gray-50 !text-maintext !border-gray-500"};var i;return e.jsx(F,{className:n.className,children:n.label})},ht=({isOpen:t,onClose:n,orderId:i,orderDetail:a,formatCurrency:s,formatDate:l,onUpdateStatus:o,onCancelOrder:h})=>{var d,c,u;if(!i||!a)return null;return e.jsx(B,{open:t,onOpenChange:e=>!e&&n(),children:e.jsxs(K,{className:"max-w-4xl max-h-[90vh] overflow-y-auto",children:[e.jsx(G,{children:e.jsxs(Y,{className:"flex justify-between items-center",children:[e.jsxs("span",{children:["Chi tiết đơn hàng: ",a.orderNumber]}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx("a",{href:`/admin/orders/edit/${i}`,children:e.jsxs(r,{variant:"outline",size:"sm",children:[e.jsx(w.Icon,{path:P,size:.7,className:"mr-2"}),"Chỉnh sửa"]})}),e.jsxs(r,{variant:"outline",size:"sm",children:[e.jsx(w.Icon,{path:W,size:.7,className:"mr-2"}),"In đơn"]})]})]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 py-4",children:[e.jsx("div",{children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium text-maintext",children:"Thông tin đơn hàng"}),e.jsxs("div",{className:"mt-2 rounded-[6px] border p-4 space-y-4",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm text-maintext",children:"Mã đơn hàng:"}),e.jsx("span",{className:"text-sm font-medium",children:a.orderNumber})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm text-maintext",children:"Ngày tạo:"}),e.jsx("span",{className:"text-sm font-medium",children:l(a.createdAt)})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm text-maintext",children:"Trạng thái đơn hàng:"}),e.jsx(rt,{status:a.orderStatus})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm text-maintext",children:"Trạng thái thanh toán:"}),e.jsx(lt,{status:a.paymentStatus})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm text-maintext",children:"Phương thức thanh toán:"}),e.jsx("span",{className:"text-sm font-medium",children:(e=>{switch(e){case"CASH":return"Tiền mặt";case"BANK_TRANSFER":return"Chuyển khoản ngân hàng";case"COD":return"Thanh toán khi nhận hàng";case"MIXED":return"Thanh toán nhiều phương thức";default:return"Không xác định"}})(a.paymentMethod)})]})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium text-maintext",children:"Thông tin khách hàng"}),e.jsxs("div",{className:"mt-2 rounded-[6px] border p-4 space-y-4",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm text-maintext",children:"Tên khách hàng:"}),e.jsx("span",{className:"text-sm font-medium",children:null==(d=a.customer)?void 0:d.fullName})]}),(null==(c=a.customer)?void 0:c.email)&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm text-maintext",children:"Email:"}),e.jsx("span",{className:"text-sm font-medium",children:a.customer.email})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm text-maintext",children:"Số điện thoại:"}),e.jsx("span",{className:"text-sm font-medium",children:null==(u=a.customer)?void 0:u.phoneNumber})]})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium text-maintext",children:"Địa chỉ giao hàng"}),e.jsx("div",{className:"mt-2 rounded-[6px] border p-4",children:a.shippingAddress?e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{className:"text-sm font-medium",children:a.shippingAddress.name}),e.jsx("p",{className:"text-sm",children:a.shippingAddress.phoneNumber}),e.jsxs("p",{className:"text-sm",children:[a.shippingAddress.specificAddress,", ",a.shippingAddress.wardName,","," ",a.shippingAddress.districtName,", ",a.shippingAddress.provinceName]})]}):e.jsx("p",{className:"text-sm text-maintext",children:"Không có thông tin địa chỉ giao hàng"})})]})]})}),e.jsx("div",{children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium text-maintext",children:"Sản phẩm đã đặt"}),e.jsx("div",{className:"mt-2 rounded-[6px]",children:e.jsx("div",{className:"max-h-[300px] overflow-y-auto",children:e.jsxs($,{children:[e.jsx(V,{children:e.jsxs(q,{children:[e.jsx(X,{children:"Sản phẩm"}),e.jsx(X,{className:"text-right",children:"Đơn giá"}),e.jsx(X,{className:"text-right",children:"SL"}),e.jsx(X,{className:"text-right",children:"Tổng"})]})}),e.jsx(Q,{children:a.items.map(((t,n)=>{var i,a,r;return e.jsxs(q,{children:[e.jsx(J,{children:e.jsxs("div",{className:"flex items-center gap-2",children:[t.product&&t.product.imageUrl&&e.jsx("div",{className:"w-10 h-10 rounded border overflow-hidden bg-gray-100",children:e.jsx("img",{src:t.product.imageUrl,alt:t.product.name,className:"w-full h-full object-contain"})}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-sm",children:null==(i=t.product)?void 0:i.name}),e.jsx("div",{className:"text-xs text-maintext",children:(null==(a=t.variant)?void 0:a.colorName)&&(null==(r=t.variant)?void 0:r.sizeName)&&`${t.variant.colorName} / ${t.variant.sizeName}`})]})]})}),e.jsx(J,{className:"text-right",children:s(t.price)}),e.jsx(J,{className:"text-right",children:t.quantity}),e.jsx(J,{className:"text-right",children:s(t.price*t.quantity)})]},n)}))})]})})})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium text-maintext",children:"Tổng tiền"}),e.jsxs("div",{className:"mt-2 rounded-[6px] border p-4 space-y-4",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm text-maintext",children:"Tổng tiền hàng:"}),e.jsx("span",{className:"text-sm font-medium",children:s(a.subTotal)})]}),a.voucher&&e.jsxs("div",{className:"flex justify-between",children:[e.jsxs("span",{className:"text-sm text-maintext",children:["Mã giảm giá (",a.voucher.code,"):"]}),e.jsxs("span",{className:"text-sm font-medium text-red-500",children:["-",s(a.discount)]})]}),e.jsxs("div",{className:"flex justify-between border-t pt-2",children:[e.jsx("span",{className:"text-sm font-medium",children:"Tổng thanh toán:"}),e.jsx("span",{className:"text-base font-bold",children:s(a.total)})]})]})]}),e.jsx("div",{className:"space-y-2",children:e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsx(r,{className:"w-full",disabled:["DA_HUY","HOAN_THANH"].includes(a.orderStatus),onClick:()=>o(i,a.orderStatus),children:"Cập nhật trạng thái"}),e.jsx(r,{variant:"outline",className:"w-full",disabled:["DA_HUY","HOAN_THANH"].includes(a.orderStatus),onClick:()=>h(i),children:"Hủy đơn hàng"})]})})]})})]})]})})},dt=()=>e.jsx(st,{});export{dt as default};
