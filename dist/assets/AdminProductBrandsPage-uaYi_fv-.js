import{j as e}from"./ui-vendor-CFM_MCUz.js";import{r as s}from"./react-vendor-B55MjJUH.js";import{C as a,c as t}from"./card-ClEzRAeX.js";import{S as n}from"./skeleton-4G_X8bY4.js";import{t as i,ad as l,a5 as r,aL as c,aM as h}from"./icons-vendor-BrsZP2ku.js";import{I as d,B as x,y as m}from"./index-BHeY-5EX.js";import{u as o,b as u,c as j,d as p,e as g}from"./attributes-DYSh1UfM.js";import{d as N}from"./query-vendor-CBwfxcof.js";import{B as y,a as v,b as f,c as w,d as b,e as T}from"./breadcrumb-CP4jYkI2.js";import{T as D,a as C,b as O,c as H,d as _,e as S}from"./table-DL-K3PV4.js";import{S as k,a as A,b as G,c as K,d as I}from"./select-C6W71KWg.js";import{L as q}from"./label-Bm9nFuXD.js";import"./heavy-vendor-BfN2pHnQ.js";function F(){const[j,p]=s.useState(""),[g,q]=s.useState({}),{data:F,isLoading:z,isError:E}=o(g),V=u(),P=N(),[X,B]=s.useState(!1),[M,J]=s.useState(null),[R,U]=s.useState(!1),[W,Y]=s.useState(null),[Z,$]=s.useState(!1),ee=s.useMemo((()=>{if(!(null==F?void 0:F.data)||!j.trim())return null==F?void 0:F.data;const e=j.toLowerCase().trim();return F.data.filter((s=>s.name.toLowerCase().includes(e)))}),[null==F?void 0:F.data,j]);return e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"flex justify-between items-start",children:e.jsx(y,{children:e.jsxs(v,{children:[e.jsx(f,{children:e.jsx(w,{href:"/admin/statistics",children:"Dashboard"})}),e.jsx(b,{}),e.jsx(f,{children:e.jsx(w,{href:"/admin/products",children:"Quản lý sản phẩm"})}),e.jsx(b,{}),e.jsx(f,{children:e.jsx(T,{children:"Thương hiệu"})})]})})}),e.jsx(a,{className:"mb-4",children:e.jsx(t,{className:"py-4",children:e.jsxs("div",{className:"flex flex-col space-y-4 md:space-y-0 md:flex-row md:justify-between md:items-center gap-2",children:[e.jsxs("div",{className:"relative flex-1 max-w-4xl",children:[e.jsx(i.Icon,{path:l,size:.7,className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-maintext"}),e.jsx(d,{type:"text",placeholder:"Tìm kiếm theo tên thương hiệu...",className:"pl-10 pr-4 py-2 w-full border rounded-[6px]",value:j,onChange:e=>p(e.target.value)})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(k,{value:g.status||"all",onValueChange:e=>((e,s)=>{if("all"===s||""===s){const s={...g};delete s[e],q(s)}else q({...g,[e]:s})})("status",e),children:[e.jsx(A,{children:e.jsx(G,{placeholder:"Tất cả trạng thái"})}),e.jsxs(K,{children:[e.jsx(I,{value:"all",children:"Tất cả trạng thái"}),e.jsx(I,{value:"HOAT_DONG",children:"Hoạt động"}),e.jsx(I,{value:"KHONG_HOAT_DONG",children:"Không hoạt động"})]})]}),e.jsxs(Dialog,{open:Z,onOpenChange:$,children:[e.jsx(DialogTrigger,{asChild:!0,children:e.jsxs(x,{onClick:()=>$(!0),children:[e.jsx(i.Icon,{path:r,size:.7}),"Thêm thương hiệu mới"]})}),e.jsx(Q,{isOpen:Z,onClose:()=>$(!1)})]})]})]})})}),z?e.jsx("div",{className:"bg-white rounded-[6px] shadow-sm overflow-visible",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs(D,{children:[e.jsx(C,{children:e.jsxs(O,{children:[e.jsx(H,{className:"px-4 py-4 text-left text-sm font-medium text-maintext",children:"ID"}),e.jsx(H,{className:"px-4 py-4 text-left text-sm font-medium text-maintext",children:"Tên thương hiệu"}),e.jsx(H,{className:"px-4 py-4 text-left text-sm font-medium text-maintext",children:"Trạng thái"}),e.jsx(H,{className:"px-4 py-4 text-left text-sm font-medium text-maintext",children:"Ngày cập nhật"}),e.jsx(H,{className:"px-4 py-4 text-right text-sm font-medium text-maintext",children:"Thao tác"})]})}),e.jsx(_,{children:[...Array(5)].map(((s,a)=>e.jsxs(O,{children:[e.jsx(S,{className:"px-4 py-4 whitespace-nowrap",children:e.jsx(n,{className:"h-4 w-[80px]"})}),e.jsx(S,{className:"px-4 py-4 whitespace-nowrap",children:e.jsx(n,{className:"h-4 w-[160px]"})}),e.jsx(S,{className:"px-4 py-4 whitespace-nowrap",children:e.jsx(n,{className:"h-6 w-[100px] rounded-full"})}),e.jsx(S,{className:"px-4 py-4 whitespace-nowrap",children:e.jsx(n,{className:"h-4 w-[100px]"})}),e.jsx(S,{className:"px-4 py-4 whitespace-nowrap text-right",children:e.jsxs("div",{className:"flex items-center justify-end space-x-2",children:[e.jsx(n,{className:"h-8 w-8 rounded-[6px]"}),e.jsx(n,{className:"h-8 w-8 rounded-[6px]"})]})})]},a)))})]})})}):E?e.jsxs("div",{className:"bg-white rounded-[6px] shadow-sm p-4 text-center",children:[e.jsx("p",{className:"text-red-500",children:"Đã xảy ra lỗi khi tải dữ liệu. Vui lòng thử lại sau."}),e.jsx(x,{variant:"outline",className:"mt-4",onClick:()=>P.invalidateQueries({queryKey:["brands"]}),children:"Thử lại"})]}):e.jsx("div",{className:"bg-white rounded-[6px] shadow-sm overflow-visible",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs(D,{children:[e.jsx(C,{children:e.jsxs(O,{children:[e.jsx(H,{className:"px-4 py-4 text-left text-sm font-medium text-maintext",children:"ID"}),e.jsx(H,{className:"px-4 py-4 text-left text-sm font-medium text-maintext",children:"Tên thương hiệu"}),e.jsx(H,{className:"px-4 py-4 text-left text-sm font-medium text-maintext",children:"Trạng thái"}),e.jsx(H,{className:"px-4 py-4 text-left text-sm font-medium text-maintext",children:"Ngày cập nhật"}),e.jsx(H,{className:"px-4 py-4 text-right text-sm font-medium text-maintext",children:"Thao tác"})]})}),e.jsx(_,{children:(null==ee?void 0:ee.length)?ee.map((s=>{return e.jsxs(O,{className:"hover:bg-gray-50",children:[e.jsx(S,{className:"px-4 py-4 whitespace-nowrap text-sm text-maintext",children:s.id}),e.jsx(S,{className:"px-4 py-4 whitespace-nowrap",children:e.jsx("div",{className:"text-sm font-medium text-maintext",children:s.name})}),e.jsx(S,{className:"px-4 py-4 whitespace-nowrap",children:e.jsx("span",{className:"px-2 py-1 text-xs rounded-full "+("HOAT_DONG"===s.status?"bg-green-100 text-green-800":"bg-red-100 text-red-800"),children:"HOAT_DONG"===s.status?"Hoạt động":"Không hoạt động"})}),e.jsx(S,{className:"px-4 py-4 whitespace-nowrap text-sm text-maintext",children:(a=s.updatedAt,new Intl.DateTimeFormat("vi-VN",{day:"2-digit",month:"2-digit",year:"numeric"}).format(new Date(a)))}),e.jsx(S,{className:"px-4 py-4 whitespace-nowrap text-right",children:e.jsxs("div",{className:"flex items-center justify-end space-x-2",children:[e.jsxs(Dialog,{open:R&&W===s.id,onOpenChange:e=>{U(e),e||Y(null)},children:[e.jsx(DialogTrigger,{asChild:!0,children:e.jsx(x,{variant:"outline",size:"icon",title:"Sửa",onClick:()=>{Y(s.id),U(!0)},children:e.jsx(i.Icon,{path:c,size:.7})})}),W===s.id&&e.jsx(L,{brandId:s.id,isOpen:R,onClose:()=>{U(!1),Y(null)}})]}),e.jsxs(Dialog,{open:X&&M===s.id,onOpenChange:B,children:[e.jsx(DialogTrigger,{asChild:!0,children:e.jsx(x,{variant:"outline",size:"icon",onClick:()=>{J(s.id),B(!0)},title:"Xóa",children:e.jsx(i.Icon,{path:h,size:.7})})}),e.jsxs(DialogContent,{children:[e.jsx(DialogHeader,{children:e.jsx(DialogTitle,{children:"Xác nhận xóa thương hiệu"})}),e.jsx("p",{children:"Bạn có chắc chắn muốn xóa thương hiệu này không?"}),e.jsxs(DialogFooter,{children:[e.jsx(DialogClose,{asChild:!0,children:e.jsx(x,{variant:"outline",onClick:()=>B(!1),children:"Hủy"})}),e.jsx(x,{variant:"destructive",onClick:()=>{M&&((async e=>{try{await V.mutateAsync(e,{onSuccess:()=>{m.success("Đã xóa thương hiệu thành công"),P.invalidateQueries({queryKey:["brands"]})}})}catch(s){m.error("Xóa thương hiệu thất bại")}})(M),B(!1))},children:"Xóa"})]})]})]})]})})]},s.id);var a})):e.jsx(O,{children:e.jsx(S,{colSpan:5,className:"px-4 py-8 text-center text-maintext",children:"Không tìm thấy thương hiệu nào"})})})]})})})]})}function L({brandId:a,isOpen:t,onClose:i}){const l=N(),{data:r,isLoading:c,isError:h}=p(a),o=g(),[u,j]=s.useState({name:"",status:"HOAT_DONG"}),[y,v]=s.useState({name:""});s.useEffect((()=>{(null==r?void 0:r.data)&&j({name:r.data.name,status:r.data.status})}),[r]);return c?e.jsxs(DialogContent,{className:"sm:max-w-4xl",children:[e.jsx(DialogHeader,{children:e.jsx(DialogTitle,{children:e.jsx(n,{className:"h-8 w-[200px]"})})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{className:"h-4 w-[100px]"}),e.jsx(n,{className:"h-10 w-full"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{className:"h-4 w-[100px]"}),e.jsx(n,{className:"h-10 w-full"})]}),e.jsxs("div",{className:"flex justify-end space-x-4",children:[e.jsx(n,{className:"h-10 w-[100px]"}),e.jsx(n,{className:"h-10 w-[150px]"})]})]})]}):h||!r?e.jsxs(DialogContent,{className:"sm:max-w-4xl",children:[e.jsx(DialogHeader,{children:e.jsx(DialogTitle,{children:"Lỗi"})}),e.jsxs("div",{className:"py-4 text-center",children:[e.jsx("p",{className:"text-red-500 mb-4",children:"Đã xảy ra lỗi khi tải dữ liệu thương hiệu."}),e.jsxs("div",{className:"flex justify-center space-x-4",children:[e.jsx(x,{variant:"outline",onClick:i,children:"Đóng"}),e.jsx(x,{onClick:()=>l.invalidateQueries({queryKey:["brand",a]}),children:"Thử lại"})]})]})]}):e.jsxs(DialogContent,{className:"sm:max-w-4xl",children:[e.jsx(DialogHeader,{children:e.jsxs(DialogTitle,{children:["Chỉnh sửa thương hiệu: ",r.data.name]})}),e.jsxs("form",{onSubmit:async e=>{if(e.preventDefault(),(()=>{let e=!0;const s={...y};return u.name.trim()||(s.name="Tên thương hiệu không được để trống",e=!1),v(s),e})())try{await o.mutateAsync({brandId:a,payload:u},{onSuccess:()=>{m.success("Cập nhật thương hiệu thành công"),l.invalidateQueries({queryKey:["brand",a]}),l.invalidateQueries({queryKey:["brands"]}),i()},onError:e=>{m.error("Cập nhật thương hiệu thất bại: "+e.message)}})}catch(s){m.error("Đã xảy ra lỗi khi cập nhật thương hiệu")}},className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(q,{htmlFor:"name",children:"Tên thương hiệu"}),e.jsx(d,{id:"name",name:"name",placeholder:"Nhập tên thương hiệu",value:u.name,onChange:e=>{const{name:s,value:a}=e.target;j((e=>({...e,[s]:a}))),y[s]&&v((e=>({...e,[s]:""})))},className:y.name?"border-red-500":""}),y.name&&e.jsx("p",{className:"text-red-500 text-sm",children:y.name})]}),e.jsx("div",{className:"space-y-2",children:e.jsxs(k,{value:u.status,onValueChange:e=>{j((s=>({...s,status:e})))},children:[e.jsx(A,{id:"status",children:e.jsx(G,{placeholder:"Chọn trạng thái"})}),e.jsxs(K,{children:[e.jsx(I,{value:"HOAT_DONG",children:"Hoạt động"}),e.jsx(I,{value:"KHONG_HOAT_DONG",children:"Không hoạt động"})]})]})}),e.jsxs(DialogFooter,{children:[e.jsx(x,{type:"button",variant:"outline",onClick:i,children:"Hủy"}),e.jsx(x,{type:"submit",disabled:o.isPending,children:o.isPending?"Đang xử lý...":"Cập nhật thương hiệu"})]})]})]})}function Q({isOpen:a,onClose:t}){const n=N(),i=j(),[l,r]=s.useState({name:"",status:"HOAT_DONG"}),[c,h]=s.useState({name:""});return e.jsxs(DialogContent,{className:"sm:max-w-4xl",children:[e.jsx(DialogHeader,{children:e.jsx(DialogTitle,{children:"Thêm thương hiệu mới"})}),e.jsxs("form",{onSubmit:async e=>{if(e.preventDefault(),(()=>{let e=!0;const s={...c};return l.name.trim()||(s.name="Tên thương hiệu không được để trống",e=!1),h(s),e})())try{await i.mutateAsync(l,{onSuccess:()=>{m.success("Thêm thương hiệu thành công"),n.invalidateQueries({queryKey:["brands"]}),r({name:"",status:"HOAT_DONG"}),t()},onError:e=>{"Duplicate entry. This record already exists."===e.message||m.error("Thêm thương hiệu thất bại: Thương hiệu đã tồn tại")}})}catch(s){}},className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(q,{htmlFor:"create-name",children:"Tên thương hiệu"}),e.jsx(d,{id:"create-name",name:"name",placeholder:"Nhập tên thương hiệu",value:l.name,onChange:e=>{const{name:s,value:a}=e.target;r((e=>({...e,[s]:a}))),c[s]&&h((e=>({...e,[s]:""})))},className:c.name?"border-red-500":""}),c.name&&e.jsx("p",{className:"text-red-500 text-sm",children:c.name})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(q,{htmlFor:"create-status",children:"Trạng thái"}),e.jsxs(k,{value:l.status,onValueChange:e=>{r((s=>({...s,status:e})))},children:[e.jsx(A,{id:"create-status",children:e.jsx(G,{placeholder:"Chọn trạng thái"})}),e.jsxs(K,{children:[e.jsx(I,{value:"HOAT_DONG",children:"Hoạt động"}),e.jsx(I,{value:"KHONG_HOAT_DONG",children:"Không hoạt động"})]})]})]}),e.jsxs(DialogFooter,{children:[e.jsx(x,{type:"button",variant:"outline",onClick:t,children:"Hủy"}),e.jsx(x,{type:"submit",disabled:i.isPending,children:i.isPending?"Đang xử lý...":"Thêm thương hiệu"})]})]})]})}const z=()=>e.jsx(F,{});export{z as default};
