import{a as h,aJ as P,j as e,B as j,k as X,aa as R,q as $,a6 as o,bh as J}from"./index-Dpx_4rWJ.js";import{o as Z,v as U,w as W}from"./attributes-Bjak6hx3.js";import{L as T}from"./label-B0XdI4bT.js";import{T as k,a as O,b as f,c as l,d as H,e as n}from"./table-BeX0puEz.js";import{D as _,h as E,a as V,b as F,c as Q,e as q,i as Y}from"./dialog-BuHyDe_9.js";import{S as L,a as I,b as A,c as K,d as D}from"./select-CS4vNzI5.js";import{B as z,a as ee,b as C,c as B,d as G,e as se}from"./breadcrumb-CJedQ5QG.js";import{g as v,S as te,a as ae}from"./sizeMapping-RjPPY2bw.js";import"./createLucideIcon-BdgKQErZ.js";import"./index-BdQq_4o_.js";import"./index-qvEK80KO.js";import"./check-CyKb8IHM.js";function re(){const[i,m]=h.useState(""),[c,u]=h.useState({}),{data:t,isLoading:x,isError:d}=Z(c),g=U(),b=P(),[N,y]=h.useState(!1),p=h.useMemo(()=>{if(!(t!=null&&t.data)||!i.trim())return t==null?void 0:t.data;const s=i.toLowerCase().trim(),r=Number(s);return t.data.filter(w=>{const M=v(w.value);return(isNaN(r)?String(w.value).includes(s):w.value===r)||M.toLowerCase().includes(s)})},[t==null?void 0:t.data,i]),S=async s=>{if(!s){console.error("sizeId is undefined, null or empty:",s),o.error("Lỗi: Không tìm thấy ID kích cỡ");return}try{await g.mutateAsync(s,{onSuccess:()=>{o.success("Đã xóa kích cỡ thành công"),b.invalidateQueries({queryKey:["sizes"]})},onError:r=>{console.error("Delete error:",r),o.error("Xóa kích cỡ thất bại")}})}catch(r){console.error("Delete error:",r),o.error("Xóa kích cỡ thất bại")}},a=s=>new Intl.DateTimeFormat("vi-VN",{day:"2-digit",month:"2-digit",year:"numeric"}).format(new Date(s));return e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"flex justify-between items-start",children:e.jsx(z,{children:e.jsxs(ee,{children:[e.jsx(C,{children:e.jsx(B,{href:"/admin/statistics",children:"Dashboard"})}),e.jsx(G,{}),e.jsx(C,{children:e.jsx(B,{href:"/admin/products",children:"Quản lý sản phẩm"})}),e.jsx(G,{}),e.jsx(C,{children:e.jsx(se,{children:"Kích cỡ"})})]})})}),e.jsxs(_,{open:N,onOpenChange:y,children:[e.jsx(E,{asChild:!0,children:e.jsxs(j,{onClick:()=>y(!0),children:[e.jsx(X.Icon,{path:R,size:.7}),"Thêm kích cỡ mới"]})}),e.jsx(le,{isOpen:N,onClose:()=>y(!1)})]}),x?e.jsx("div",{className:"bg-white rounded-[6px] shadow-sm overflow-visible",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs(k,{children:[e.jsx(O,{children:e.jsxs(f,{children:[e.jsx(l,{className:"px-4 py-4 text-left text-sm font-medium text-maintext",children:"ID"}),e.jsx(l,{className:"px-4 py-4 text-left text-sm font-medium text-maintext",children:"Kích cỡ"}),e.jsx(l,{className:"px-4 py-4 text-left text-sm font-medium text-maintext",children:"Giá trị số"}),e.jsx(l,{className:"px-4 py-4 text-left text-sm font-medium text-maintext",children:"Trạng thái"}),e.jsx(l,{className:"px-4 py-4 text-left text-sm font-medium text-maintext",children:"Ngày cập nhật"}),e.jsx(l,{className:"px-4 py-4 text-right text-sm font-medium text-maintext",children:"Thao tác"})]})}),e.jsx(H,{children:Array.from({length:5}).map((s,r)=>e.jsxs(f,{children:[e.jsx(n,{className:"px-4 py-4",children:e.jsx("div",{className:"h-4 bg-gray-200 rounded animate-pulse"})}),e.jsx(n,{className:"px-4 py-4",children:e.jsx("div",{className:"h-8 w-8 bg-gray-200 rounded animate-pulse"})}),e.jsx(n,{className:"px-4 py-4",children:e.jsx("div",{className:"h-4 bg-gray-200 rounded animate-pulse"})}),e.jsx(n,{className:"px-4 py-4",children:e.jsx("div",{className:"h-6 w-16 bg-gray-200 rounded-full animate-pulse"})}),e.jsx(n,{className:"px-4 py-4",children:e.jsx("div",{className:"h-4 bg-gray-200 rounded animate-pulse"})}),e.jsx(n,{className:"px-4 py-4",children:e.jsx("div",{className:"h-8 w-8 bg-gray-200 rounded animate-pulse ml-auto"})})]},r))})]})})}):d?e.jsx("div",{className:"text-center py-8",children:e.jsx("p",{className:"text-red-500",children:"Đã xảy ra lỗi khi tải dữ liệu."})}):e.jsxs("div",{className:"bg-white rounded-[6px] shadow-sm overflow-visible",children:[e.jsx("div",{className:"p-4 border-b",children:e.jsx("div",{className:"flex flex-col sm:flex-row gap-4",children:e.jsx("div",{className:"flex-1",children:e.jsx($,{placeholder:"Tìm kiếm theo kích cỡ (XS, S, M, L, XL, XXL) hoặc giá trị số...",value:i,onChange:s=>m(s.target.value)})})})}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs(k,{children:[e.jsx(O,{children:e.jsxs(f,{children:[e.jsx(l,{className:"px-4 py-4 text-left text-sm font-medium text-maintext",children:"ID"}),e.jsx(l,{className:"px-4 py-4 text-left text-sm font-medium text-maintext",children:"Kích cỡ"}),e.jsx(l,{className:"px-4 py-4 text-left text-sm font-medium text-maintext",children:"Giá trị số"}),e.jsx(l,{className:"px-4 py-4 text-left text-sm font-medium text-maintext",children:"Trạng thái"}),e.jsx(l,{className:"px-4 py-4 text-left text-sm font-medium text-maintext",children:"Ngày cập nhật"}),e.jsx(l,{className:"px-4 py-4 text-right text-sm font-medium text-maintext",children:"Thao tác"})]})}),e.jsx(H,{children:p!=null&&p.length?p.map((s,r)=>e.jsxs(f,{className:"hover:bg-gray-50",children:[e.jsx(n,{className:"px-4 py-4 whitespace-nowrap text-sm text-maintext",children:s==null?void 0:s.id}),e.jsx(n,{className:"px-4 py-4 whitespace-nowrap",children:e.jsx("div",{className:"flex items-center",children:e.jsx("div",{className:"h-8 w-12 rounded-[6px] bg-primary/10 text-primary flex items-center justify-center border border-primary/20",children:e.jsx("span",{className:"text-sm font-bold",children:v(s.value)})})})}),e.jsx(n,{className:"px-4 py-4 whitespace-nowrap text-sm text-maintext",children:s.value}),e.jsx(n,{className:"px-4 py-4 whitespace-nowrap",children:e.jsx("span",{className:`px-2 py-1 text-xs rounded-full ${s.status==="HOAT_DONG"?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:s.status==="HOAT_DONG"?"Hoạt động":"Không hoạt động"})}),e.jsx(n,{className:"px-4 py-4 whitespace-nowrap text-sm text-maintext",children:a(s.updatedAt)}),e.jsx(n,{className:"px-4 py-4 whitespace-nowrap text-right",children:e.jsx("div",{className:"flex items-center justify-end space-x-2",children:e.jsx(ne,{size:s,onDelete:()=>{S(s==null?void 0:s.id)},isDeleting:g.isPending})})})]},(s==null?void 0:s.id)||`size-${r}`)):e.jsx(f,{children:e.jsx(n,{colSpan:6,className:"text-center py-8 text-maintext",children:"Không có kích cỡ nào được tìm thấy."})})})]})})]})]})}function ne({size:i,onDelete:m,isDeleting:c}){const[u,t]=h.useState(!1),x=()=>{m(),t(!1)};return e.jsxs(_,{open:u,onOpenChange:t,children:[e.jsx(E,{asChild:!0,children:e.jsx(j,{variant:"outline",size:"icon",disabled:c,title:"Xóa",children:e.jsx(X.Icon,{path:J,size:.7})})}),e.jsxs(V,{children:[e.jsx(F,{children:e.jsx(Q,{children:"Xác nhận xóa kích cỡ"})}),e.jsxs("p",{children:["Bạn có chắc chắn muốn xóa kích cỡ ",e.jsx("strong",{children:v(i.value)})," không?"]}),e.jsxs(q,{children:[e.jsx(Y,{asChild:!0,children:e.jsx(j,{variant:"outline",disabled:c,children:"Hủy"})}),e.jsx(j,{variant:"destructive",onClick:x,disabled:c,children:c?"Đang xóa...":"Xóa"})]})]})]})}function le({isOpen:i,onClose:m}){const c=P(),u=W(),[t,x]=h.useState({value:0,status:"HOAT_DONG"}),[d,g]=h.useState({value:""}),b=a=>{const s=ae(a);s!==null&&(x(r=>({...r,value:s})),d.value&&g(r=>({...r,value:""})))},N=a=>{x(s=>({...s,status:a}))},y=()=>{let a=!0;const s={...d};return t.value<=0&&(s.value="Vui lòng chọn kích cỡ",a=!1),g(s),a},p=async a=>{if(a.preventDefault(),!!y())try{await u.mutateAsync(t,{onSuccess:()=>{o.success("Thêm kích cỡ thành công"),c.invalidateQueries({queryKey:["sizes"]}),x({value:0,status:"HOAT_DONG"}),m()},onError:s=>{s.message==="Duplicate entry. This record already exists."?o.error("Thêm kích cỡ thất bại: Kích cỡ này đã tồn tại."):o.error("Thêm kích cỡ thất bại")}})}catch(s){console.error(s)}},S=()=>t.value>0?v(t.value):"";return e.jsxs(V,{className:"sm:max-w-4xl",children:[e.jsx(F,{children:e.jsx(Q,{children:"Thêm kích cỡ mới"})}),e.jsxs("form",{onSubmit:p,className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(T,{htmlFor:"create-size",children:"Kích cỡ"}),e.jsxs(L,{value:S(),onValueChange:b,children:[e.jsx(I,{id:"create-size",className:d.value?"border-red-500":"",children:e.jsx(A,{placeholder:"Chọn kích cỡ"})}),e.jsx(K,{children:te.map(a=>e.jsxs(D,{value:a.label,children:[a.label," (Giá trị: ",a.value,")"]},a.value))})]}),d.value&&e.jsx("p",{className:"text-red-500 text-sm",children:d.value})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(T,{htmlFor:"create-status",children:"Trạng thái"}),e.jsxs(L,{value:t.status,onValueChange:N,children:[e.jsx(I,{id:"create-status",children:e.jsx(A,{placeholder:"Chọn trạng thái"})}),e.jsxs(K,{children:[e.jsx(D,{value:"HOAT_DONG",children:"Hoạt động"}),e.jsx(D,{value:"KHONG_HOAT_DONG",children:"Không hoạt động"})]})]})]}),e.jsxs(q,{children:[e.jsx(j,{type:"button",variant:"outline",onClick:m,children:"Hủy"}),e.jsx(j,{type:"submit",disabled:u.isPending,children:u.isPending?"Đang xử lý...":"Thêm kích cỡ"})]})]})]})}const fe=()=>e.jsx(re,{});export{fe as default};
