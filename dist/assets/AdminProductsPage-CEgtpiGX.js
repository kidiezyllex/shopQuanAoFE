import{j as e}from"./ui-vendor-CFM_MCUz.js";import{r as t}from"./react-vendor-B55MjJUH.js";import{C as a,c as n}from"./card-ClEzRAeX.js";import{S as s}from"./skeleton-4G_X8bY4.js";import{t as i,a5 as o,ad as r,ae as l,aL as c,aM as d}from"./icons-vendor-BrsZP2ku.js";import{B as m,I as h,l as u,y as x}from"./index-BHeY-5EX.js";import{u as p,c as f}from"./product-BXJPBtky.js";import{u as g,a as v}from"./attributes-DYSh1UfM.js";import{u as j}from"./promotion-DDJnNtmQ.js";import{a as w,c as b}from"./promotions-CtwgNWvY.js";import{d as y}from"./query-vendor-CBwfxcof.js";import{B as N,a as M,b as k,c as z,d as C,e as S}from"./breadcrumb-CP4jYkI2.js";import{T as E,a as I,b as T,c as D,d as P,e as R}from"./table-DL-K3PV4.js";import{S as Z,a as O,b as F,c as H,d as X}from"./select-C6W71KWg.js";import{h as L,i as _,j as Y,k as A,l as V,n as W,o as K,p as G,I as U,q as $,r as q,s as B,t as Q,v as J,U as ee,x as te,y as ae,z as ne,D as se,F as ie,G as oe,H as re,J as le,K as ce,M as de,N as me,O as he,Q as ue,S as xe,V as pe,A as fe,m as ge,W as ve}from"./heavy-vendor-BfN2pHnQ.js";import{D as je,f as we,a as be,b as ye,c as Ne,e as Me,g as ke}from"./dialog-Va24CY58.js";const ze={maxZoomPixelRatio:1,zoomInMultiplier:2,doubleTapDelay:300,doubleClickDelay:500,doubleClickMaxStops:2,keyboardMoveDistance:50,wheelZoomDistanceFactor:100,pinchZoomDistanceFactor:100,scrollToZoom:!1},Ce=e=>({...ze,...e});function Se(){const{zoom:e}=W();return Ce(e)}function Ee(e,t){return((e.clientX-t.clientX)**2+(e.clientY-t.clientY)**2)**.5}function Ie(e,t,a=100,n=2){return e*Math.min(1+Math.abs(t/a),n)**Math.sign(t)}function Te(e,a,n){const[s,i]=t.useState(1),[o,r]=t.useState(0),[l,c]=t.useState(0),d=function(e,a,n,s){const i=t.useRef(void 0),o=t.useRef(void 0),{zoom:r}=W().animation,l=xe(),c=B((()=>{var t,c,d;if(null===(t=i.current)||void 0===t||t.cancel(),i.current=void 0,o.current&&(null==s?void 0:s.current)){try{i.current=null===(d=(c=s.current).animate)||void 0===d?void 0:d.call(c,[{transform:o.current},{transform:`scale(${e}) translateX(${a}px) translateY(${n}px)`}],{duration:l?0:null!=r?r:500,easing:i.current?"ease-out":"ease-in-out"})}catch(m){}o.current=void 0,i.current&&(i.current.onfinish=()=>{i.current=void 0})}}));return G(c,[e,a,n,c]),t.useCallback((()=>{o.current=(null==s?void 0:s.current)?window.getComputedStyle(s.current).transform:void 0}),[s])}(s,o,l,n),{currentSlide:m,globalIndex:h}=K(),{containerRect:u,slideRect:x}=J(),{zoomInMultiplier:p}=Se(),f=m&&_(m)?m.src:void 0,g=!f||!(null==n?void 0:n.current);G((()=>{i(1),r(0),c(0)}),[h,f]);const v=t.useCallback(((t,a,n)=>{const i=n||s,d=o-(t||0),m=l-(a||0),h=(e.width*i-x.width)/2/i,u=(e.height*i-x.height)/2/i;r(Math.min(Math.abs(d),Math.max(h,0))*Math.sign(d)),c(Math.min(Math.abs(m),Math.max(u,0))*Math.sign(m))}),[s,o,l,x,e.width,e.height]),j=t.useCallback(((e,t,n,o)=>{const r=le(Math.min(Math.max(e+.001<a?e:a,1),a),5);r!==s&&(t||d(),v(n?n*(1/s-1/r):0,o?o*(1/s-1/r):0,r),i(r))}),[s,a,v,d]),w=B((()=>{s>1&&(s>a&&j(a,!0),v())}));G(w,[u.width,u.height,w]);const b=t.useCallback((()=>j(s*p)),[s,p,j]),y=t.useCallback((()=>j(s/p)),[s,p,j]);return{zoom:s,offsetX:o,offsetY:l,disabled:g,changeOffsets:v,changeZoom:j,zoomIn:b,zoomOut:y}}const De=t.createContext(null),Pe=V("useZoom","ZoomControllerContext",De);function Re({children:e}){const[a,n]=t.useState(),{slideRect:s}=J(),{imageRect:i,maxZoom:o}=function(e,t){var a,n;let s={width:0,height:0},i={width:0,height:0};const{currentSlide:o}=K(),{imageFit:r}=W().carousel,{maxZoomPixelRatio:l}=Se();if(e&&o){const c={...o,...t};if(_(c)){const t=q(c,r),o=Math.max(...((null===(a=c.srcSet)||void 0===a?void 0:a.map((e=>e.width)))||[]).concat(c.width?[c.width]:[])),d=Math.max(...((null===(n=c.srcSet)||void 0===n?void 0:n.map((e=>e.height)))||[]).concat(c.height?[c.height]:[]));o>0&&d>0&&e.width>0&&e.height>0&&(i=t?{width:Math.round(Math.min(o,e.width/e.height*d)),height:Math.round(Math.min(d,e.height/e.width*o))}:{width:o,height:d},i={width:i.width*l,height:i.height*l},s=t?{width:Math.min(e.width,i.width,o),height:Math.min(e.height,i.height,d)}:{width:Math.round(Math.min(e.width,e.height/d*o,o)),height:Math.round(Math.min(e.height,e.width/o*d,d))})}}return{imageRect:s,maxZoom:s.width?Math.max(le(i.width/s.width,5),1):1}}(s,null==a?void 0:a.imageDimensions),{zoom:r,offsetX:l,offsetY:c,disabled:d,changeZoom:m,changeOffsets:h,zoomIn:u,zoomOut:x}=Te(i,o,null==a?void 0:a.zoomWrapperRef);!function(e,a){const{on:n}=W(),s=B((()=>{var t;a||null===(t=n.zoom)||void 0===t||t.call(n,{zoom:e})}));t.useEffect(s,[e,s])}(r,d),function(e,a,n,s,i,o){const r=t.useRef([]),l=t.useRef(0),c=t.useRef(void 0),{globalIndex:d}=K(),{getOwnerWindow:m}=ce(),{containerRef:h,subscribeSensors:u}=J(),{keyboardMoveDistance:x,zoomInMultiplier:p,wheelZoomDistanceFactor:f,scrollToZoom:g,doubleTapDelay:v,doubleClickDelay:j,doubleClickMaxStops:w,pinchZoomDistanceFactor:b}=Se(),y=t.useCallback((e=>{if(h.current){const{pageX:t,pageY:a}=e,{scrollX:n,scrollY:s}=m(),{left:i,top:o,width:r,height:l}=h.current.getBoundingClientRect();return[t-i-n-r/2,a-o-s-l/2]}return[]}),[h,m]),N=B((t=>{const{key:a,metaKey:n,ctrlKey:o}=t,r=n||o,l=()=>{t.preventDefault(),t.stopPropagation()};if(e>1){const e=(e,t)=>{l(),i(e,t)};"ArrowDown"===a?e(0,x):"ArrowUp"===a?e(0,-x):"ArrowLeft"===a?e(-x,0):"ArrowRight"===a&&e(x,0)}const c=e=>{l(),s(e)};"+"===a||r&&"="===a?c(e*p):"-"===a||r&&"_"===a?c(e/p):r&&"0"===a&&c(1)})),M=B((t=>{if((t.ctrlKey||g)&&Math.abs(t.deltaY)>Math.abs(t.deltaX))return t.stopPropagation(),void s(Ie(e,-t.deltaY,f),!0,...y(t));e>1&&(t.stopPropagation(),g||i(t.deltaX,t.deltaY))})),k=t.useCallback((e=>{const t=r.current;t.splice(0,t.length,...t.filter((t=>t.pointerId!==e.pointerId)))}),[]),z=t.useCallback((e=>{k(e),e.persist(),r.current.push(e)}),[k]),C=B((t=>{var n;const i=r.current;if("mouse"===t.pointerType&&t.buttons>1||!(null===(n=null==o?void 0:o.current)||void 0===n?void 0:n.contains(t.target)))return;e>1&&t.stopPropagation();const{timeStamp:d}=t;0===i.length&&d-l.current<("touch"===t.pointerType?v:j)?(l.current=0,s(e!==a?e*Math.max(a**(1/w),p):1,!1,...y(t))):l.current=d,z(t),2===i.length&&(c.current=Ee(i[0],i[1]))})),S=B((t=>{const a=r.current,n=a.find((e=>e.pointerId===t.pointerId));if(2===a.length&&c.current){t.stopPropagation(),z(t);const n=Ee(a[0],a[1]),i=n-c.current;Math.abs(i)>0&&(s(Ie(e,i,b),!0,...a.map((e=>y(e))).reduce(((e,t)=>t.map(((t,a)=>e[a]+t/2))))),c.current=n)}else e>1&&(t.stopPropagation(),n&&(1===a.length&&i((n.clientX-t.clientX)/e,(n.clientY-t.clientY)/e),z(t)))})),E=t.useCallback((e=>{const t=r.current;2===t.length&&t.find((t=>t.pointerId===e.pointerId))&&(c.current=void 0),k(e)}),[k]),I=t.useCallback((()=>{const e=r.current;e.splice(0,e.length),l.current=0,c.current=void 0}),[]);de(u,C,S,E,n),t.useEffect(I,[d,I]),t.useEffect((()=>n?()=>{}:me(I,u(ue,N),u(he,M))),[n,u,I,N,M])}(r,o,d,m,h,null==a?void 0:a.zoomWrapperRef);const p=t.useMemo((()=>({zoom:r,maxZoom:o,offsetX:l,offsetY:c,disabled:d,zoomIn:u,zoomOut:x,changeZoom:m})),[r,o,l,c,d,u,x,m]);t.useImperativeHandle(Se().ref,(()=>p),[p]);const f=t.useMemo((()=>({...p,setZoomWrapper:n})),[p,n]);return t.createElement(De.Provider,{value:f},e)}const Ze=ae("ZoomIn",t.createElement(t.Fragment,null,t.createElement("path",{d:"M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"}),t.createElement("path",{d:"M12 10h-2v2H9v-2H7V9h2V7h1v2h2v1z"}))),Oe=ae("ZoomOut",t.createElement("path",{d:"M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14zM7 9h5v1H7z"})),Fe=t.forwardRef((function({zoomIn:e,onLoseFocus:a},n){const s=t.useRef(!1),i=t.useRef(!1),{zoom:o,maxZoom:r,zoomIn:l,zoomOut:c,disabled:d}=Pe(),{render:m}=W(),h=d||(e?o>=r:o<=1);return t.useEffect((()=>{h&&s.current&&i.current&&a(),h||(s.current=!0)}),[h,a]),t.createElement(te,{ref:n,disabled:h,label:e?"Zoom in":"Zoom out",icon:e?Ze:Oe,renderIcon:e?m.iconZoomIn:m.iconZoomOut,onClick:e?l:c,onFocus:()=>{i.current=!0},onBlur:()=>{i.current=!1}})}));function He(){const e=t.useRef(null),a=t.useRef(null),{focus:n}=J(),s=t.useCallback((e=>{var t,a;(null===(t=e.current)||void 0===t?void 0:t.disabled)?n():null===(a=e.current)||void 0===a||a.focus()}),[n]),i=t.useCallback((()=>s(e)),[s]),o=t.useCallback((()=>s(a)),[s]);return t.createElement(t.Fragment,null,t.createElement(Fe,{zoomIn:!0,ref:e,onLoseFocus:o}),t.createElement(Fe,{ref:a,onLoseFocus:i}))}function Xe(){const{render:e}=W(),a=Pe();return e.buttonZoom?t.createElement(t.Fragment,null,e.buttonZoom(a)):t.createElement(He,null)}function Le({current:e,preload:t},{type:a,source:n}){switch(a){case"fetch":return e?{current:e,preload:n}:{current:n};case"done":return n===t?{current:n}:{current:e,preload:t};default:throw new Error(ee)}}function _e(e){var a,n;const[{current:s,preload:i},o]=t.useReducer(Le,{}),{slide:r,rect:l,imageFit:c,render:d,interactive:m}=e,h=r.srcSet.sort(((e,t)=>e.width-t.width)),u=null!==(a=r.width)&&void 0!==a?a:h[h.length-1].width,x=null!==(n=r.height)&&void 0!==n?n:h[h.length-1].height,p=q(r,c),f=Math.max(...h.map((e=>e.width))),g=Math.min((p?Math.max:Math.min)(l.width,u*(l.height/x)),f),v=Q(),j=B((()=>{var e;const t=null!==(e=h.find((e=>e.width>=g*v)))&&void 0!==e?e:h[h.length-1];(!s||h.findIndex((e=>e.src===s))<h.findIndex((e=>e===t)))&&o({type:"fetch",source:t.src})}));G(j,[l.width,l.height,v,j]);const w=B((e=>o({type:"done",source:e}))),b={WebkitTransform:m?"initial":"translateZ(0)"};return p||Object.assign(b,l.width/l.height<u/x?{width:"100%",height:"auto"}:{width:"auto",height:"100%"}),t.createElement(t.Fragment,null,i&&i!==s&&t.createElement(U,{key:"preload",...e,offset:void 0,slide:{...r,src:i,srcSet:void 0},style:{position:"absolute",visibility:"hidden",...b},onLoad:()=>w(i),render:{...d,iconLoading:()=>null,iconError:()=>null}}),s&&t.createElement(U,{key:"current",...e,slide:{...r,src:s,srcSet:void 0},style:b}))}function Ye({render:e,slide:a,offset:n,rect:s}){var i;const[o,r]=t.useState(),l=t.useRef(null),{zoom:c,maxZoom:d,offsetX:m,offsetY:h,setZoomWrapper:u}=Pe(),x=c>1,{carousel:p,on:f}=W(),{currentIndex:g}=K();G((()=>0===n?(u({zoomWrapperRef:l,imageDimensions:o}),()=>u(void 0)):()=>{}),[n,o,u]);let v=null===(i=e.slide)||void 0===i?void 0:i.call(e,{slide:a,offset:n,rect:s,zoom:c,maxZoom:d});if(!v&&_(a)){const i={slide:a,offset:n,rect:s,render:e,imageFit:p.imageFit,imageProps:p.imageProps,onClick:0===n?()=>{var e;return null===(e=f.click)||void 0===e?void 0:e.call(f,{index:g})}:void 0};v=function(e){var t;return((null===(t=e.srcSet)||void 0===t?void 0:t.length)||0)>0}(a)?t.createElement(_e,{...i,slide:a,interactive:x,rect:0===n?{width:s.width*c,height:s.height*c}:s}):t.createElement(U,{onLoad:e=>r({width:e.naturalWidth,height:e.naturalHeight}),...i})}return v?t.createElement("div",{ref:l,className:$(ne(re),ne(oe),ne(ie),x&&ne(se)),style:0===n?{transform:`scale(${c}) translateX(${m}px) translateY(${h}px)`}:void 0},v):null}const Ae=({augment:e,addModule:a})=>{e((({zoom:e,toolbar:a,render:n,controller:s,...i})=>{const o=Ce(e);return{zoom:o,toolbar:L(a,Y,t.createElement(Xe,null)),render:{...n,slide:e=>{var a;return _(e.slide)?t.createElement(Ye,{render:n,...e}):null===(a=n.slide)||void 0===a?void 0:a.call(n,e)}},controller:{...s,preventDefaultWheelY:o.scrollToZoom},...i}})),a(A(Y,Re))},Ve={download:void 0},We=e=>({...Ve,...e});function Ke(e){try{e.dispatchEvent(new MouseEvent("click"))}catch(t){const a=document.createEvent("MouseEvents");a.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),e.dispatchEvent(a)}}function Ge(e,t){const a=document.createElement("a");a.rel="noopener",a.download=t||"",a.download||(a.target="_blank"),"string"==typeof e?(a.href=e,a.origin!==window.location.origin?function(e){const t=new XMLHttpRequest;t.open("HEAD",e,!1);try{t.send()}catch(a){}return t.status>=200&&t.status<=299}(a.href)?function(e,t){const a=new XMLHttpRequest;a.open("GET",e),a.responseType="blob",a.onload=()=>{Ge(a.response,t)},a.onerror=()=>{},a.send()}(e,t):(a.target="_blank",Ke(a)):Ke(a)):(a.href=URL.createObjectURL(e),setTimeout((()=>URL.revokeObjectURL(a.href)),3e4),setTimeout((()=>Ke(a)),0))}const Ue=ae("DownloadIcon",t.createElement("path",{d:"M18 15v3H6v-3H4v3c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2v-3h-2zm-1-4-1.41-1.41L13 12.17V4h-2v8.17L8.41 9.59 7 11l5 5 5-5z"}));function $e(){const{render:e,on:a,download:n}=W(),{download:s}=We(n),{currentSlide:i,currentIndex:o}=K();if(e.buttonDownload)return t.createElement(t.Fragment,null,e.buttonDownload());const r=i&&(i.downloadUrl||"string"==typeof i.download&&i.download||"object"==typeof i.download&&i.download.url||_(i)&&i.src)||void 0,l=s?!1!==(null==i?void 0:i.download):Boolean(r),c=()=>{if(i&&r){const e=i.downloadFilename||"object"==typeof i.download&&i.download.filename||void 0;Ge(r,e)}};return t.createElement(te,{label:"Download",icon:Ue,renderIcon:e.iconDownload,disabled:!l,onClick:()=>{var e;i&&((s||c)({slide:i,saveAs:Ge}),null===(e=a.download)||void 0===e||e.call(a,{index:o}))}})}function qe({augment:e}){e((({toolbar:e,download:a,...n})=>({toolbar:L(e,pe,t.createElement($e,null)),download:We(a),...n})))}function Be(){const[L,_]=t.useState(""),[Y,A]=t.useState({page:1,limit:10}),{data:V}=j(),[W,K]=t.useState(!1),{data:G,isLoading:U,isError:$}=p(Y),q=f(),B=y(),[Q,J]=t.useState(!1),[ee,te]=t.useState(null),[ae,ne]=t.useState(!1),[se,ie]=t.useState([]),[oe,re]=t.useState(0),{data:le}=g(),{data:ce}=v(),de=t.useMemo((()=>{var e;if(!G||!G.data||!G.data.products)return G;let t=[...G.data.products];return(null==(e=null==V?void 0:V.data)?void 0:e.promotions)&&(t=w(t,V.data.promotions)),{...G,data:{...G.data,products:t}}}),[G,V]);t.useEffect((()=>{const e=setTimeout((()=>{if(L.trim())A((e=>({...e,name:L,page:1})));else{const{name:e,...t}=Y;A({...t,page:1})}}),500);return()=>clearTimeout(e)}),[L]);const me=(e,t)=>{if(""===t){const t={...Y};delete t[e],A({...t,page:1})}else A({...Y,[e]:t,page:1})},he=e=>{A({...Y,page:e})};return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsx(N,{children:e.jsxs(M,{children:[e.jsx(k,{children:e.jsx(z,{href:"#",children:"Dashboard"})}),e.jsx(C,{}),e.jsx(k,{children:e.jsx(z,{href:"/admin/products",children:"Quản lý sản phẩm"})}),e.jsx(C,{}),e.jsx(k,{children:e.jsx(S,{children:"Sản phẩm"})})]})}),e.jsx("a",{href:"/admin/products/create",children:e.jsxs(m,{children:[e.jsx(i.Icon,{path:o,size:.7}),"Thêm sản phẩm mới"]})})]}),e.jsx(a,{className:"mb-4",children:e.jsxs(n,{className:"py-4",children:[e.jsxs("div",{className:"flex flex-col space-y-4 md:space-y-0 md:flex-row md:justify-between md:items-center",children:[e.jsxs("div",{className:"relative flex-1 max-w-4xl",children:[e.jsx(i.Icon,{path:r,size:.7,className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-maintext"}),e.jsx(h,{type:"text",placeholder:"Tìm kiếm theo tên sản phẩm...",className:"pl-10 pr-4 py-2 w-full border rounded-[6px]",value:L,onChange:e=>_(e.target.value)})]}),e.jsxs(m,{variant:"outline",className:"flex items-center",onClick:()=>K(!W),children:[e.jsx(i.Icon,{path:l,size:.7,className:"mr-2"}),W?"Ẩn bộ lọc":"Hiện bộ lọc"]})]}),e.jsx(fe,{children:W&&e.jsx(ge.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},transition:{duration:.3},className:"mt-4 pt-4 border-t",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-maintext mb-2 font-semibold",children:"Thương hiệu"}),e.jsxs(Z,{value:Y.brand||"",onValueChange:e=>me("brand","all"===e?void 0:e),children:[e.jsx(O,{children:e.jsx(F,{placeholder:"Tất cả thương hiệu"})}),e.jsxs(H,{children:[e.jsx(X,{value:"all",children:"Tất cả thương hiệu"}),((null==le?void 0:le.data)||[]).map((t=>e.jsx(X,{value:t._id,children:t.name},t._id)))]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-maintext mb-2 font-semibold",children:"Danh mục"}),e.jsxs(Z,{value:Y.category||"",onValueChange:e=>me("category","all"===e?void 0:e),children:[e.jsx(O,{children:e.jsx(F,{placeholder:"Tất cả danh mục"})}),e.jsxs(H,{children:[e.jsx(X,{value:"all",children:"Tất cả danh mục"}),((null==ce?void 0:ce.data)||[]).map((t=>e.jsx(X,{value:t._id,children:t.name},t._id)))]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-maintext mb-2 font-semibold",children:"Trạng thái"}),e.jsxs(Z,{value:Y.status||"",onValueChange:e=>me("status","all"===e?void 0:e),children:[e.jsx(O,{children:e.jsx(F,{placeholder:"Tất cả trạng thái"})}),e.jsxs(H,{children:[e.jsx(X,{value:"all",children:"Tất cả trạng thái"}),e.jsx(X,{value:"HOAT_DONG",children:"Hoạt động"}),e.jsx(X,{value:"KHONG_HOAT_DONG",children:"Không hoạt động"})]})]})]})]})})})]})}),U?e.jsx("div",{className:"bg-white rounded-[6px] shadow-sm p-4 space-y-4",children:[...Array(5)].map(((t,a)=>e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx(s,{className:"h-12 w-12 rounded-[6px]"}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(s,{className:"h-4 w-[250px]"}),e.jsx(s,{className:"h-4 w-[200px]"})]})]},a)))}):$?e.jsxs("div",{className:"bg-white rounded-[6px] shadow-sm p-4 text-center",children:[e.jsx("p",{className:"text-red-500",children:"Đã xảy ra lỗi khi tải dữ liệu. Vui lòng thử lại sau."}),e.jsx(m,{variant:"outline",className:"mt-4",onClick:()=>B.invalidateQueries({queryKey:["products"]}),children:"Thử lại"})]}):e.jsxs("div",{className:"bg-white rounded-[6px] shadow-sm overflow-visible",children:[e.jsx("div",{className:"overflow-x-auto",style:{width:"100%",display:"block",overflowX:"auto",whiteSpace:"nowrap",scrollbarWidth:"thin",scrollbarColor:"#94a3b8 #e2e8f0",WebkitOverflowScrolling:"touch"},children:e.jsxs(E,{children:[e.jsx(I,{children:e.jsxs(T,{children:[e.jsx(D,{className:"px-4 py-4 text-left text-sm font-medium text-maintext",children:"Hình ảnh"}),e.jsx(D,{className:"px-4 py-4 text-left text-sm font-medium text-maintext",children:"Sản phẩm"}),e.jsx(D,{className:"px-4 py-4 text-left text-sm font-medium text-maintext",children:"Thương hiệu"}),e.jsx(D,{className:"px-4 py-4 text-left text-sm font-medium text-maintext",children:"Danh mục"}),e.jsx(D,{className:"px-4 py-4 text-left text-sm font-medium text-maintext",children:"Giá"}),e.jsx(D,{className:"px-4 py-4 text-left text-sm font-medium text-maintext",children:"Trạng thái"}),e.jsx(D,{className:"px-4 py-4 text-left text-sm font-medium text-maintext",children:"Ngày cập nhật"}),e.jsx(D,{className:"px-4 py-4 text-right text-sm font-medium text-maintext",children:"Thao tác"})]})}),e.jsx(P,{children:(null==de?void 0:de.data.products.length)?de.data.products.map((t=>{var a,n,s;return e.jsxs(T,{className:"hover:bg-gray-50",children:[e.jsx(R,{className:"px-4 py-4 whitespace-nowrap",children:e.jsx("div",{className:"relative h-12 w-12 rounded-[6px] overflow-hidden bg-gray-100 cursor-pointer group",onClick:()=>((e,t=0,a=0)=>{const n=e.variants.flatMap((t=>(t.images||[]).map((t=>({src:u(t),alt:e.name,download:u(t)})))));let s=0,i=0;for(let o=0;o<e.variants.length;o++){const n=e.variants[o].images||[];if(o===t){s=i+a;break}i+=n.length}ie(n),re(s),ne(!0)})(t,0,0),title:"Xem ảnh lớn",children:e.jsx("img",{src:u(null==(n=null==(a=t.variants[0])?void 0:a.images)?void 0:n[0]),alt:t.name,className:"object-cover group-hover:scale-105 transition-transform duration-200"})})}),e.jsxs(R,{className:"px-4 py-4 whitespace-nowrap",children:[e.jsx("div",{className:"text-sm font-medium text-maintext",children:t.name}),e.jsxs("div",{className:"text-xs text-maintext",children:[t.variants.length," biến thể"]})]}),e.jsx(R,{className:"px-4 py-4 whitespace-nowrap text-sm text-maintext",children:"string"==typeof t.brand?t.brand:t.brand.name}),e.jsx(R,{className:"px-4 py-4 whitespace-nowrap text-sm text-maintext",children:"string"==typeof t.category?t.category:t.category.name}),e.jsx(R,{className:"px-4 py-4 whitespace-nowrap text-sm",children:(()=>{var a,n;const s=(null==(a=t.variants[0])?void 0:a.price)||0,i=(null==(n=null==V?void 0:V.data)?void 0:n.promotions)?b(t._id,s,V.data.promotions):{originalPrice:s,discountedPrice:s,discountPercent:0};return e.jsxs("div",{className:"space-y-1",children:[e.jsx("div",{className:"font-medium "+(i.discountPercent>0?"text-primary":"text-maintext"),children:new Intl.NumberFormat("vi-VN",{style:"currency",currency:"VND"}).format(i.discountedPrice)}),i.discountPercent>0&&e.jsx("div",{className:"text-xs text-maintext line-through",children:new Intl.NumberFormat("vi-VN",{style:"currency",currency:"VND"}).format(i.originalPrice)}),i.discountPercent>0&&e.jsxs("div",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-green-100 text-green-800",children:["-",i.discountPercent,"% KM"]})]})})()}),e.jsx(R,{className:"px-4 py-4 whitespace-nowrap",children:e.jsx("span",{className:"px-2 py-1 text-xs rounded-full "+("HOAT_DONG"===t.status?"bg-green-100 text-green-800":"bg-red-100 text-red-800"),children:"HOAT_DONG"===t.status?"Hoạt động":"Không hoạt động"})}),e.jsx(R,{className:"px-4 py-4 whitespace-nowrap text-sm text-maintext",children:(s=t.updatedAt,new Intl.DateTimeFormat("vi-VN",{day:"2-digit",month:"2-digit",year:"numeric"}).format(new Date(s)))}),e.jsx(R,{className:"px-4 py-4 whitespace-nowrap text-right",children:e.jsxs("div",{className:"flex items-center justify-end space-x-2",children:[e.jsx("a",{href:`/admin/products/edit/${t._id}`,children:e.jsx(m,{variant:"outline",size:"icon",title:"Sửa",children:e.jsx(i.Icon,{path:c,size:.7})})}),e.jsxs(je,{open:Q&&ee===t._id,onOpenChange:e=>{e||(J(!1),te(null))},children:[e.jsx(we,{asChild:!0,children:e.jsx(m,{variant:"outline",size:"icon",onClick:()=>{te(t._id),J(!0)},title:"Xóa",children:e.jsx(i.Icon,{path:d,size:.7})})}),e.jsxs(be,{children:[e.jsx(ye,{children:e.jsx(Ne,{children:"Xác nhận xóa sản phẩm"})}),e.jsx("p",{children:"Bạn có chắc chắn muốn xóa sản phẩm này không?"}),e.jsxs(Me,{children:[e.jsx(ke,{asChild:!0,children:e.jsx(m,{variant:"outline",onClick:()=>{J(!1),te(null)},children:"Hủy"})}),e.jsx(m,{variant:"destructive",onClick:()=>{ee&&((async e=>{try{await q.mutateAsync(e,{onSuccess:()=>{x.success("Đã xóa sản phẩm thành công"),B.invalidateQueries({queryKey:["products"]})}})}catch(t){x.error("Xóa sản phẩm thất bại")}})(ee),J(!1),te(null))},children:"Xóa"})]})]})]})]})})]},t._id)})):e.jsx(T,{children:e.jsx(R,{colSpan:8,className:"px-4 py-8 text-center text-maintext",children:"Không tìm thấy sản phẩm nào"})})})]})}),(null==de?void 0:de.data.pagination)&&de.data.pagination.totalPages>1&&e.jsxs("div",{className:"px-4 py-3 flex items-center justify-between border-t border-gray-200",children:[e.jsx("div",{className:"hidden sm:block",children:e.jsxs("p",{className:"text-sm text-maintext",children:["Hiển thị ",e.jsx("span",{className:"font-medium",children:(de.data.pagination.currentPage-1)*de.data.pagination.limit+1})," đến ",e.jsx("span",{className:"font-medium",children:Math.min(de.data.pagination.currentPage*de.data.pagination.limit,de.data.pagination.totalItems)})," của ",e.jsx("span",{className:"font-medium",children:de.data.pagination.totalItems})," sản phẩm"]})}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx(m,{variant:"outline",size:"sm",onClick:()=>he(de.data.pagination.currentPage-1),disabled:1===de.data.pagination.currentPage,children:"Trước"}),[...Array(de.data.pagination.totalPages)].map(((t,a)=>e.jsx(m,{variant:de.data.pagination.currentPage===a+1?"default":"outline",size:"sm",onClick:()=>he(a+1),children:a+1},a))).slice(Math.max(0,de.data.pagination.currentPage-3),Math.min(de.data.pagination.totalPages,de.data.pagination.currentPage+2)),e.jsx(m,{variant:"outline",size:"sm",onClick:()=>he(de.data.pagination.currentPage+1),disabled:de.data.pagination.currentPage===de.data.pagination.totalPages,children:"Sau"})]})]})]}),ae&&e.jsx(ve,{open:ae,close:()=>ne(!1),slides:se,index:oe,on:{view:({index:e})=>re(e)},plugins:[Ae,qe],zoom:{maxZoomPixelRatio:3,zoomInMultiplier:2}})]})}const Qe=()=>e.jsx(Be,{});export{Qe as default};
