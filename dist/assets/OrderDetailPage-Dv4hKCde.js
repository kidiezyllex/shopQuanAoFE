import{j as e}from"./ui-vendor-CFM_MCUz.js";import{u as s,r as n}from"./react-vendor-B55MjJUH.js";import{u as r}from"./useAuth-CsiutREq.js";import{u as t}from"./useToast-DwJRzuOq.js";import{C as i,c as a,a as d,b as c}from"./card-ClEzRAeX.js";import{B as l}from"./badge-BeHegjHt.js";import{B as h}from"./index-BHeY-5EX.js";import{f as m}from"./utils-vendor-C6znz4jh.js";import{l as o}from"./index-DwIVA3Vd.js";import"./icons-vendor-BrsZP2ku.js";import"./query-vendor-CBwfxcof.js";import"./heavy-vendor-BfN2pHnQ.js";function x({params:x}){const j=s(),{user:u}=r(),{showToast:g}=t(),[p,f]=n.useState(null),[y,v]=n.useState(!0);n.useEffect((()=>{(async()=>{try{if(!(null==u?void 0:u.id))return void j("/login");const e=await fetch(`/api/orders/${x.id}`),s=await e.json();if(!s.success)throw new Error(s.message||"Không thể tải thông tin đơn hàng");f(s.data)}catch(e){g({title:"Lỗi",message:e.message||"Đã có lỗi xảy ra khi tải đơn hàng",type:"error"}),j("/orders")}finally{v(!1)}})()}),[x.id,u,router,g]);return y?e.jsx("div",{className:"container max-w-6xl py-8 flex items-center justify-center",children:e.jsx("div",{children:"Đang tải..."})}):p?e.jsxs("div",{className:"container max-w-6xl py-8",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsxs("h1",{className:"text-2xl font-bold",children:["Chi tiết đơn hàng #",p.id.slice(-6)]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(l,{className:`${(e=>{switch(e){case"pending":return"bg-yellow-500";case"processing":return"bg-blue-500";case"completed":return"bg-green-500";case"cancelled":return"bg-red-500";default:return"bg-gray-500"}})(p.status)} text-white`,children:(e=>{switch(e){case"pending":return"Chờ xác nhận";case"processing":return"Đang xử lý";case"completed":return"Hoàn thành";case"cancelled":return"Đã hủy";default:return e}})(p.status)}),"pending"===p.status&&e.jsx(h,{variant:"destructive",onClick:async()=>{try{const e=await fetch(`/api/orders/${x.id}/cancel`,{method:"PUT"}),s=await e.json();if(!s.success)throw new Error(s.message||"Không thể hủy đơn hàng");g({title:"Thành công",message:"Đã hủy đơn hàng thành công",type:"success"}),f((e=>e?{...e,status:"cancelled"}:null))}catch(e){g({title:"Lỗi",message:e.message||"Đã có lỗi xảy ra khi hủy đơn hàng",type:"error"})}},children:"Hủy đơn hàng"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs(i,{children:[e.jsx(d,{children:e.jsx(c,{children:"Thông tin giao hàng"})}),e.jsx(a,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium",children:"Người nhận"}),e.jsxs("p",{className:"text-muted-foreground mt-1",children:[p.shippingAddress.name,e.jsx("br",{}),p.shippingAddress.phoneNumber]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium",children:"Địa chỉ"}),e.jsxs("p",{className:"text-muted-foreground mt-1",children:[p.shippingAddress.specificAddress,e.jsx("br",{}),p.shippingAddress.wardId,", ",p.shippingAddress.districtId,e.jsx("br",{}),p.shippingAddress.provinceId]})]})]})})]}),e.jsxs(i,{children:[e.jsx(d,{children:e.jsx(c,{children:"Chi tiết thanh toán"})}),e.jsx(a,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium",children:"Phương thức thanh toán"}),e.jsx("p",{className:"text-muted-foreground mt-1",children:"COD"===p.paymentMethod?"Thanh toán khi nhận hàng":"VNPay"})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium",children:"Thời gian đặt hàng"}),e.jsx("p",{className:"text-muted-foreground mt-1",children:m(new Date(p.createdAt),"HH:mm - dd/MM/yyyy",{locale:o})})]}),e.jsxs("div",{className:"pt-4 border-t",children:[e.jsxs("div",{className:"flex justify-between mb-2",children:[e.jsx("span",{className:"text-muted-foreground",children:"Tạm tính"}),e.jsxs("span",{children:["$",p.subTotal.toFixed(2)]})]}),e.jsxs("div",{className:"flex justify-between font-medium text-lg",children:[e.jsx("span",{children:"Tổng cộng"}),e.jsxs("span",{children:["$",p.total.toFixed(2)]})]})]})]})})]})]}),e.jsxs(i,{className:"mt-6",children:[e.jsx(d,{children:e.jsx(c,{children:"Sản phẩm"})}),e.jsx(a,{children:e.jsx("div",{className:"space-y-4",children:p.items.map(((s,n)=>e.jsxs("div",{className:"flex items-center gap-4 py-4 border-b last:border-0",children:[e.jsx("div",{className:"w-20 h-20 bg-muted rounded relative overflow-hidden",children:e.jsx("img",{src:s.product.image,alt:s.product.name,className:"object-cover w-full h-full"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"font-medium",children:s.product.name}),e.jsxs("div",{className:"flex justify-between mt-2 text-muted-foreground",children:[e.jsxs("span",{children:["Số lượng: ",s.quantity]}),e.jsxs("span",{children:["$",s.price.toFixed(2)]})]})]})]},n)))})})]})]}):e.jsx("div",{className:"container max-w-6xl py-8",children:e.jsx(i,{children:e.jsx(a,{className:"py-8",children:e.jsx("div",{className:"text-center text-muted-foreground",children:"Không tìm thấy đơn hàng"})})})})}const j=()=>e.jsx(x,{});export{j as default};
