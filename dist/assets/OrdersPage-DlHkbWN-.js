import{U as p,a as r,j as e}from"./index-Dpx_4rWJ.js";import{u as j}from"./useAuth-Doo4_xAC.js";import{u as f}from"./useToast-DwXsNIYN.js";import{C as l,c as h,a as N,b as v,d as y}from"./card-fT6uSY2F.js";import{B as b}from"./badge-CA2Kv9aL.js";import{f as w,l as C}from"./index-VIuxkY8Z.js";import"./typeof-QjJsDpFa.js";const k=()=>{const i=p(),{user:a}=j(),{showToast:c}=f(),[d,o]=r.useState([]),[m,x]=r.useState(!0);r.useEffect(()=>{(async()=>{try{if(!(a!=null&&a.id)){i("/login");return}const n=await(await fetch(`/api/orders?customer=${a.id}`)).json();if(n.success)o(n.data);else throw new Error(n.message||"Không thể tải danh sách đơn hàng")}catch(t){c({title:"Lỗi",message:t.message||"Đã có lỗi xảy ra khi tải đơn hàng",type:"error"})}finally{x(!1)}})()},[a,i,c]);const u=s=>{switch(s){case"pending":return"bg-yellow-500";case"processing":return"bg-blue-500";case"completed":return"bg-green-500";case"cancelled":return"bg-red-500";default:return"bg-gray-500"}},g=s=>{switch(s){case"pending":return"Chờ xác nhận";case"processing":return"Đang xử lý";case"completed":return"Hoàn thành";case"cancelled":return"Đã hủy";default:return s}};return m?e.jsx("div",{className:"container max-w-6xl py-8 flex items-center justify-center",children:e.jsx("div",{children:"Đang tải..."})}):e.jsxs("div",{className:"container max-w-6xl py-8",children:[e.jsx("h1",{className:"text-2xl font-bold mb-4",children:"Đơn hàng của tôi"}),d.length===0?e.jsx(l,{children:e.jsx(h,{className:"py-8",children:e.jsx("div",{className:"text-center text-muted-foreground",children:"Bạn chưa có đơn hàng nào"})})}):e.jsx("div",{className:"space-y-4",children:d.map(s=>e.jsxs(l,{className:"cursor-pointer hover:shadow-md transition-shadow",onClick:()=>i(`/orders/${s.id}`),children:[e.jsx(N,{className:"pb-4",children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsxs(v,{className:"text-lg",children:["Đơn hàng #",s.id.slice(-6)]}),e.jsx(y,{children:w(new Date(s.createdAt),"dd/MM/yyyy HH:mm",{locale:C})})]}),e.jsx(b,{className:`${u(s.status)} text-white`,children:g(s.status)})]})}),e.jsx(h,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium mb-2",children:"Thông tin giao hàng"}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:[s.shippingAddress.name,e.jsx("br",{}),s.shippingAddress.phoneNumber,e.jsx("br",{}),s.shippingAddress.specificAddress]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium mb-2",children:"Chi tiết thanh toán"}),e.jsxs("div",{className:"text-sm text-muted-foreground",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Phương thức:"}),e.jsx("span",{children:s.paymentMethod==="COD"?"Thanh toán khi nhận hàng":"VNPay"})]}),e.jsxs("div",{className:"flex justify-between font-medium mt-2",children:[e.jsx("span",{children:"Tổng tiền:"}),e.jsxs("span",{children:["$",s.total.toFixed(2)]})]})]})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium mb-2",children:"Sản phẩm"}),e.jsx("div",{className:"space-y-2",children:s.items.map((t,n)=>e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-16 h-16 bg-muted rounded relative overflow-hidden",children:e.jsx("img",{src:t.product.image,alt:t.product.name,className:"object-cover w-full h-full"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"font-medium",children:t.product.name}),e.jsxs("div",{className:"flex justify-between mt-1 text-sm text-muted-foreground",children:[e.jsxs("span",{children:["x",t.quantity]}),e.jsxs("span",{children:["$",t.price.toFixed(2)]})]})]})]},n))})]})]})})]},s.id))})]})};export{k as default};
