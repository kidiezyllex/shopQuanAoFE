import{j as e}from"./ui-vendor-CFM_MCUz.js";import{r as s,u as a}from"./react-vendor-B55MjJUH.js";import{u as r,a as n,F as i,b as t,c as l,d as c,e as d,f as h}from"./form-DeJYl1uA.js";import{n as m,o,p as x,q as j,B as p,I as u,y as N,u as g,h as f,A as y,b,c as v}from"./index-BHeY-5EX.js";import{C as k,a as w,b as C,c as T,e as S,d as z}from"./card-ClEzRAeX.js";import{ac as D,aq as H,t as P,N as I,ar as V,x as A,E as X,as as E,at as B,ao as F,au as q,V as Q,av as M,f as _}from"./icons-vendor-BrsZP2ku.js";import{T as L,b as O,c as U,a as G}from"./tabs-z4DSy6tE.js";import{T as J}from"./textarea-DHkaMSo6.js";import{D as K,f as R,a as W,b as Y,c as Z,d as $,e as ee}from"./dialog-Va24CY58.js";import{S as se}from"./scroll-area-CfH0A0Iz.js";import{S as ae,a as re,b as ne,c as ie,d as te}from"./select-C6W71KWg.js";import{A as le,m as ce}from"./heavy-vendor-BfN2pHnQ.js";import{o as de,b as he,s as me}from"./utils-vendor-C6znz4jh.js";import"./label-Bm9nFuXD.js";import"./query-vendor-CBwfxcof.js";const oe=de({addressName:me().min(1,"Tên địa chỉ không được để trống"),fullName:me().min(3,"Tên người nhận phải có ít nhất 3 ký tự"),phoneNumber:me().min(10,"Số điện thoại phải có ít nhất 10 số"),province:me().min(1,"Tỉnh/Thành phố không được để trống"),district:me().min(1,"Quận/Huyện không được để trống"),ward:me().min(1,"Phường/Xã không được để trống"),addressDetail:me().min(5,"Địa chỉ chi tiết phải có ít nhất 5 ký tự"),isDefault:he().optional()});function xe(){const{data:a,isLoading:g,refetch:f}=m(),y=o(),b=x(),v=j(),[z,Q]=s.useState([]),[M,_]=s.useState(!1),[L,O]=s.useState(null),[U,G]=s.useState(!1),[de,he]=s.useState(null),[me,xe]=s.useState(!1),je=r({resolver:n(oe),defaultValues:{addressName:"",fullName:"",phoneNumber:"",province:"",district:"",ward:"",addressDetail:"",isDefault:!1}});s.useEffect((()=>{a&&a.data&&a.data.addresses&&Q(a.data.addresses)}),[a]);const pe=()=>{je.reset({addressName:"",fullName:"",phoneNumber:"",province:"",district:"",ward:"",addressDetail:"",isDefault:!1}),_(!1),O(null)};return g?e.jsx("div",{className:"flex justify-center items-center h-64",children:e.jsx(D,{className:"w-8 h-8 animate-spin text-primary"})}):e.jsxs("div",{className:"space-y-4",children:[e.jsxs(K,{open:U,onOpenChange:G,children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h2",{className:"text-xl font-medium",children:"Địa chỉ của tôi"}),e.jsx(R,{asChild:!0,children:e.jsxs(p,{className:"bg-primary hover:bg-secondary transition-all duration-300 flex items-center gap-2",onClick:pe,children:[e.jsx(H,{size:16}),"Thêm địa chỉ mới"]})})]}),0===z.length?e.jsxs("div",{className:"flex flex-col items-center justify-center p-12 border border-dashed border-gray-300 dark:border-gray-700 rounded-[6px]",children:[e.jsx(P.Icon,{path:I,size:3,className:"text-maintext mb-4"}),e.jsx("p",{className:"text-maintext dark:text-maintext mb-4",children:"Bạn chưa có địa chỉ nào"}),e.jsx(R,{asChild:!0,children:e.jsx(p,{className:"bg-primary hover:bg-secondary transition-all duration-300",onClick:pe,children:"Thêm địa chỉ mới"})})]}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:e.jsx(le,{children:z.map((s=>e.jsx(ce.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0,x:-10},transition:{duration:.2},children:e.jsxs(k,{className:"overflow-hidden "+(s.isDefault?"border-primary":"border-gray-200 dark:border-gray-700"),children:[e.jsxs(w,{className:"p-4 pb-2 flex flex-row justify-between items-start space-y-0",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(P.Icon,{path:V,size:.7,className:"text-primary"}),e.jsx(C,{className:"text-base font-medium",children:s.addressName})]}),e.jsx("div",{className:"flex items-center gap-1",children:s.isDefault?e.jsxs("div",{className:"flex items-center text-xs text-primary bg-primary/10 px-2 py-1 rounded",children:[e.jsx(P.Icon,{path:A,size:.7,className:"mr-1"}),"Mặc định"]}):e.jsxs(p,{variant:"ghost",size:"sm",className:"h-8 px-2 text-xs text-maintext hover:text-primary",children:[e.jsx(P.Icon,{path:X,size:.7,className:"mr-1"}),"Đặt mặc định"]})})]}),e.jsx(T,{className:"p-4 pt-2",children:e.jsxs("div",{className:"text-sm space-y-1",children:[e.jsxs("p",{className:"font-medium",children:[s.fullName," | ",s.phoneNumber]}),e.jsxs("p",{className:"text-maintext dark:text-maintext",children:[s.addressDetail,", ",s.ward,", ",s.district,", ",s.province]})]})}),e.jsxs(S,{className:"p-4 pt-2 flex justify-end gap-2",children:[e.jsxs(p,{variant:"outline",size:"sm",className:"h-8 px-3 border-gray-300 hover:border-red-500 hover:text-red-500",onClick:()=>he(s._id),children:[e.jsx(E,{size:14,className:"mr-1"}),"Xóa"]}),e.jsxs(p,{variant:"outline",size:"sm",className:"h-8 px-3 border-gray-300 hover:border-primary hover:text-primary",onClick:()=>(e=>{_(!0),O(e._id),je.reset({addressName:e.addressName,fullName:e.fullName,phoneNumber:e.phoneNumber,province:e.province,district:e.district,ward:e.ward,addressDetail:e.addressDetail,isDefault:e.isDefault}),G(!0)})(s),children:[e.jsx(B,{size:14,className:"mr-1"}),"Sửa"]})]})]})},s._id)))})}),e.jsxs(W,{className:"max-w-2xl",children:[e.jsxs(Y,{children:[e.jsx(Z,{children:M?"Chỉnh sửa địa chỉ":"Thêm địa chỉ mới"}),e.jsx($,{children:M?"Cập nhật thông tin địa chỉ của bạn":"Điền đầy đủ thông tin để thêm địa chỉ mới"})]}),e.jsx(se,{className:"max-h-[70vh]",children:e.jsx("div",{className:"p-1",children:e.jsx(i,{...je,children:e.jsxs("form",{onSubmit:je.handleSubmit((async e=>{try{M&&L?(await b.mutateAsync({addressId:L,data:e}),N.success("Cập nhật thành công")):(await y.mutateAsync(e),N.success("Thêm mới thành công")),G(!1),pe(),f()}catch(s){N.error(M?"Cập nhật thất bại":"Thêm mới thất bại")}})),className:"space-y-4",children:[e.jsx(t,{control:je.control,name:"addressName",render:({field:s})=>e.jsxs(l,{children:[e.jsx(c,{children:"Tên địa chỉ"}),e.jsx(d,{children:e.jsx(u,{placeholder:"Ví dụ: Nhà riêng, Văn phòng...",...s})}),e.jsx(h,{})]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx(t,{control:je.control,name:"fullName",render:({field:s})=>e.jsxs(l,{children:[e.jsx(c,{children:"Họ tên người nhận"}),e.jsx(d,{children:e.jsx(u,{placeholder:"Nhập họ tên người nhận",...s})}),e.jsx(h,{})]})}),e.jsx(t,{control:je.control,name:"phoneNumber",render:({field:s})=>e.jsxs(l,{children:[e.jsx(c,{children:"Số điện thoại"}),e.jsx(d,{children:e.jsx(u,{placeholder:"Nhập số điện thoại",...s})}),e.jsx(h,{})]})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsx(t,{control:je.control,name:"province",render:({field:s})=>e.jsxs(l,{children:[e.jsx(c,{children:"Tỉnh/Thành phố"}),e.jsxs(ae,{onValueChange:s.onChange,defaultValue:s.value,children:[e.jsx(d,{children:e.jsx(re,{children:e.jsx(ne,{placeholder:"Chọn tỉnh/thành phố"})})}),e.jsxs(ie,{children:[e.jsx(te,{value:"Hà Nội",children:"Hà Nội"}),e.jsx(te,{value:"TP. Hồ Chí Minh",children:"TP. Hồ Chí Minh"}),e.jsx(te,{value:"Đà Nẵng",children:"Đà Nẵng"}),e.jsx(te,{value:"Hải Phòng",children:"Hải Phòng"}),e.jsx(te,{value:"Cần Thơ",children:"Cần Thơ"})]})]}),e.jsx(h,{})]})}),e.jsx(t,{control:je.control,name:"district",render:({field:s})=>e.jsxs(l,{children:[e.jsx(c,{children:"Quận/Huyện"}),e.jsx(d,{children:e.jsx(u,{placeholder:"Nhập quận/huyện",...s})}),e.jsx(h,{})]})}),e.jsx(t,{control:je.control,name:"ward",render:({field:s})=>e.jsxs(l,{children:[e.jsx(c,{children:"Phường/Xã"}),e.jsx(d,{children:e.jsx(u,{placeholder:"Nhập phường/xã",...s})}),e.jsx(h,{})]})})]}),e.jsx(t,{control:je.control,name:"addressDetail",render:({field:s})=>e.jsxs(l,{children:[e.jsx(c,{children:"Địa chỉ chi tiết"}),e.jsx(d,{children:e.jsx(J,{placeholder:"Số nhà, tên đường...",...s,className:"min-h-[80px]"})}),e.jsx(h,{})]})}),e.jsx(t,{control:je.control,name:"isDefault",render:({field:s})=>e.jsxs(l,{className:"flex flex-row items-center space-x-4 space-y-0 rounded-[6px] border p-4",children:[e.jsx(d,{children:e.jsx(u,{type:"checkbox",checked:s.value,onChange:s.onChange,className:"h-4 w-4 text-primary focus:ring-primary border-gray-300 rounded"})}),e.jsxs("div",{className:"space-y-1 leading-none",children:[e.jsx(c,{className:"cursor-pointer",children:"Đặt làm địa chỉ mặc định"}),e.jsx("p",{className:"text-sm text-maintext dark:text-maintext",children:"Địa chỉ này sẽ được sử dụng mặc định khi mua hàng"})]})]})}),e.jsxs(ee,{className:"mt-6",children:[e.jsx(p,{type:"button",variant:"outline",onClick:()=>G(!1),children:"Hủy"}),e.jsx(p,{type:"submit",className:"bg-primary hover:bg-secondary",disabled:y.isPending||b.isPending,children:y.isPending||b.isPending?e.jsxs(e.Fragment,{children:[e.jsx(D,{className:"w-4 h-4 mr-2 animate-spin"}),"Đang xử lý..."]}):M?"Cập nhật":"Thêm mới"})]})]})})})})]})]}),e.jsx(K,{open:!!de,onOpenChange:e=>!e&&he(null),children:e.jsxs(W,{className:"max-w-4xl",children:[e.jsxs(Y,{children:[e.jsx(Z,{className:"text-center",children:"Xác nhận xóa địa chỉ"}),e.jsx($,{className:"text-center",children:"Bạn có chắc chắn muốn xóa địa chỉ này? Hành động này không thể hoàn tác."})]}),e.jsxs("div",{className:"flex justify-center gap-4 mt-4",children:[e.jsxs(p,{variant:"outline",onClick:()=>he(null),disabled:me,className:"w-32",children:[e.jsx(F,{size:16,className:"mr-2"}),"Hủy"]}),e.jsx(p,{variant:"destructive",onClick:async()=>{if(de){xe(!0);try{await v.mutateAsync(de),N.success("Xóa thành công"),he(null),f()}catch(e){N.error("Xóa thất bại")}finally{xe(!1)}}},disabled:me,className:"w-32",children:me?e.jsxs(e.Fragment,{children:[e.jsx(D,{className:"w-4 h-4 mr-2 animate-spin"}),"Đang xóa..."]}):e.jsxs(e.Fragment,{children:[e.jsx(q,{size:16,className:"mr-2"}),"Xác nhận"]})})]})]})})]})}const je=de({fullName:me().min(3,"Tên đầy đủ phải có ít nhất 3 ký tự"),email:me().email("Email không hợp lệ").min(1,"Email không được để trống"),phoneNumber:me().optional(),avatar:me().optional()});function pe(){var a,o;const{data:x,isLoading:j,refetch:k}=m(),w=f(),{updateUserProfile:C}=g(),T=r({resolver:n(je),defaultValues:{fullName:"",email:"",phoneNumber:"",avatar:""}});s.useEffect((()=>{x&&x.data&&T.reset({fullName:x.data.fullName||"",email:x.data.email||"",phoneNumber:x.data.phoneNumber||"",avatar:x.data.avatar||""})}),[x,T]);return j?e.jsx("div",{className:"flex justify-center items-center h-64",children:e.jsx(D,{className:"w-8 h-8 animate-spin text-primary"})}):e.jsx(i,{...T,children:e.jsxs("form",{onSubmit:T.handleSubmit((async e=>{try{await w.mutateAsync(e),N.success("Cập nhật thành công"),k()}catch(s){N.error("Cập nhật thất bại")}})),className:"space-y-5",children:[e.jsx("div",{className:"flex justify-center mb-4",children:e.jsxs(y,{className:"w-24 h-24 border-4 border-primary/20",children:[e.jsx(b,{src:T.getValues("avatar")||void 0,alt:"Avatar"}),e.jsx(v,{className:"bg-primary/10 text-primary text-2xl",children:(null==(o=null==(a=T.getValues("fullName"))?void 0:a.charAt(0))?void 0:o.toUpperCase())||e.jsx(P.Icon,{path:_,size:1.5})})]})}),e.jsx(t,{control:T.control,name:"fullName",render:({field:s})=>e.jsxs(l,{children:[e.jsx(c,{className:"text-maintext dark:text-gray-300 font-medium",children:"Họ và tên"}),e.jsx(d,{children:e.jsx(u,{type:"text",placeholder:"Nhập họ và tên của bạn",...s,className:"border-gray-300 dark:border-gray-700 focus-visible:ring-primary focus-visible:border-primary transition-all duration-300"})}),e.jsx(h,{})]})}),e.jsx(t,{control:T.control,name:"email",render:({field:s})=>e.jsxs(l,{children:[e.jsx(c,{className:"text-maintext dark:text-gray-300 font-medium",children:"Email"}),e.jsx(d,{children:e.jsx(u,{type:"email",placeholder:"Nhập email của bạn",...s,disabled:!0,className:"border-gray-300 dark:border-gray-700 opacity-70 cursor-not-allowed"})}),e.jsx(h,{})]})}),e.jsx(t,{control:T.control,name:"phoneNumber",render:({field:s})=>e.jsxs(l,{children:[e.jsx(c,{className:"text-maintext dark:text-gray-300 font-medium",children:"Số điện thoại"}),e.jsx(d,{children:e.jsx(u,{type:"tel",placeholder:"Nhập số điện thoại của bạn",...s,className:"border-gray-300 dark:border-gray-700 focus-visible:ring-primary focus-visible:border-primary transition-all duration-300"})}),e.jsx(h,{})]})}),e.jsx("div",{className:"pt-4",children:e.jsx(p,{type:"submit",className:"bg-primary hover:bg-secondary transition-all duration-300 text-base font-semibold w-full py-4",disabled:w.isPending,children:w.isPending?e.jsxs(e.Fragment,{children:[e.jsx(D,{className:"w-5 h-5 mr-2 animate-spin"}),"Đang cập nhật..."]}):"Cập nhật thông tin"})})]})})}const ue=()=>{const r=a(),{profile:n,isAuthenticated:i}=g();return s.useEffect((()=>{i||r("/auth/login")}),[i,r]),i?e.jsx("div",{className:"container max-w-4xl mx-auto px-4 py-12",children:e.jsxs(ce.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},children:[e.jsxs("div",{className:"mb-8 flex flex-col items-center text-center",children:[e.jsx("h1",{className:"text-3xl font-bold text-maintext dark:text-white mb-2",children:"Hồ sơ tài khoản"}),e.jsx("p",{className:"text-maintext dark:text-maintext max-w-2xl",children:"Quản lý thông tin cá nhân, địa chỉ và thay đổi mật khẩu của bạn"})]}),e.jsxs(L,{defaultValue:"profile",className:"w-full",children:[e.jsxs(O,{className:"grid w-full grid-cols-3 mb-8",children:[e.jsxs(U,{value:"profile",className:"flex items-center gap-2",children:[e.jsx(P.Icon,{path:Q,size:.7})," Thông tin cá nhân"]}),e.jsxs(U,{value:"addresses",className:"flex items-center gap-2",children:[e.jsx(P.Icon,{path:I,size:.7})," Sổ địa chỉ"]}),e.jsxs(U,{value:"security",className:"flex items-center gap-2",children:[e.jsx(P.Icon,{path:M,size:.7})," Bảo mật"]})]}),e.jsx(G,{value:"profile",children:e.jsxs(k,{className:"border border-gray-200 dark:border-gray-700 shadow-sm",children:[e.jsxs(w,{children:[e.jsx(C,{children:"Thông tin cá nhân"}),e.jsx(z,{children:"Cập nhật thông tin cá nhân của bạn tại đây"})]}),e.jsx(T,{children:e.jsx(pe,{})})]})}),e.jsx(G,{value:"addresses",children:e.jsxs(k,{className:"border border-gray-200 dark:border-gray-700 shadow-sm",children:[e.jsxs(w,{children:[e.jsx(C,{children:"Sổ địa chỉ"}),e.jsx(z,{children:"Quản lý danh sách địa chỉ nhận hàng của bạn"})]}),e.jsx(T,{children:e.jsx(xe,{})})]})}),e.jsx(G,{value:"security",children:e.jsxs(k,{className:"border border-gray-200 dark:border-gray-700 shadow-sm",children:[e.jsxs(w,{children:[e.jsx(C,{children:"Bảo mật tài khoản"}),e.jsx(z,{children:"Cập nhật mật khẩu để bảo vệ tài khoản của bạn"})]}),e.jsx(T,{children:e.jsxs("div",{className:"flex flex-col items-center justify-center py-8",children:[e.jsx(P.Icon,{path:M,size:3,className:"text-primary mb-4 opacity-80"}),e.jsx("h3",{className:"text-xl font-medium mb-2",children:"Thay đổi mật khẩu tài khoản"}),e.jsx("p",{className:"text-maintext dark:text-maintext text-center mb-4 max-w-4xl",children:"Cập nhật mật khẩu mới để bảo vệ tài khoản của bạn khỏi các truy cập trái phép"}),e.jsx("a",{href:"/profile/change-password",className:"bg-primary hover:bg-secondary transition-all duration-300",children:e.jsx(p,{className:"bg-primary hover:bg-secondary transition-all duration-300",children:"Đổi mật khẩu"})})]})})]})})]})]})}):null};export{ue as default};
