import{aC as K,aD as le,aE as ce,aF as de,a as x,j as e,B as t,k as j,x as R,A as he,m as W,aG as oe,c as me,n as xe,q as p,a6 as N,U as pe,E as Y,W as je,aH as _,$ as ue,J as ge,K as ye,L as Ne,F as fe}from"./index-Dpx_4rWJ.js";import{u as Z,a as ee,F as se,b as i,c as l,d as c,e as d,f as m,o as ae,h as be,s as h}from"./form-BFysSGgk.js";import{C as A,a as P,b as I,c as F,e as ve,d as E}from"./card-fT6uSY2F.js";import{T as ke,b as Ce,c as V,a as L}from"./tabs-BXj1bKUw.js";import{T as we}from"./textarea-D-7Bay0_.js";import{D as O,h as Q,a as $,b as q,c as G,d as J,e as Te,X as De}from"./dialog-BuHyDe_9.js";import{S as Se}from"./scroll-area-jH8Oe1ZO.js";import{S as Ae,a as Pe,b as Ie,c as Fe,d as f}from"./select-CS4vNzI5.js";import{L as b}from"./loader-circle-C0q4c54s.js";import{c as U}from"./createLucideIcon-BdgKQErZ.js";import{C as ze}from"./check-CyKb8IHM.js";import"./label-B0XdI4bT.js";import"./index-BdQq_4o_.js";import"./index-qvEK80KO.js";/**
 * @license lucide-react v0.483.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const He=[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]],Me=U("Pencil",He);/**
 * @license lucide-react v0.483.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ee=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],Ve=U("Plus",Ee);/**
 * @license lucide-react v0.483.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Le=[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]],Ue=U("Trash2",Le),Xe=ae({addressName:h().min(1,"Tên địa chỉ không được để trống"),fullName:h().min(3,"Tên người nhận phải có ít nhất 3 ký tự"),phoneNumber:h().min(10,"Số điện thoại phải có ít nhất 10 số"),province:h().min(1,"Tỉnh/Thành phố không được để trống"),district:h().min(1,"Quận/Huyện không được để trống"),ward:h().min(1,"Phường/Xã không được để trống"),addressDetail:h().min(5,"Địa chỉ chi tiết phải có ít nhất 5 ký tự"),isDefault:be().optional()});function Be(){const{data:a,isLoading:v,refetch:u}=K(),y=le(),k=ce(),n=de(),[C,w]=x.useState([]),[g,o]=x.useState(!1),[T,X]=x.useState(null),[re,D]=x.useState(!1),[z,S]=x.useState(null),[H,B]=x.useState(!1),r=Z({resolver:ee(Xe),defaultValues:{addressName:"",fullName:"",phoneNumber:"",province:"",district:"",ward:"",addressDetail:"",isDefault:!1}});x.useEffect(()=>{a&&a.data&&a.data.addresses&&w(a.data.addresses)},[a]);const M=()=>{r.reset({addressName:"",fullName:"",phoneNumber:"",province:"",district:"",ward:"",addressDetail:"",isDefault:!1}),o(!1),X(null)},ne=s=>{o(!0),X(s.id),r.reset({addressName:s.addressName,fullName:s.fullName,phoneNumber:s.phoneNumber,province:s.province,district:s.district,ward:s.ward,addressDetail:s.addressDetail,isDefault:s.isDefault}),D(!0)},te=async()=>{if(z){B(!0);try{await n.mutateAsync(z),N.success("Xóa thành công"),S(null),u()}catch{N.error("Xóa thất bại")}finally{B(!1)}}},ie=async s=>{try{g&&T?(await k.mutateAsync({addressId:T,data:s}),N.success("Cập nhật thành công")):(await y.mutateAsync(s),N.success("Thêm mới thành công")),D(!1),M(),u()}catch{N.error(g?"Cập nhật thất bại":"Thêm mới thất bại")}};return v?e.jsx("div",{className:"flex justify-center items-center h-64",children:e.jsx(b,{className:"w-8 h-8 animate-spin text-primary"})}):e.jsxs("div",{className:"space-y-4",children:[e.jsxs(O,{open:re,onOpenChange:D,children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h2",{className:"text-xl font-medium",children:"Địa chỉ của tôi"}),e.jsx(Q,{asChild:!0,children:e.jsxs(t,{className:"bg-primary hover:bg-secondary transition-all duration-300 flex items-center gap-2",onClick:M,children:[e.jsx(Ve,{size:16}),"Thêm địa chỉ mới"]})})]}),C.length===0?e.jsxs("div",{className:"flex flex-col items-center justify-center p-12 border border-dashed border-gray-300 dark:border-gray-700 rounded-[6px]",children:[e.jsx(j.Icon,{path:R,size:3,className:"text-maintext mb-4"}),e.jsx("p",{className:"text-maintext dark:text-maintext mb-4",children:"Bạn chưa có địa chỉ nào"}),e.jsx(Q,{asChild:!0,children:e.jsx(t,{className:"bg-primary hover:bg-secondary transition-all duration-300",onClick:M,children:"Thêm địa chỉ mới"})})]}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:e.jsx(he,{children:C.map(s=>e.jsx(W.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0,x:-10},transition:{duration:.2},children:e.jsxs(A,{className:`overflow-hidden ${s.isDefault?"border-primary":"border-gray-200 dark:border-gray-700"}`,children:[e.jsxs(P,{className:"p-4 pb-2 flex flex-row justify-between items-start space-y-0",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(j.Icon,{path:oe,size:.7,className:"text-primary"}),e.jsx(I,{className:"text-base font-medium",children:s.addressName})]}),e.jsx("div",{className:"flex items-center gap-1",children:s.isDefault?e.jsxs("div",{className:"flex items-center text-xs text-primary bg-primary/10 px-2 py-1 rounded",children:[e.jsx(j.Icon,{path:me,size:.7,className:"mr-1"}),"Mặc định"]}):e.jsxs(t,{variant:"ghost",size:"sm",className:"h-8 px-2 text-xs text-maintext hover:text-primary",children:[e.jsx(j.Icon,{path:xe,size:.7,className:"mr-1"}),"Đặt mặc định"]})})]}),e.jsx(F,{className:"p-4 pt-2",children:e.jsxs("div",{className:"text-sm space-y-1",children:[e.jsxs("p",{className:"font-medium",children:[s.fullName," | ",s.phoneNumber]}),e.jsxs("p",{className:"text-maintext dark:text-maintext",children:[s.addressDetail,", ",s.ward,", ",s.district,", ",s.province]})]})}),e.jsxs(ve,{className:"p-4 pt-2 flex justify-end gap-2",children:[e.jsxs(t,{variant:"outline",size:"sm",className:"h-8 px-3 border-gray-300 hover:border-red-500 hover:text-red-500",onClick:()=>S(s.id),children:[e.jsx(Ue,{size:14,className:"mr-1"}),"Xóa"]}),e.jsxs(t,{variant:"outline",size:"sm",className:"h-8 px-3 border-gray-300 hover:border-primary hover:text-primary",onClick:()=>ne(s),children:[e.jsx(Me,{size:14,className:"mr-1"}),"Sửa"]})]})]})},s.id))})}),e.jsxs($,{className:"max-w-2xl",children:[e.jsxs(q,{children:[e.jsx(G,{children:g?"Chỉnh sửa địa chỉ":"Thêm địa chỉ mới"}),e.jsx(J,{children:g?"Cập nhật thông tin địa chỉ của bạn":"Điền đầy đủ thông tin để thêm địa chỉ mới"})]}),e.jsx(Se,{className:"max-h-[70vh]",children:e.jsx("div",{className:"p-1",children:e.jsx(se,{...r,children:e.jsxs("form",{onSubmit:r.handleSubmit(ie),className:"space-y-4",children:[e.jsx(i,{control:r.control,name:"addressName",render:({field:s})=>e.jsxs(l,{children:[e.jsx(c,{children:"Tên địa chỉ"}),e.jsx(d,{children:e.jsx(p,{placeholder:"Ví dụ: Nhà riêng, Văn phòng...",...s})}),e.jsx(m,{})]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx(i,{control:r.control,name:"fullName",render:({field:s})=>e.jsxs(l,{children:[e.jsx(c,{children:"Họ tên người nhận"}),e.jsx(d,{children:e.jsx(p,{placeholder:"Nhập họ tên người nhận",...s})}),e.jsx(m,{})]})}),e.jsx(i,{control:r.control,name:"phoneNumber",render:({field:s})=>e.jsxs(l,{children:[e.jsx(c,{children:"Số điện thoại"}),e.jsx(d,{children:e.jsx(p,{placeholder:"Nhập số điện thoại",...s})}),e.jsx(m,{})]})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsx(i,{control:r.control,name:"province",render:({field:s})=>e.jsxs(l,{children:[e.jsx(c,{children:"Tỉnh/Thành phố"}),e.jsxs(Ae,{onValueChange:s.onChange,defaultValue:s.value,children:[e.jsx(d,{children:e.jsx(Pe,{children:e.jsx(Ie,{placeholder:"Chọn tỉnh/thành phố"})})}),e.jsxs(Fe,{children:[e.jsx(f,{value:"Hà Nội",children:"Hà Nội"}),e.jsx(f,{value:"TP. Hồ Chí Minh",children:"TP. Hồ Chí Minh"}),e.jsx(f,{value:"Đà Nẵng",children:"Đà Nẵng"}),e.jsx(f,{value:"Hải Phòng",children:"Hải Phòng"}),e.jsx(f,{value:"Cần Thơ",children:"Cần Thơ"})]})]}),e.jsx(m,{})]})}),e.jsx(i,{control:r.control,name:"district",render:({field:s})=>e.jsxs(l,{children:[e.jsx(c,{children:"Quận/Huyện"}),e.jsx(d,{children:e.jsx(p,{placeholder:"Nhập quận/huyện",...s})}),e.jsx(m,{})]})}),e.jsx(i,{control:r.control,name:"ward",render:({field:s})=>e.jsxs(l,{children:[e.jsx(c,{children:"Phường/Xã"}),e.jsx(d,{children:e.jsx(p,{placeholder:"Nhập phường/xã",...s})}),e.jsx(m,{})]})})]}),e.jsx(i,{control:r.control,name:"addressDetail",render:({field:s})=>e.jsxs(l,{children:[e.jsx(c,{children:"Địa chỉ chi tiết"}),e.jsx(d,{children:e.jsx(we,{placeholder:"Số nhà, tên đường...",...s,className:"min-h-[80px]"})}),e.jsx(m,{})]})}),e.jsx(i,{control:r.control,name:"isDefault",render:({field:s})=>e.jsxs(l,{className:"flex flex-row items-center space-x-4 space-y-0 rounded-[6px] border p-4",children:[e.jsx(d,{children:e.jsx(p,{type:"checkbox",checked:s.value,onChange:s.onChange,className:"h-4 w-4 text-primary focus:ring-primary border-gray-300 rounded"})}),e.jsxs("div",{className:"space-y-1 leading-none",children:[e.jsx(c,{className:"cursor-pointer",children:"Đặt làm địa chỉ mặc định"}),e.jsx("p",{className:"text-sm text-maintext dark:text-maintext",children:"Địa chỉ này sẽ được sử dụng mặc định khi mua hàng"})]})]})}),e.jsxs(Te,{className:"mt-6",children:[e.jsx(t,{type:"button",variant:"outline",onClick:()=>D(!1),children:"Hủy"}),e.jsx(t,{type:"submit",className:"bg-primary hover:bg-secondary",disabled:y.isPending||k.isPending,children:y.isPending||k.isPending?e.jsxs(e.Fragment,{children:[e.jsx(b,{className:"w-4 h-4 mr-2 animate-spin"}),"Đang xử lý..."]}):g?"Cập nhật":"Thêm mới"})]})]})})})})]})]}),e.jsx(O,{open:!!z,onOpenChange:s=>!s&&S(null),children:e.jsxs($,{className:"max-w-4xl",children:[e.jsxs(q,{children:[e.jsx(G,{className:"text-center",children:"Xác nhận xóa địa chỉ"}),e.jsx(J,{className:"text-center",children:"Bạn có chắc chắn muốn xóa địa chỉ này? Hành động này không thể hoàn tác."})]}),e.jsxs("div",{className:"flex justify-center gap-4 mt-4",children:[e.jsxs(t,{variant:"outline",onClick:()=>S(null),disabled:H,className:"w-32",children:[e.jsx(De,{size:16,className:"mr-2"}),"Hủy"]}),e.jsx(t,{variant:"destructive",onClick:te,disabled:H,className:"w-32",children:H?e.jsxs(e.Fragment,{children:[e.jsx(b,{className:"w-4 h-4 mr-2 animate-spin"}),"Đang xóa..."]}):e.jsxs(e.Fragment,{children:[e.jsx(ze,{size:16,className:"mr-2"}),"Xác nhận"]})})]})]})})]})}const _e=ae({fullName:h().min(3,"Tên đầy đủ phải có ít nhất 3 ký tự"),email:h().email("Email không hợp lệ").min(1,"Email không được để trống"),phoneNumber:h().optional(),avatar:h().optional()});function Oe(){var w,g;const{data:a,isLoading:v,refetch:u}=K(),y=ue(),{updateUserProfile:k}=Y(),n=Z({resolver:ee(_e),defaultValues:{fullName:"",email:"",phoneNumber:"",avatar:""}});x.useEffect(()=>{a&&a.data&&n.reset({fullName:a.data.fullName||"",email:a.data.email||"",phoneNumber:a.data.phoneNumber||"",avatar:a.data.avatar||""})},[a,n]);const C=async o=>{try{await y.mutateAsync(o),N.success("Cập nhật thành công"),u()}catch(T){console.error("Lỗi cập nhật:",T),N.error("Cập nhật thất bại")}};return v?e.jsx("div",{className:"flex justify-center items-center h-64",children:e.jsx(b,{className:"w-8 h-8 animate-spin text-primary"})}):e.jsx(se,{...n,children:e.jsxs("form",{onSubmit:n.handleSubmit(C),className:"space-y-5",children:[e.jsx("div",{className:"flex justify-center mb-4",children:e.jsxs(ge,{className:"w-24 h-24 border-4 border-primary/20",children:[e.jsx(ye,{src:n.getValues("avatar")||void 0,alt:"Avatar"}),e.jsx(Ne,{className:"bg-primary/10 text-primary text-2xl",children:((g=(w=n.getValues("fullName"))==null?void 0:w.charAt(0))==null?void 0:g.toUpperCase())||e.jsx(j.Icon,{path:fe,size:1.5})})]})}),e.jsx(i,{control:n.control,name:"fullName",render:({field:o})=>e.jsxs(l,{children:[e.jsx(c,{className:"text-maintext dark:text-gray-300 font-medium",children:"Họ và tên"}),e.jsx(d,{children:e.jsx(p,{type:"text",placeholder:"Nhập họ và tên của bạn",...o,className:"border-gray-300 dark:border-gray-700 focus-visible:ring-primary focus-visible:border-primary transition-all duration-300"})}),e.jsx(m,{})]})}),e.jsx(i,{control:n.control,name:"email",render:({field:o})=>e.jsxs(l,{children:[e.jsx(c,{className:"text-maintext dark:text-gray-300 font-medium",children:"Email"}),e.jsx(d,{children:e.jsx(p,{type:"email",placeholder:"Nhập email của bạn",...o,disabled:!0,className:"border-gray-300 dark:border-gray-700 opacity-70 cursor-not-allowed"})}),e.jsx(m,{})]})}),e.jsx(i,{control:n.control,name:"phoneNumber",render:({field:o})=>e.jsxs(l,{children:[e.jsx(c,{className:"text-maintext dark:text-gray-300 font-medium",children:"Số điện thoại"}),e.jsx(d,{children:e.jsx(p,{type:"tel",placeholder:"Nhập số điện thoại của bạn",...o,className:"border-gray-300 dark:border-gray-700 focus-visible:ring-primary focus-visible:border-primary transition-all duration-300"})}),e.jsx(m,{})]})}),e.jsx("div",{className:"pt-4",children:e.jsx(t,{type:"submit",className:"bg-primary hover:bg-secondary transition-all duration-300 text-base font-semibold w-full py-4",disabled:y.isPending,children:y.isPending?e.jsxs(e.Fragment,{children:[e.jsx(b,{className:"w-5 h-5 mr-2 animate-spin"}),"Đang cập nhật..."]}):"Cập nhật thông tin"})})]})})}const ts=()=>{const a=pe(),{profile:v,isAuthenticated:u}=Y();return x.useEffect(()=>{u||a("/auth/login")},[u,a]),u?e.jsx("div",{className:"container max-w-4xl mx-auto px-4 py-12",children:e.jsxs(W.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},children:[e.jsxs("div",{className:"mb-8 flex flex-col items-center text-center",children:[e.jsx("h1",{className:"text-3xl font-bold text-maintext dark:text-white mb-2",children:"Hồ sơ tài khoản"}),e.jsx("p",{className:"text-maintext dark:text-maintext max-w-2xl",children:"Quản lý thông tin cá nhân, địa chỉ và thay đổi mật khẩu của bạn"})]}),e.jsxs(ke,{defaultValue:"profile",className:"w-full",children:[e.jsxs(Ce,{className:"grid w-full grid-cols-3 mb-8",children:[e.jsxs(V,{value:"profile",className:"flex items-center gap-2",children:[e.jsx(j.Icon,{path:je,size:.7})," Thông tin cá nhân"]}),e.jsxs(V,{value:"addresses",className:"flex items-center gap-2",children:[e.jsx(j.Icon,{path:R,size:.7})," Sổ địa chỉ"]}),e.jsxs(V,{value:"security",className:"flex items-center gap-2",children:[e.jsx(j.Icon,{path:_,size:.7})," Bảo mật"]})]}),e.jsx(L,{value:"profile",children:e.jsxs(A,{className:"border border-gray-200 dark:border-gray-700 shadow-sm",children:[e.jsxs(P,{children:[e.jsx(I,{children:"Thông tin cá nhân"}),e.jsx(E,{children:"Cập nhật thông tin cá nhân của bạn tại đây"})]}),e.jsx(F,{children:e.jsx(Oe,{})})]})}),e.jsx(L,{value:"addresses",children:e.jsxs(A,{className:"border border-gray-200 dark:border-gray-700 shadow-sm",children:[e.jsxs(P,{children:[e.jsx(I,{children:"Sổ địa chỉ"}),e.jsx(E,{children:"Quản lý danh sách địa chỉ nhận hàng của bạn"})]}),e.jsx(F,{children:e.jsx(Be,{})})]})}),e.jsx(L,{value:"security",children:e.jsxs(A,{className:"border border-gray-200 dark:border-gray-700 shadow-sm",children:[e.jsxs(P,{children:[e.jsx(I,{children:"Bảo mật tài khoản"}),e.jsx(E,{children:"Cập nhật mật khẩu để bảo vệ tài khoản của bạn"})]}),e.jsx(F,{children:e.jsxs("div",{className:"flex flex-col items-center justify-center py-8",children:[e.jsx(j.Icon,{path:_,size:3,className:"text-primary mb-4 opacity-80"}),e.jsx("h3",{className:"text-xl font-medium mb-2",children:"Thay đổi mật khẩu tài khoản"}),e.jsx("p",{className:"text-maintext dark:text-maintext text-center mb-4 max-w-4xl",children:"Cập nhật mật khẩu mới để bảo vệ tài khoản của bạn khỏi các truy cập trái phép"}),e.jsx("a",{href:"/profile/change-password",className:"bg-primary hover:bg-secondary transition-all duration-300",children:e.jsx(t,{className:"bg-primary hover:bg-secondary transition-all duration-300",children:"Đổi mật khẩu"})})]})})]})})]})]})}):null};export{ts as default};
